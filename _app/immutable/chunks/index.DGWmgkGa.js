import{s as G,D as W,E as x,a as j,d,f as c,i as S,g,n as J,y as re,A as ie,j as Y,p as ce,e as B,t as L,k as A,c as I,b as N,o as O,N as ue,u as $,h as M}from"./scheduler.u6_2Foza.js";import{S as K,i as Q,f as he,b as se,d as le,m as ne,t as q,a as Z,e as oe,g as de,c as fe}from"./index.TaJ1J9Bt.js";import{m as pe,c as me,d as z}from"./index.Bn_1hBZy.js";import{t as ee,a as V}from"./apiInterceptor.ovEtsaVg.js";import{a as F,s as _e,d as ge}from"./index.BrR5MzCy.js";import{j as we}from"./index.BczdeOwI.js";import{M as ye}from"./Modal.BE09wbh8.js";function be(l){let e,t,a;return{c(){e=W("svg"),t=W("path"),a=W("path"),this.h()},l(s){e=x(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=j(e);t=x(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),j(t).forEach(d),a=x(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),j(a).forEach(d),r.forEach(d),this.h()},h(){c(t,"fill-rule","evenodd"),c(t,"d","M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z"),c(t,"clip-rule","evenodd"),c(a,"fill-rule","evenodd"),c(a,"d","M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z"),c(a,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 16 16"),c(e,"fill","currentColor"),c(e,"class",l[0])},m(s,r){S(s,e,r),g(e,t),g(e,a)},p(s,[r]){r&1&&c(e,"class",s[0])},i:J,o:J,d(s){s&&d(e)}}}function ve(l,e,t){let{className:a="w-4 h-4"}=e;return l.$$set=s=>{"className"in s&&t(0,a=s.className)},[a]}class ke extends K{constructor(e){super(),Q(this,e,ve,be,G,{className:0})}}function te(l){var T;let e,t,a,s,r,n,i,p,k,C,E,b,f;function m(o,h){return o[2].share_id?je:Ce}let w=m(l),y=w(l),_=((T=l[4])==null?void 0:T.features.enable_community_sharing)&&ae(l);k=new ke({});function U(o,h){return o[2].share_id?Se:Ee}let u=U(l),v=u(l);return{c(){e=B("div"),t=B("div"),y.c(),a=A(),s=B("div"),r=B("div"),n=B("div"),_&&_.c(),i=A(),p=B("button"),se(k.$$.fragment),C=A(),v.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var h=j(e);t=I(h,"DIV",{class:!0});var D=j(t);y.l(D),D.forEach(d),a=O(h),s=I(h,"DIV",{class:!0});var P=j(s);r=I(P,"DIV",{class:!0});var X=j(r);n=I(X,"DIV",{class:!0});var R=j(n);_&&_.l(R),i=O(R),p=I(R,"BUTTON",{class:!0,type:!0,id:!0});var H=j(p);le(k.$$.fragment,H),C=O(H),v.l(H),H.forEach(d),R.forEach(d),X.forEach(d),P.forEach(d),h.forEach(d),this.h()},h(){c(t,"class","text-sm dark:text-gray-300 mb-1"),c(p,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(p,"type","button"),c(p,"id","copy-and-share-chat-button"),c(n,"class","flex gap-1"),c(r,"class","flex flex-col items-end space-x-1 mt-3"),c(s,"class","flex justify-end"),c(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(o,h){S(o,e,h),g(e,t),y.m(t,null),g(e,a),g(e,s),g(s,r),g(r,n),_&&_.m(n,null),g(n,i),g(n,p),ne(k,p,null),g(p,C),v.m(p,null),E=!0,b||(f=$(p,"click",l[11]),b=!0)},p(o,h){var D;w===(w=m(o))&&y?y.p(o,h):(y.d(1),y=w(o),y&&(y.c(),y.m(t,null))),(D=o[4])!=null&&D.features.enable_community_sharing?_?_.p(o,h):(_=ae(o),_.c(),_.m(n,i)):_&&(_.d(1),_=null),u===(u=U(o))&&v?v.p(o,h):(v.d(1),v=u(o),v&&(v.c(),v.m(p,null)))},i(o){E||(q(k.$$.fragment,o),E=!0)},o(o){Z(k.$$.fragment,o),E=!1},d(o){o&&d(e),y.d(),_&&_.d(),oe(k),v.d(),b=!1,f()}}}function Ce(l){let e=l[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",t;return{c(){t=L(e)},l(a){t=N(a,e)},m(a,s){S(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&M(t,e)},d(a){a&&d(t)}}}function je(l){let e,t=l[3].t("You have shared this chat")+"",a,s,r,n=l[3].t("before")+"",i,p,k,C,E=l[3].t("Click here to")+"",b,f,m,w=l[3].t("delete this link")+"",y,_,U=l[3].t("and create a new shared link.")+"",u,v,T;return{c(){e=B("a"),a=L(t),s=A(),r=B("span"),i=L(n),p=L("."),C=A(),b=L(E),f=A(),m=B("button"),y=L(w),_=A(),u=L(U),this.h()},l(o){e=I(o,"A",{href:!0,target:!0});var h=j(e);a=N(h,t),s=O(h),r=I(h,"SPAN",{class:!0});var D=j(r);i=N(D,n),D.forEach(d),p=N(h,"."),h.forEach(d),C=O(o),b=N(o,E),f=O(o),m=I(o,"BUTTON",{class:!0});var P=j(m);y=N(P,w),P.forEach(d),_=O(o),u=N(o,U),this.h()},h(){c(r,"class","underline"),c(e,"href",k="/s/"+l[2].share_id),c(e,"target","_blank"),c(m,"class","underline")},m(o,h){S(o,e,h),g(e,a),g(e,s),g(e,r),g(r,i),g(e,p),S(o,C,h),S(o,b,h),S(o,f,h),S(o,m,h),g(m,y),S(o,_,h),S(o,u,h),v||(T=$(m,"click",l[9]),v=!0)},p(o,h){h&8&&t!==(t=o[3].t("You have shared this chat")+"")&&M(a,t),h&8&&n!==(n=o[3].t("before")+"")&&M(i,n),h&4&&k!==(k="/s/"+o[2].share_id)&&c(e,"href",k),h&8&&E!==(E=o[3].t("Click here to")+"")&&M(b,E),h&8&&w!==(w=o[3].t("delete this link")+"")&&M(y,w),h&8&&U!==(U=o[3].t("and create a new shared link.")+"")&&M(u,U)},d(o){o&&(d(e),d(C),d(b),d(f),d(m),d(_),d(u)),v=!1,T()}}}function ae(l){let e,t=l[3].t("Share to Open WebUI Community")+"",a,s,r;return{c(){e=B("button"),a=L(t),this.h()},l(n){e=I(n,"BUTTON",{class:!0,type:!0});var i=j(e);a=N(i,t),i.forEach(d),this.h()},h(){c(e,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full"),c(e,"type","button")},m(n,i){S(n,e,i),g(e,a),s||(r=$(e,"click",l[10]),s=!0)},p(n,i){i&8&&t!==(t=n[3].t("Share to Open WebUI Community")+"")&&M(a,t)},d(n){n&&d(e),s=!1,r()}}}function Ee(l){let e=l[3].t("Copy Link")+"",t;return{c(){t=L(e)},l(a){t=N(a,e)},m(a,s){S(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Copy Link")+"")&&M(t,e)},d(a){a&&d(t)}}}function Se(l){let e=l[3].t("Update and Copy Link")+"",t;return{c(){t=L(e)},l(a){t=N(a,e)},m(a,s){S(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Update and Copy Link")+"")&&M(t,e)},d(a){a&&d(t)}}}function Be(l){let e,t,a,s=l[3].t("Share Chat")+"",r,n,i,p='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',k,C,E,b,f=l[2]&&te(l);return{c(){e=B("div"),t=B("div"),a=B("div"),r=L(s),n=A(),i=B("button"),i.innerHTML=p,k=A(),f&&f.c(),this.h()},l(m){e=I(m,"DIV",{});var w=j(e);t=I(w,"DIV",{class:!0});var y=j(t);a=I(y,"DIV",{class:!0});var _=j(a);r=N(_,s),_.forEach(d),n=O(y),i=I(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(i)!=="svelte-745w2y"&&(i.innerHTML=p),y.forEach(d),k=O(w),f&&f.l(w),w.forEach(d),this.h()},h(){c(a,"class","text-lg font-medium self-center"),c(i,"class","self-center"),c(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(m,w){S(m,e,w),g(e,t),g(t,a),g(a,r),g(t,n),g(t,i),g(e,k),f&&f.m(e,null),C=!0,E||(b=$(i,"click",l[8]),E=!0)},p(m,w){(!C||w&8)&&s!==(s=m[3].t("Share Chat")+"")&&M(r,s),m[2]?f?(f.p(m,w),w&4&&q(f,1)):(f=te(m),f.c(),q(f,1),f.m(e,null)):f&&(de(),Z(f,1,1,()=>{f=null}),fe())},i(m){C||(q(f),C=!0)},o(m){Z(f),C=!1},d(m){m&&d(e),f&&f.d(),E=!1,b()}}}function Ie(l){let e,t,a;function s(n){l[12](n)}let r={size:"md",$$slots:{default:[Be]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.show=l[0]),e=new ye({props:r}),re.push(()=>he(e,"show",s)),{c(){se(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,i){ne(e,n,i),a=!0},p(n,[i]){const p={};i&65567&&(p.$$scope={dirty:i,ctx:n}),!t&&i&1&&(t=!0,p.show=n[0],ie(()=>t=!1)),e.$set(p)},i(n){a||(q(e.$$.fragment,n),a=!0)},o(n){Z(e.$$.fragment,n),a=!1},d(n){oe(e,n)}}}function Te(l,e,t){let a,s,r;Y(l,pe,u=>t(14,a=u)),Y(l,me,u=>t(4,r=u));let{chatId:n}=e,i=null,p=null;const k=ce("i18n");Y(l,k,u=>t(3,s=u));const C=async()=>{const u=await _e(localStorage.token,n);return p=`${window.location.origin}/s/${u.id}`,console.log(p),t(2,i=await F(localStorage.token,n)),p},E=async()=>{const u=i.chat;console.log("share",u),ee.success(s.t("Redirecting you to Open WebUI Community"));const v="https://openwebui.com",T=await window.open(`${v}/chats/upload`,"_blank");window.addEventListener("message",o=>{o.origin===v&&o.data==="loaded"&&T.postMessage(JSON.stringify({chat:u,models:a.filter(h=>u.models.includes(h.id))}),"*")},!1)};let{show:b=!1}=e;const f=u=>i?u?i.id!==u.id||i.share_id!==u.share_id:!1:!0,m=()=>{t(0,b=!1)},w=async()=>{await ge(localStorage.token,n)&&t(2,i=await F(localStorage.token,n))},y=()=>{E(),t(0,b=!1)},_=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){console.log("isSafari");const v=async()=>{const T=await C();return new Blob([T],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":v()})]).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(T=>(console.error("Async: Could not copy text: ",T),!1))}else we(await C());ee.success(s.t("Copied shared chat URL to clipboard!")),t(0,b=!1)};function U(u){b=u,t(0,b)}return l.$$set=u=>{"chatId"in u&&t(1,n=u.chatId),"show"in u&&t(0,b=u.show)},l.$$.update=()=>{l.$$.dirty&7&&b&&(async()=>{if(n){const u=await F(localStorage.token,n);f(u)&&t(2,i=u)}else t(2,i=null),console.log(i)})()},[b,n,i,s,r,k,C,E,m,w,y,_,U]}class Pe extends K{constructor(e){super(),Q(this,e,Te,Ie,G,{chatId:1,show:0})}}function Le(l){let e,t;return{c(){e=W("svg"),t=W("path"),this.h()},l(a){e=x(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=j(e);t=x(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),j(t).forEach(d),s.forEach(d),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",l[1]),c(e,"stroke","currentColor"),c(e,"class",l[0])},m(a,s){S(a,e,s),g(e,t)},p(a,[s]){s&2&&c(e,"stroke-width",a[1]),s&1&&c(e,"class",a[0])},i:J,o:J,d(a){a&&d(e)}}}function Ne(l,e,t){let{className:a="size-4"}=e,{strokeWidth:s="1.5"}=e;return l.$$set=r=>{"className"in r&&t(0,a=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[a,s]}class We extends K{constructor(e){super(),Q(this,e,Ne,Le,G,{className:0,strokeWidth:1})}}const xe=async l=>{let e=null;const t=await V(`${z}/memories/`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(e=a.detail,console.log(a),null));if(e)throw e;return t},qe=async(l,e)=>{let t=null;const a=await V(`${z}/memories/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(t=s.detail,console.log(s),null));if(t)throw t;return a},Re=async(l,e,t)=>{let a=null;const s=await V(`${z}/memories/${e}/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:t})}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(a=r.detail,console.log(r),null));if(a)throw a;return s},He=async(l,e)=>{let t=null;const a=await V(`${z}/memories/query`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(t=s.detail,console.log(s),null));if(t)throw t;return a},Je=async(l,e)=>{let t=null;const a=await V(`${z}/memories/${e}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).then(s=>s).catch(s=>(t=s.detail,console.log(s),null));if(t)throw t;return a},Ze=async l=>{let e=null;const t=await V(`${z}/memories/delete/user`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).then(a=>a).catch(a=>(e=a.detail,console.log(a),null));if(e)throw e;return t};export{We as P,Pe as S,qe as a,Je as b,Ze as d,xe as g,He as q,Re as u};
//# sourceMappingURL=index.DGWmgkGa.js.map
