var Sn=Object.defineProperty;var Bn=(n,e,t)=>e in n?Sn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var _t=(n,e,t)=>Bn(n,typeof e!="symbol"?e+"":e,t);import{s as Ne,e as I,k as j,c as M,a as E,d as m,o as z,f as g,i as V,g as v,n as ye,t as W,b as F,N as ze,B as bt,u as ve,h as G,Q as Ke,H as ht,j as we,p as Qe,F as mt,q as kt,y as Be,A as Je,r as On,v as Ln,w as Pn,x as An,l as de,M as Hn,C as Ee,an as rl,D as Le,E as Pe,P as Tt,a0 as il,T as jn,U as zn}from"./scheduler.u6_2Foza.js";import{S as Re,i as Se,b as te,d as le,m as se,t as k,a as N,e as ne,f as Ge,g as ae,c as oe,j as Rt}from"./index.TaJ1J9Bt.js";import{e as Me,u as tn,o as ln}from"./each.CpR_wfW1.js";import{m as Pt,d as al,l as sn,h as qn,G as vt,H as Un,J as Wn,a as At,c as nn,T as ol,u as Ht,e as Bt,W as Fn,n as rn,x as fl,y as Jn}from"./index.Bn_1hBZy.js";import{t as je}from"./apiInterceptor.ovEtsaVg.js";import{a as Gn,u as Kn,b as Qn}from"./index.BrR5MzCy.js";import{j as an,w as Zn,b as Yn,k as pt,r as Ot,l as on,v as ul}from"./index.BczdeOwI.js";import{d as nt}from"./relativeTime.DpbLsHUI.js";import{u as cl,c as Xn}from"./index.Cvj2vX8f.js";import{b as $n}from"./index.NocVRDio.js";import{s as xn}from"./index.CxblQe6a.js";import{i as er}from"./index.dikIXV-E.js";import{ai as tr,ag as Wt,af as fn,ae as Ft,ah as un}from"./Markdown.BAgpUFrd.js";import{T as qe}from"./Tooltip.3kB_H6zI.js";import{T as lr}from"./Tags.Cas10Oi-.js";import{S as jt}from"./Spinner.BfJDCPnB.js";import{C as cn}from"./ChevronDown.BdfXPb0q.js";import{C as dn}from"./ChevronUp.DidByfOj.js";import{M as sr}from"./MagnifyingGlass.BVnq9_Vm.js";import{C as hn}from"./Collapsible.19Eke70L.js";import{C as mn}from"./ConfirmDialog.k0xjQhtS.js";import{I as nr,F as rr}from"./FileItem.Bm7fqDSq.js";import{M as gn}from"./Modal.BE09wbh8.js";import{B as Jt}from"./Badge.DfpU2I5q.js";import{C as ir}from"./Check.DdGE4lbh.js";import{X as ar}from"./XMark.DzmDuvr9.js";import{E as or}from"./EllipsisHorizontal.DIWN99Ps.js";import{m as Lt}from"./marked.esm._0_gBwjO.js";import{L as fr}from"./Loader.BFvlt1IZ.js";import{f as St}from"./index.EYQgLDYX.js";import{F as ur}from"./fuse.CU2r43ac.js";function cr(n){return new Worker(""+new URL("../workers/kokoro.worker-mnLLtuEv.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class dr{constructor(e="fp32"){_t(this,"worker",null);_t(this,"initialized",!1);_t(this,"dtype");_t(this,"requestQueue",[]);_t(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new cr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function hr(n){let e,t,l,s,r,i,a,o,f,u,c,d,h,_,D,b,y,w,B,A,C,p,R,O,T,P;return{c(){e=I("div"),t=I("div"),l=I("div"),s=I("div"),i=j(),a=I("div"),o=I("div"),u=j(),c=I("div"),h=j(),_=I("div"),D=I("div"),y=j(),w=I("div"),A=j(),C=I("div"),R=j(),O=I("div"),this.h()},l(L){e=M(L,"DIV",{class:!0});var q=E(e);t=M(q,"DIV",{class:!0});var X=E(t);l=M(X,"DIV",{class:!0});var ce=E(l);s=M(ce,"DIV",{class:!0}),E(s).forEach(m),i=z(ce),a=M(ce,"DIV",{class:!0});var x=E(a);o=M(x,"DIV",{class:!0}),E(o).forEach(m),u=z(x),c=M(x,"DIV",{class:!0}),E(c).forEach(m),x.forEach(m),h=z(ce),_=M(ce,"DIV",{class:!0});var ee=E(_);D=M(ee,"DIV",{class:!0}),E(D).forEach(m),y=z(ee),w=M(ee,"DIV",{class:!0}),E(w).forEach(m),A=z(ee),C=M(ee,"DIV",{class:!0}),E(C).forEach(m),ee.forEach(m),R=z(ce),O=M(ce,"DIV",{class:!0}),E(O).forEach(m),ce.forEach(m),X.forEach(m),q.forEach(m),this.h()},h(){g(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),g(o,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),g(c,"class",d=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),g(a,"class","grid grid-cols-3 gap-4"),g(D,"class",b=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),g(w,"class",B=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),g(C,"class",p=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),g(_,"class","grid grid-cols-4 gap-4"),g(O,"class",T=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),g(l,"class",P=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),g(t,"class","animate-pulse flex w-full"),g(e,"class","w-full mt-2 mb-2")},m(L,q){V(L,e,q),v(e,t),v(t,l),v(l,s),v(l,i),v(l,a),v(a,o),v(a,u),v(a,c),v(l,h),v(l,_),v(_,D),v(_,y),v(_,w),v(_,A),v(_,C),v(l,R),v(l,O)},p(L,[q]){q&1&&r!==(r=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&g(s,"class",r),q&1&&f!==(f=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&g(o,"class",f),q&1&&d!==(d=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&g(c,"class",d),q&1&&b!==(b=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&g(D,"class",b),q&1&&B!==(B=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&g(w,"class",B),q&1&&p!==(p=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&g(C,"class",p),q&1&&T!==(T=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&g(O,"class",T),q&1&&P!==(P=(L[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&g(l,"class",P)},i:ye,o:ye,d(L){L&&m(e)}}}function mr(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class _n extends Re{constructor(e){super(),Se(this,e,mr,hr,Ne,{size:0})}}function dl(n,e,t){const l=n.slice();return l[23]=e[t],l}function hl(n,e,t){const l=n.slice();return l[26]=e[t],l}function ml(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=E(e);l=F(i,t),i.forEach(m),this.h()},h(){g(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),v(e,l)},p(r,i){var a;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((a=r[7])==null?void 0:a.name)??r[7].id:r[1].selectedModelId})+"")&&G(l,t)},d(r){r&&m(e)}}}function gl(n){let e,t=n[26]+"",l,s,r,i,a,o;function f(){return n[12](n[26])}return{c(){e=I("button"),l=W(t),s=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=E(e);l=F(c,t),s=z(c),c.forEach(m),this.h()},h(){var u,c;g(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){V(u,e,c),v(e,l),v(e,s),a||(o=ve(e,"click",f),a=!0)},p(u,c){var d,h;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&g(e,"class",r),c&2&&i!==(i=((h=(d=n[1])==null?void 0:d.annotation)==null?void 0:h.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),a=!1,o()}}}function _l(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Me(n[3]),a=[];for(let o=0;o<i.length;o+=1)a[o]=vl(dl(n,i,o));return{c(){e=I("div"),l=W(t),s=j(),r=I("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0});var f=E(e);l=F(f,t),f.forEach(m),s=z(o),r=M(o,"DIV",{class:!0});var u=E(r);for(let c=0;c<a.length;c+=1)a[c].l(u);u.forEach(m),this.h()},h(){g(e,"class","text-sm mt-1.5 font-medium"),g(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(o,f){V(o,e,f),v(e,l),V(o,s,f),V(o,r,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(r,null)},p(o,f){if(f&256&&t!==(t=o[8].t("Why?")+"")&&G(l,t),f&280){i=Me(o[3]);let u;for(u=0;u<i.length;u+=1){const c=dl(o,i,u);a[u]?a[u].p(c,f):(a[u]=vl(c),a[u].c(),a[u].m(r,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},d(o){o&&(m(e),m(s),m(r)),Ke(a,o)}}}function gr(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&G(t,e)},d(l){l&&m(t)}}}function _r(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&G(t,e)},d(l){l&&m(t)}}}function vr(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&G(t,e)},d(l){l&&m(t)}}}function br(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&G(t,e)},d(l){l&&m(t)}}}function pr(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&G(t,e)},d(l){l&&m(t)}}}function kr(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&G(t,e)},d(l){l&&m(t)}}}function wr(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&G(t,e)},d(l){l&&m(t)}}}function yr(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&G(t,e)},d(l){l&&m(t)}}}function Ir(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&G(t,e)},d(l){l&&m(t)}}}function Mr(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&G(t,e)},d(l){l&&m(t)}}}function Er(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&G(t,e)},d(l){l&&m(t)}}}function Dr(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&G(t,e)},d(l){l&&m(t)}}}function Nr(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&G(t,e)},d(l){l&&m(t)}}}function Vr(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&G(t,e)},d(l){l&&m(t)}}}function Cr(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&G(t,e)},d(l){l&&m(t)}}}function vl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?Cr:u[23]==="followed_instructions_perfectly"?Vr:u[23]==="showcased_creativity"?Nr:u[23]==="positive_attitude"?Dr:u[23]==="attention_to_detail"?Er:u[23]==="thorough_explanation"?Mr:u[23]==="dont_like_the_style"?Ir:u[23]==="too_verbose"?yr:u[23]==="not_helpful"?wr:u[23]==="not_factually_correct"?kr:u[23]==="didnt_fully_follow_instructions"?pr:u[23]==="refused_when_it_shouldnt_have"?br:u[23]==="being_lazy"?vr:u[23]==="other"?_r:gr}let a=i(n),o=a(n);function f(){return n[13](n[23])}return{c(){e=I("button"),o.c(),t=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=E(e);o.l(c),t=z(c),c.forEach(m),this.h()},h(){g(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),o.m(e,null),v(e,t),s||(r=ve(e,"click",f),s=!0)},p(u,c){n=u,a===(a=i(n))&&o?o.p(n,c):(o.d(1),o=a(n),o&&(o.c(),o.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&g(e,"class",l)},d(u){u&&m(e),o.d(),s=!1,r()}}}function Tr(n){var $;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,a,o,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,d,h,_,D,b,y,w=n[8].t("Awful")+"",B,A,C,p,R=n[8].t("Amazing")+"",O,T,P,L,q,X,ce,x,ee,he,ue,_e,Q,J=n[8].t("Save")+"",H,ie,re,me,be,ge=(($=n[1])==null?void 0:$.arena)&&ml(n),S=Me(Array.from({length:10}).map(bl)),K=[];for(let Y=0;Y<S.length;Y+=1)K[Y]=gl(hl(n,S,Y));let Z=n[3].length>0&&_l(n);return ue=new lr({props:{tags:n[2]}}),ue.$on("delete",n[15]),ue.$on("add",n[16]),{c(){ge&&ge.c(),e=j(),t=I("div"),l=I("div"),s=I("div"),i=W(r),a=j(),o=I("button"),o.innerHTML=f,u=j(),c=I("div"),d=I("div"),h=I("div");for(let Y=0;Y<K.length;Y+=1)K[Y].c();_=j(),D=I("div"),b=I("div"),y=W("1 - "),B=W(w),A=j(),C=I("div"),p=W("10 - "),O=W(R),T=j(),P=I("div"),Z&&Z.c(),L=j(),q=I("div"),X=I("textarea"),x=j(),ee=I("div"),he=I("div"),te(ue.$$.fragment),_e=j(),Q=I("button"),H=W(J),this.h()},l(Y){ge&&ge.l(Y),e=z(Y),t=M(Y,"DIV",{class:!0,id:!0});var fe=E(t);l=M(fe,"DIV",{class:!0});var ke=E(l);s=M(ke,"DIV",{class:!0});var Te=E(s);i=F(Te,r),Te.forEach(m),a=z(ke),o=M(ke,"BUTTON",{"data-svelte-h":!0}),ze(o)!=="svelte-1ew22ui"&&(o.innerHTML=f),ke.forEach(m),u=z(fe),c=M(fe,"DIV",{class:!0});var De=E(c);d=M(De,"DIV",{class:!0});var Oe=E(d);h=M(Oe,"DIV",{class:!0});var Ae=E(h);for(let lt=0;lt<K.length;lt+=1)K[lt].l(Ae);Ae.forEach(m),_=z(Oe),D=M(Oe,"DIV",{class:!0});var Ue=E(D);b=M(Ue,"DIV",{});var et=E(b);y=F(et,"1 - "),B=F(et,w),et.forEach(m),A=z(Ue),C=M(Ue,"DIV",{});var tt=E(C);p=F(tt,"10 - "),O=F(tt,R),tt.forEach(m),Ue.forEach(m),Oe.forEach(m),De.forEach(m),T=z(fe),P=M(fe,"DIV",{});var rt=E(P);Z&&Z.l(rt),rt.forEach(m),L=z(fe),q=M(fe,"DIV",{class:!0});var it=E(q);X=M(it,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),E(X).forEach(m),it.forEach(m),x=z(fe),ee=M(fe,"DIV",{class:!0});var xe=E(ee);he=M(xe,"DIV",{class:!0});var at=E(he);le(ue.$$.fragment,at),at.forEach(m),_e=z(xe),Q=M(xe,"BUTTON",{class:!0});var ot=E(Q);H=F(ot,J),ot.forEach(m),xe.forEach(m),fe.forEach(m),this.h()},h(){g(s,"class","text-sm font-medium"),g(l,"class","flex justify-between items-center"),g(h,"class","mt-1.5 w-fit flex gap-1 pb-5"),g(D,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),g(d,"class","relative w-fit"),g(c,"class","w-full flex justify-center"),g(X,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),g(X,"placeholder",ce=n[8].t("Feel free to add specific details")),g(X,"rows","3"),g(q,"class","mt-2"),g(he,"class","flex items-end group"),g(Q,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),g(ee,"class","mt-2 gap-1.5 flex justify-between"),g(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),g(t,"id",ie="message-feedback-"+n[1].id)},m(Y,fe){ge&&ge.m(Y,fe),V(Y,e,fe),V(Y,t,fe),v(t,l),v(l,s),v(s,i),v(l,a),v(l,o),v(t,u),v(t,c),v(c,d),v(d,h);for(let ke=0;ke<K.length;ke+=1)K[ke]&&K[ke].m(h,null);v(d,_),v(d,D),v(D,b),v(b,y),v(b,B),v(D,A),v(D,C),v(C,p),v(C,O),v(t,T),v(t,P),Z&&Z.m(P,null),v(t,L),v(t,q),v(q,X),bt(X,n[5]),v(t,x),v(t,ee),v(ee,he),se(ue,he,null),v(ee,_e),v(ee,Q),v(Q,H),re=!0,me||(be=[ve(o,"click",n[11]),ve(X,"input",n[14]),ve(Q,"click",n[17])],me=!0)},p(Y,[fe]){var Te;if((Te=Y[1])!=null&&Te.arena?ge?ge.p(Y,fe):(ge=ml(Y),ge.c(),ge.m(e.parentNode,e)):ge&&(ge.d(1),ge=null),(!re||fe&256)&&r!==(r=Y[8].t("How would you rate this response?")+"")&&G(i,r),fe&66){S=Me(Array.from({length:10}).map(bl));let De;for(De=0;De<S.length;De+=1){const Oe=hl(Y,S,De);K[De]?K[De].p(Oe,fe):(K[De]=gl(Oe),K[De].c(),K[De].m(h,null))}for(;De<K.length;De+=1)K[De].d(1);K.length=S.length}(!re||fe&256)&&w!==(w=Y[8].t("Awful")+"")&&G(B,w),(!re||fe&256)&&R!==(R=Y[8].t("Amazing")+"")&&G(O,R),Y[3].length>0?Z?Z.p(Y,fe):(Z=_l(Y),Z.c(),Z.m(P,null)):Z&&(Z.d(1),Z=null),(!re||fe&256&&ce!==(ce=Y[8].t("Feel free to add specific details")))&&g(X,"placeholder",ce),fe&32&&bt(X,Y[5]);const ke={};fe&4&&(ke.tags=Y[2]),ue.$set(ke),(!re||fe&256)&&J!==(J=Y[8].t("Save")+"")&&G(H,J),(!re||fe&2&&ie!==(ie="message-feedback-"+Y[1].id))&&g(t,"id",ie)},i(Y){re||(k(ue.$$.fragment,Y),re=!0)},o(Y){N(ue.$$.fragment,Y),re=!1},d(Y){Y&&(m(e),m(t)),ge&&ge.d(Y),Ke(K,Y),Z&&Z.d(),ne(ue),me=!1,ht(be)}}}const bl=(n,e)=>e+1;function Rr(n,e,t){let l,s;we(n,Pt,P=>t(18,s=P));const r=Qe("i18n");we(n,r,P=>t(8,l=P));const i=mt();let{message:a}=e,{show:o=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],d=[],h=null,_="",D=null,b=null;const y=()=>{var P,L,q,X,ce;h||t(4,h=((P=a==null?void 0:a.annotation)==null?void 0:P.reason)??""),_||t(5,_=((L=a==null?void 0:a.annotation)==null?void 0:L.comment)??""),t(2,c=(((q=a==null?void 0:a.annotation)==null?void 0:q.tags)??[]).map(x=>({name:x}))),D||t(6,D=((ce=(X=a==null?void 0:a.annotation)==null?void 0:X.details)==null?void 0:ce.rating)??null)};kt(()=>{a!=null&&a.arena&&(t(7,b=s.find(P=>P.id===a.selectedModelId)),je.success(l.t('This response was generated by "{{model}}"',{model:b?(b==null?void 0:b.name)??b.id:a.selectedModelId})))});const w=()=>{console.log("saveHandler"),i("save",{reason:h,comment:_,tags:c.map(P=>P.name),details:{rating:D}}),je.success(l.t("Thanks for your feedback!")),t(0,o=!1)},B=()=>{t(0,o=!1)},A=P=>{t(6,D=P)},C=P=>{t(4,h=P)};function p(){_=this.value,t(5,_)}const R=P=>{t(2,c=c.filter(L=>L.name.replaceAll(" ","_").toLowerCase()!==P.detail.replaceAll(" ","_").toLowerCase()))},O=P=>{t(2,c=[...c,{name:P.detail}])},T=()=>{w()};return n.$$set=P=>{"message"in P&&t(1,a=P.message),"show"in P&&t(0,o=P.show)},n.$$.update=()=>{var P,L;n.$$.dirty&2&&(((P=a==null?void 0:a.annotation)==null?void 0:P.rating)===1?t(3,d=f):((L=a==null?void 0:a.annotation)==null?void 0:L.rating)===-1&&t(3,d=u)),n.$$.dirty&2&&a&&y()},[o,a,c,d,h,_,D,b,l,r,w,B,A,C,p,R,O,T]}class Sr extends Re{constructor(e){super(),Se(this,e,Rr,Tr,Ne,{message:1,show:0})}}function pl(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function Br(n){let e,t;return e=new cn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Or(n){let e,t;return e=new dn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Lr(n){let e,t,l,s,r;const i=n[2].default,a=On(i,n,n[4],null),o=[Or,Br],f=[];function u(c,d){return c[1]?0:1}return l=u(n),s=f[l]=o[l](n),{c(){e=I("div"),a&&a.c(),t=j(),s.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var d=E(e);a&&a.l(d),t=z(d),s.l(d),d.forEach(m),this.h()},h(){g(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,d){V(c,e,d),a&&a.m(e,null),v(e,t),f[l].m(e,null),r=!0},p(c,d){a&&a.p&&(!r||d&16)&&Ln(a,i,c,c[4],r?An(i,c[4],d,null):Pn(c[4]),null);let h=l;l=u(c),l!==h&&(ae(),N(f[h],1,1,()=>{f[h]=null}),oe(),s=f[l],s||(s=f[l]=o[l](c),s.c()),k(s,1),s.m(e,null))},i(c){r||(k(a,c),k(s),r=!0)},o(c){N(a,c),N(s),r=!1},d(c){c&&m(e),a&&a.d(c),f[l].d()}}}function kl(n){let e,t,l,s,r,i=n[0].query+"",a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,d;return l=new sr({}),{c(){e=I("a"),t=I("div"),te(l.$$.fragment),s=j(),r=I("div"),a=W(i),o=j(),f=I("div"),f.innerHTML=u,this.h()},l(h){e=M(h,"A",{href:!0,target:!0,class:!0});var _=E(e);t=M(_,"DIV",{class:!0});var D=E(t);le(l.$$.fragment,D),s=z(D),r=M(D,"DIV",{class:!0});var b=E(r);a=F(b,i),b.forEach(m),D.forEach(m),o=z(_),f=M(_,"DIV",{class:!0,"data-svelte-h":!0}),ze(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){g(r,"class","line-clamp-1"),g(t,"class","flex gap-2 items-center"),g(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),g(e,"href",c="https://www.google.com/search?q="+n[0].query),g(e,"target","_blank"),g(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(h,_){V(h,e,_),v(e,t),se(l,t,null),v(t,s),v(t,r),v(r,a),v(e,o),v(e,f),d=!0},p(h,_){(!d||_&1)&&i!==(i=h[0].query+"")&&G(a,i),(!d||_&1&&c!==(c="https://www.google.com/search?q="+h[0].query))&&g(e,"href",c)},i(h){d||(k(l.$$.fragment,h),d=!0)},o(h){N(l.$$.fragment,h),d=!1},d(h){h&&m(e),ne(l)}}}function wl(n){let e,t,l=n[5]+"",s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',o,f,u;return{c(){e=I("a"),t=I("div"),s=W(l),r=j(),i=I("div"),i.innerHTML=a,o=j(),this.h()},l(c){e=M(c,"A",{href:!0,target:!0,class:!0});var d=E(e);t=M(d,"DIV",{class:!0});var h=E(t);s=F(h,l),h.forEach(m),r=z(d),i=M(d,"DIV",{class:!0,"data-svelte-h":!0}),ze(i)!=="svelte-14xjows"&&(i.innerHTML=a),o=z(d),d.forEach(m),this.h()},h(){g(t,"class","line-clamp-1"),g(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),g(e,"href",f=n[5]),g(e,"target","_blank"),g(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,d){V(c,e,d),v(e,t),v(t,s),v(e,r),v(e,i),v(e,o)},p(c,d){d&1&&l!==(l=c[5]+"")&&G(s,l),d&1&&f!==(f=c[5])&&g(e,"href",f),d&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&g(e,"class",u)},d(c){c&&m(e)}}}function Pr(n){var a;let e,t,l,s=((a=n[0])==null?void 0:a.query)&&kl(n),r=Me(n[0].urls),i=[];for(let o=0;o<r.length;o+=1)i[o]=wl(pl(n,r,o));return{c(){e=I("div"),s&&s.c(),t=j();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0,slot:!0});var f=E(e);s&&s.l(f),t=z(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){g(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),g(e,"slot","content")},m(o,f){V(o,e,f),s&&s.m(e,null),v(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(o,f){var u;if((u=o[0])!=null&&u.query?s?(s.p(o,f),f&1&&k(s,1)):(s=kl(o),s.c(),k(s,1),s.m(e,t)):s&&(ae(),N(s,1,1,()=>{s=null}),oe()),f&1){r=Me(o[0].urls);let c;for(c=0;c<r.length;c+=1){const d=pl(o,r,c);i[c]?i[c].p(d,f):(i[c]=wl(d),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(o){l||(k(s),l=!0)},o(o){N(s),l=!1},d(o){o&&m(e),s&&s.d(),Ke(i,o)}}}function Ar(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[Pr],default:[Lr]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new hn({props:r}),Be.push(()=>Ge(e,"open",s)),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),l=!0},p(i,[a]){const o={};a&19&&(o.$$scope={dirty:a,ctx:i}),!t&&a&2&&(t=!0,o.open=i[1],Je(()=>t=!1)),e.$set(o)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){N(e.$$.fragment,i),l=!1},d(i){ne(e,i)}}}function Hr(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function a(o){i=o,t(1,i)}return n.$$set=o=>{"status"in o&&t(0,r=o.status),"$$scope"in o&&t(4,s=o.$$scope)},[r,i,l,a,s]}class jr extends Re{constructor(e){super(),Se(this,e,Hr,Ar,Ne,{status:0})}}function zr(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",a,o;return l=new nr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=I("div"),t=I("div"),te(l.$$.fragment),s=j(),r=I("div"),a=W(i),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=E(e);t=M(u,"DIV",{class:!0});var c=E(t);le(l.$$.fragment,c),c.forEach(m),s=z(u),r=M(u,"DIV",{class:!0});var d=E(r);a=F(d,i),d.forEach(m),u.forEach(m),this.h()},h(){g(t,"class","self-start mt-0.5"),g(r,"class","self-center text-sm"),g(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),v(e,t),se(l,t,null),v(e,s),v(e,r),v(r,a),o=!0},p(f,[u]){(!o||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&G(a,i)},i(f){o||(k(l.$$.fragment,f),o=!0)},o(f){N(l.$$.fragment,f),o=!1},d(f){f&&m(e),ne(l)}}}function qr(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Ur=class extends Re{constructor(e){super(),Se(this,e,qr,zr,Ne,{content:0})}};function yl(n,e,t){const l=n.slice();return l[9]=e[t],l[11]=t,l}function Wr(n){const e=n.slice(),t=ti(e[9].distance);return e[12]=t,e}function Fr(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&G(l,t)},i:ye,o:ye,d(s){s&&m(e)}}}function Jr(n){let e,t,l,s;e=new qe({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Gr]},$$scope:{ctx:n}}});let r=n[2]&&Ml(n);return{c(){te(e.$$.fragment),t=j(),r&&r.c(),l=de()},l(i){le(e.$$.fragment,i),t=z(i),r&&r.l(i),l=de()},m(i,a){se(e,i,a),V(i,t,a),r&&r.m(i,a),V(i,l,a),s=!0},p(i,a){const o={};a&16&&(o.content=i[4].t("Open file")),a&8216&&(o.$$scope={dirty:a,ctx:i}),e.$set(o),i[2]?r?(r.p(i,a),a&4&&k(r,1)):(r=Ml(i),r.c(),k(r,1),r.m(l.parentNode,l)):r&&(ae(),N(r,1,1,()=>{r=null}),oe())},i(i){s||(k(e.$$.fragment,i),k(r),s=!0)},o(i){N(e.$$.fragment,i),N(r),s=!1},d(i){i&&(m(t),m(l)),ne(e,i),r&&r.d(i)}}}function Il(n){let e,t,l=n[4].t("page")+"",s,r,i=n[9].metadata.page+1+"",a,o;return{c(){e=I("span"),t=W("("),s=W(l),r=j(),a=W(i),o=W(")"),this.h()},l(f){e=M(f,"SPAN",{class:!0});var u=E(e);t=F(u,"("),s=F(u,l),r=z(u),a=F(u,i),o=F(u,")"),u.forEach(m),this.h()},h(){g(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),v(e,t),v(e,s),v(e,r),v(e,a),v(e,o)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&G(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&G(a,i)},d(f){f&&m(e)}}}function Gr(n){var o,f,u,c;let e,t,l=(((f=(o=n[9])==null?void 0:o.metadata)==null?void 0:f.name)??n[9].source.name)+"",s,r,i,a=((c=(u=n[9])==null?void 0:u.metadata)==null?void 0:c.page)&&Il(n);return{c(){e=I("div"),t=I("a"),s=W(l),i=j(),a&&a.c(),this.h()},l(d){e=M(d,"DIV",{class:!0});var h=E(e);t=M(h,"A",{class:!0,href:!0,target:!0});var _=E(t);s=F(_,l),_.forEach(m),i=z(h),a&&a.l(h),h.forEach(m),this.h()},h(){var d,h,_,D,b,y,w,B;g(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),g(t,"href",r=(h=(d=n[9])==null?void 0:d.metadata)!=null&&h.file_id?`${al}/files/${(D=(_=n[9])==null?void 0:_.metadata)==null?void 0:D.file_id}/content${((y=(b=n[9])==null?void 0:b.metadata)==null?void 0:y.page)!==void 0?`#page=${n[9].metadata.page+1}`:""}`:(B=(w=n[9].source)==null?void 0:w.url)!=null&&B.includes("http")?n[9].source.url:"#"),g(t,"target","_blank"),g(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(d,h){V(d,e,h),v(e,t),v(t,s),v(e,i),a&&a.m(e,null)},p(d,h){var _,D,b,y,w,B,A,C,p,R,O,T;h&8&&l!==(l=(((D=(_=d[9])==null?void 0:_.metadata)==null?void 0:D.name)??d[9].source.name)+"")&&G(s,l),h&8&&r!==(r=(y=(b=d[9])==null?void 0:b.metadata)!=null&&y.file_id?`${al}/files/${(B=(w=d[9])==null?void 0:w.metadata)==null?void 0:B.file_id}/content${((C=(A=d[9])==null?void 0:A.metadata)==null?void 0:C.page)!==void 0?`#page=${d[9].metadata.page+1}`:""}`:(R=(p=d[9].source)==null?void 0:p.url)!=null&&R.includes("http")?d[9].source.url:"#")&&g(t,"href",r),(T=(O=d[9])==null?void 0:O.metadata)!=null&&T.page?a?a.p(d,h):(a=Il(d),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(d){d&&m(e),a&&a.d()}}}function Ml(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,a,o;const f=[Qr,Kr],u=[];function c(d,h){return d[9].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=I("div"),l=W(t),s=j(),i.c(),a=de(),this.h()},l(d){e=M(d,"DIV",{class:!0});var h=E(e);l=F(h,t),h.forEach(m),s=z(d),i.l(d),a=de(),this.h()},h(){g(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(d,h){V(d,e,h),v(e,l),V(d,s,h),u[r].m(d,h),V(d,a,h),o=!0},p(d,h){(!o||h&16)&&t!==(t=d[4].t("Relevance")+"")&&G(l,t);let _=r;r=c(d),r===_?u[r].p(d,h):(ae(),N(u[_],1,1,()=>{u[_]=null}),oe(),i=u[r],i?i.p(d,h):(i=u[r]=f[r](d),i.c()),k(i,1),i.m(a.parentNode,a))},i(d){o||(k(i),o=!0)},o(d){N(i),o=!1},d(d){d&&(m(e),m(s),m(a)),u[r].d(d)}}}function Kr(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&G(l,t)},i:ye,o:ye,d(s){s&&m(e)}}}function Qr(n){let e,t;return e=new qe({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Yr]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&8202&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Zr(n){let e,t=n[9].distance.toFixed(4)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","text-gray-500 dark:text-gray-500")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r&8&&t!==(t=s[9].distance.toFixed(4)+"")&&G(l,t)},d(s){s&&m(e)}}}function El(n){let e,t=n[12].toFixed(2)+"",l,s,r,i,a,o,f=n[9].distance.toFixed(4)+"",u,c;return{c(){e=I("span"),l=W(t),s=W("%"),i=j(),a=I("span"),o=W("("),u=W(f),c=W(")"),this.h()},l(d){e=M(d,"SPAN",{class:!0});var h=E(e);l=F(h,t),s=F(h,"%"),h.forEach(m),i=z(d),a=M(d,"SPAN",{class:!0});var _=E(a);o=F(_,"("),u=F(_,f),c=F(_,")"),_.forEach(m),this.h()},h(){g(e,"class",r=`px-1 rounded-sm font-medium ${Vl(n[12])}`),g(a,"class","text-gray-500 dark:text-gray-500")},m(d,h){V(d,e,h),v(e,l),v(e,s),V(d,i,h),V(d,a,h),v(a,o),v(a,u),v(a,c)},p(d,h){h&8&&t!==(t=d[12].toFixed(2)+"")&&G(l,t),h&8&&r!==(r=`px-1 rounded-sm font-medium ${Vl(d[12])}`)&&g(e,"class",r),h&8&&f!==(f=d[9].distance.toFixed(4)+"")&&G(u,f)},d(d){d&&(m(e),m(i),m(a))}}}function Yr(n){let e;function t(i,a){return i[1]?El:Zr}function l(i,a){return a===El?Wr(i):i}let s=t(n),r=s(l(n,s));return{c(){e=I("div"),r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=E(e);r.l(a),a.forEach(m),this.h()},h(){g(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,a){V(i,e,a),r.m(e,null)},p(i,a){s===(s=t(i))&&r?r.p(l(i,s),a):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function Xr(n){let e,t,l=n[9].document+"",s,r;return{c(){e=I("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=M(i,"PRE",{class:!0});var a=E(e);t=F(a,"                "),s=F(a,l),r=F(a,`
              `),a.forEach(m),this.h()},h(){g(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,a){V(i,e,a),v(e,t),v(e,s),v(e,r)},p(i,a){a&8&&l!==(l=i[9].document+"")&&G(s,l)},d(i){i&&m(e)}}}function $r(n){let e,t,l;return{c(){e=I("iframe"),this.h()},l(s){e=M(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),E(e).forEach(m),this.h()},h(){g(e,"class","w-full border-0 h-auto rounded-none"),g(e,"sandbox","allow-scripts allow-forms allow-same-origin"),g(e,"srcdoc",t=n[9].document),g(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[9].document)&&g(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&g(e,"title",l)},d(s){s&&m(e)}}}function Dl(n){let e;return{c(){e=I("hr"),this.h()},l(t){e=M(t,"HR",{class:!0}),this.h()},h(){g(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function Nl(n){let e,t,l=n[4].t("Source")+"",s,r,i,a,o,f,u,c=n[4].t("Content")+"",d,h,_,D,b;const y=[Jr,Fr],w=[];function B(O,T){var P;return(P=O[9].source)!=null&&P.name?0:1}i=B(n),a=w[i]=y[i](n);function A(O,T){var P;return(P=O[9].metadata)!=null&&P.html?$r:Xr}let C=A(n),p=C(n),R=n[11]!==n[3].length-1&&Dl();return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),a.c(),o=j(),f=I("div"),u=I("div"),d=W(c),h=j(),p.c(),_=j(),R&&R.c(),D=de(),this.h()},l(O){e=M(O,"DIV",{class:!0});var T=E(e);t=M(T,"DIV",{class:!0});var P=E(t);s=F(P,l),P.forEach(m),r=z(T),a.l(T),T.forEach(m),o=z(O),f=M(O,"DIV",{class:!0});var L=E(f);u=M(L,"DIV",{class:!0});var q=E(u);d=F(q,c),q.forEach(m),h=z(L),p.l(L),L.forEach(m),_=z(O),R&&R.l(O),D=de(),this.h()},h(){g(t,"class","text-sm font-medium dark:text-gray-300"),g(e,"class","flex flex-col w-full"),g(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),g(f,"class","flex flex-col w-full")},m(O,T){V(O,e,T),v(e,t),v(t,s),v(e,r),w[i].m(e,null),V(O,o,T),V(O,f,T),v(f,u),v(u,d),v(f,h),p.m(f,null),V(O,_,T),R&&R.m(O,T),V(O,D,T),b=!0},p(O,T){(!b||T&16)&&l!==(l=O[4].t("Source")+"")&&G(s,l);let P=i;i=B(O),i===P?w[i].p(O,T):(ae(),N(w[P],1,1,()=>{w[P]=null}),oe(),a=w[i],a?a.p(O,T):(a=w[i]=y[i](O),a.c()),k(a,1),a.m(e,null)),(!b||T&16)&&c!==(c=O[4].t("Content")+"")&&G(d,c),C===(C=A(O))&&p?p.p(O,T):(p.d(1),p=C(O),p&&(p.c(),p.m(f,null))),O[11]!==O[3].length-1?R||(R=Dl(),R.c(),R.m(D.parentNode,D)):R&&(R.d(1),R=null)},i(O){b||(k(a),b=!0)},o(O){N(a),b=!1},d(O){O&&(m(e),m(o),m(f),m(_),m(D)),w[i].d(),p.d(),R&&R.d(O)}}}function xr(n){let e,t,l,s=n[4].t("Citation")+"",r,i,a,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,d,h,_,D=Me(n[3]),b=[];for(let w=0;w<D.length;w+=1)b[w]=Nl(yl(n,D,w));const y=w=>N(b[w],1,1,()=>{b[w]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),r=W(s),i=j(),a=I("button"),a.innerHTML=o,f=j(),u=I("div"),c=I("div");for(let w=0;w<b.length;w+=1)b[w].c();this.h()},l(w){e=M(w,"DIV",{});var B=E(e);t=M(B,"DIV",{class:!0});var A=E(t);l=M(A,"DIV",{class:!0});var C=E(l);r=F(C,s),C.forEach(m),i=z(A),a=M(A,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(a)!=="svelte-745w2y"&&(a.innerHTML=o),A.forEach(m),f=z(B),u=M(B,"DIV",{class:!0});var p=E(u);c=M(p,"DIV",{class:!0});var R=E(c);for(let O=0;O<b.length;O+=1)b[O].l(R);R.forEach(m),p.forEach(m),B.forEach(m),this.h()},h(){g(l,"class","text-lg font-medium self-center capitalize"),g(a,"class","self-center"),g(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),g(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),g(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(w,B){V(w,e,B),v(e,t),v(t,l),v(l,r),v(t,i),v(t,a),v(e,f),v(e,u),v(u,c);for(let A=0;A<b.length;A+=1)b[A]&&b[A].m(c,null);d=!0,h||(_=ve(a,"click",n[7]),h=!0)},p(w,B){if((!d||B&16)&&s!==(s=w[4].t("Citation")+"")&&G(r,s),B&30){D=Me(w[3]);let A;for(A=0;A<D.length;A+=1){const C=yl(w,D,A);b[A]?(b[A].p(C,B),k(b[A],1)):(b[A]=Nl(C),b[A].c(),k(b[A],1),b[A].m(c,null))}for(ae(),A=D.length;A<b.length;A+=1)y(A);oe()}},i(w){if(!d){for(let B=0;B<D.length;B+=1)k(b[B]);d=!0}},o(w){b=b.filter(Boolean);for(let B=0;B<b.length;B+=1)N(b[B]);d=!1},d(w){w&&m(e),Ke(b,w),h=!1,_()}}}function ei(n){let e,t,l;function s(i){n[8](i)}let r={size:"lg",$$slots:{default:[xr]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new gn({props:r}),Be.push(()=>Ge(e,"show",s)),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),l=!0},p(i,[a]){const o={};a&8223&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Je(()=>t=!1)),e.$set(o)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){N(e.$$.fragment,i),l=!1},d(i){ne(e,i)}}}function ti(n){return n<0?0:n>1?100:Math.round(n*1e4)/100}function Vl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function li(n,e,t){let l;const s=Qe("i18n");we(n,s,d=>t(4,l=d));let{show:r=!1}=e,{citation:i}=e,{showPercentage:a=!1}=e,{showRelevance:o=!0}=e,f=[];const u=()=>{t(0,r=!1)};function c(d){r=d,t(0,r)}return n.$$set=d=>{"show"in d&&t(0,r=d.show),"citation"in d&&t(6,i=d.citation),"showPercentage"in d&&t(1,a=d.showPercentage),"showRelevance"in d&&t(2,o=d.showRelevance)},n.$$.update=()=>{var d;n.$$.dirty&72&&i&&(t(3,f=(d=i.document)==null?void 0:d.map((h,_)=>{var D,b;return{source:i.source,document:h,metadata:(D=i.metadata)==null?void 0:D[_],distance:(b=i.distances)==null?void 0:b[_]}})),f.every(h=>h.distance!==void 0)&&t(3,f=f.sort((h,_)=>(_.distance??1/0)-(h.distance??1/0))))},[r,a,o,f,l,s,i,u,c]}class si extends Re{constructor(e){super(),Se(this,e,li,ei,Ne,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Cl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Tl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Rl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Sl(n){let e,t,l,s;const r=[ri,ni],i=[];function a(o,f){return o[1].length<=3?0:1}return t=a(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=E(e);l.l(f),f.forEach(m),this.h()},h(){g(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(ae(),N(i[u],1,1,()=>{i[u]=null}),oe(),l=i[t],l?l.p(o,f):(l=i[t]=r[t](o),l.c()),k(l,1),l.m(e,null))},i(o){s||(k(l),s=!0)},o(o){N(l),s=!1},d(o){o&&m(e),i[t].d()}}}function ni(n){let e,t,l;function s(i){n[17](i)}let r={id:"collapsible-sources",className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[fi],default:[oi]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new hn({props:r}),Be.push(()=>Ge(e,"open",s)),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),l=!0},p(i,a){const o={};a&8388851&&(o.$$scope={dirty:a,ctx:i}),!t&&a&64&&(t=!0,o.open=i[6],Je(()=>t=!1)),e.$set(o)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){N(e.$$.fragment,i),l=!1},d(i){ne(e,i)}}}function ri(n){let e,t=Me(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Hl(Rl(n,t,s));return{c(){e=I("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){g(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&51){t=Me(s[1]);let i;for(i=0;i<t.length;i+=1){const a=Rl(s,t,i);l[i]?l[i].p(a,r):(l[i]=Hl(a),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ye,o:ye,d(s){s&&m(e),Ke(l,s)}}}function Bl(n){let e,t=n[20]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),v(e,l)},d(s){s&&m(e)}}}function Ol(n){let e,t=n[1].every(n[12]),l,s,r=n[18].source.name+"",i,a,o,f,u=t&&Bl(n);function c(){return n[16](n[18])}return{c(){e=I("button"),u&&u.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(d){e=M(d,"BUTTON",{class:!0});var h=E(e);u&&u.l(h),l=z(h),s=M(h,"DIV",{class:!0});var _=E(s);i=F(_,r),_.forEach(m),a=z(h),h.forEach(m),this.h()},h(){g(s,"class","flex-1 mx-1 truncate"),g(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,h){V(d,e,h),u&&u.m(e,null),v(e,l),v(e,s),v(s,i),v(e,a),o||(f=[ve(e,"click",c),ve(e,"pointerup",hi)],o=!0)},p(d,h){n=d,h&2&&(t=n[1].every(n[12])),t?u||(u=Bl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[18].source.name+"")&&G(i,r)},d(d){d&&m(e),u&&u.d(),o=!1,ht(f)}}}function ii(n){let e,t;return e=new cn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function ai(n){let e,t;return e=new dn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function oi(n){let e,t,l,s=n[7].t("References from")+"",r,i,a,o,f,u,c,d=n[7].t("and")+"",h,_,D=n[1].length-2+"",b,y,w,B=n[7].t("more")+"",A,C,p,R,O,T,P=Me(n[1].slice(0,2)),L=[];for(let x=0;x<P.length;x+=1)L[x]=Ol(Cl(n,P,x));const q=[ai,ii],X=[];function ce(x,ee){return x[6]?0:1}return R=ce(n),O=X[R]=q[R](n),{c(){e=I("div"),t=I("div"),l=I("span"),r=W(s),i=j(),a=I("div"),o=I("div");for(let x=0;x<L.length;x+=1)L[x].c();f=j(),u=I("div"),c=I("span"),h=W(d),_=j(),b=W(D),y=j(),w=I("span"),A=W(B),C=j(),p=I("div"),O.c(),this.h()},l(x){e=M(x,"DIV",{class:!0});var ee=E(e);t=M(ee,"DIV",{class:!0});var he=E(t);l=M(he,"SPAN",{class:!0});var ue=E(l);r=F(ue,s),ue.forEach(m),i=z(he),a=M(he,"DIV",{class:!0});var _e=E(a);o=M(_e,"DIV",{class:!0});var Q=E(o);for(let me=0;me<L.length;me+=1)L[me].l(Q);Q.forEach(m),_e.forEach(m),f=z(he),u=M(he,"DIV",{class:!0});var J=E(u);c=M(J,"SPAN",{class:!0});var H=E(c);h=F(H,d),H.forEach(m),_=z(J),b=F(J,D),y=z(J),w=M(J,"SPAN",{});var ie=E(w);A=F(ie,B),ie.forEach(m),J.forEach(m),he.forEach(m),C=z(ee),p=M(ee,"DIV",{class:!0});var re=E(p);O.l(re),re.forEach(m),ee.forEach(m),this.h()},h(){g(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),g(o,"class","flex text-xs font-medium items-center"),g(a,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),g(c,"class","hidden sm:inline"),g(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),g(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),g(p,"class","shrink-0"),g(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(x,ee){V(x,e,ee),v(e,t),v(t,l),v(l,r),v(t,i),v(t,a),v(a,o);for(let he=0;he<L.length;he+=1)L[he]&&L[he].m(o,null);v(t,f),v(t,u),v(u,c),v(c,h),v(u,_),v(u,b),v(u,y),v(u,w),v(w,A),v(e,C),v(e,p),X[R].m(p,null),T=!0},p(x,ee){if((!T||ee&128)&&s!==(s=x[7].t("References from")+"")&&G(r,s),ee&50){P=Me(x[1].slice(0,2));let ue;for(ue=0;ue<P.length;ue+=1){const _e=Cl(x,P,ue);L[ue]?L[ue].p(_e,ee):(L[ue]=Ol(_e),L[ue].c(),L[ue].m(o,null))}for(;ue<L.length;ue+=1)L[ue].d(1);L.length=P.length}(!T||ee&128)&&d!==(d=x[7].t("and")+"")&&G(h,d),(!T||ee&2)&&D!==(D=x[1].length-2+"")&&G(b,D),(!T||ee&128)&&B!==(B=x[7].t("more")+"")&&G(A,B);let he=R;R=ce(x),R!==he&&(ae(),N(X[he],1,1,()=>{X[he]=null}),oe(),O=X[R],O||(O=X[R]=q[R](x),O.c()),k(O,1),O.m(p,null))},i(x){T||(k(O),T=!0)},o(x){N(O),T=!1},d(x){x&&m(e),Ke(L,x),X[R].d()}}}function Ll(n){let e,t=n[20]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),v(e,l)},d(s){s&&m(e)}}}function Pl(n){let e,t=n[1].every(n[11]),l,s,r=n[18].source.name+"",i,a,o,f,u,c=t&&Ll(n);function d(){return n[15](n[18])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(h){e=M(h,"BUTTON",{id:!0,class:!0});var _=E(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var D=E(s);i=F(D,r),D.forEach(m),a=z(_),_.forEach(m),this.h()},h(){g(s,"class","flex-1 mx-1 truncate"),g(e,"id",o=`source-${n[0]}-${n[20]}`),g(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(h,_){V(h,e,_),c&&c.m(e,null),v(e,l),v(e,s),v(s,i),v(e,a),f||(u=ve(e,"click",d),f=!0)},p(h,_){n=h,_&2&&(t=n[1].every(n[11])),t?c||(c=Ll(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[18].source.name+"")&&G(i,r),_&1&&o!==(o=`source-${n[0]}-${n[20]}`)&&g(e,"id",o)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function fi(n){let e,t,l=Me(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Pl(Tl(n,l,r));return{c(){e=I("div"),t=I("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=M(r,"DIV",{slot:!0});var i=E(e);t=M(i,"DIV",{class:!0});var a=E(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),i.forEach(m),this.h()},h(){g(t,"class","flex text-xs font-medium flex-wrap"),g(e,"slot","content")},m(r,i){V(r,e,i),v(e,t);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(r,i){if(i&51){l=Me(r[1]);let a;for(a=0;a<l.length;a+=1){const o=Tl(r,l,a);s[a]?s[a].p(o,i):(s[a]=Pl(o),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(r){r&&m(e),Ke(s,r)}}}function Al(n){let e,t=n[20]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),v(e,l)},d(s){s&&m(e)}}}function Hl(n){let e,t=n[1].every(n[10]),l,s,r=n[18].source.name+"",i,a,o,f,u,c=t&&Al(n);function d(){return n[14](n[18])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=W(r),a=j(),this.h()},l(h){e=M(h,"BUTTON",{id:!0,class:!0});var _=E(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var D=E(s);i=F(D,r),D.forEach(m),a=z(_),_.forEach(m),this.h()},h(){g(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),g(e,"id",o=`source-${n[0]}-${n[20]}`),g(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(h,_){V(h,e,_),c&&c.m(e,null),v(e,l),v(e,s),v(s,i),v(e,a),f||(u=ve(e,"click",d),f=!0)},p(h,_){n=h,_&2&&(t=n[1].every(n[10])),t?c||(c=Al(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[18].source.name+"")&&G(i,r),_&1&&o!==(o=`source-${n[0]}-${n[20]}`)&&g(e,"id",o)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function ui(n){let e,t,l,s,r;function i(f){n[13](f)}let a={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(a.show=n[4]),e=new si({props:a}),Be.push(()=>Ge(e,"show",i));let o=n[1].length>0&&Sl(n);return{c(){te(e.$$.fragment),l=j(),o&&o.c(),s=de()},l(f){le(e.$$.fragment,f),l=z(f),o&&o.l(f),s=de()},m(f,u){se(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Je(()=>t=!1)),e.$set(c),f[1].length>0?o?(o.p(f,u),u&2&&k(o,1)):(o=Sl(f),o.c(),k(o,1),o.m(s.parentNode,s)):o&&(ae(),N(o,1,1,()=>{o=null}),oe())},i(f){r||(k(e.$$.fragment,f),k(o),r=!0)},o(f){N(e.$$.fragment,f),N(o),r=!1},d(f){f&&(m(l),m(s)),ne(e,f),o&&o.d(f)}}}function ci(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function di(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const hi=n=>{n.stopPropagation()};function mi(n,e,t){let l;const s=Qe("i18n");we(n,s,C=>t(7,l=C));let{id:r=""}=e,{sources:i=[]}=e,a=[],o=!1,f=!0,u=!1,c=null,d=!1;const h=C=>C.distances!==void 0,_=C=>C.distances!==void 0,D=C=>C.distances!==void 0;function b(C){u=C,t(4,u)}const y=C=>{t(4,u=!0),t(5,c=C)},w=C=>{t(4,u=!0),t(5,c=C)},B=C=>{t(4,u=!0),t(5,c=C)};function A(C){d=C,t(6,d)}return n.$$set=C=>{"id"in C&&t(0,r=C.id),"sources"in C&&t(9,i=C.sources)},n.$$.update=()=>{n.$$.dirty&514&&(console.log("sources",i),t(1,a=i.reduce((C,p)=>(Object.keys(p).length===0||p.document.forEach((R,O)=>{var ce,x,ee;const T=(ce=p.metadata)==null?void 0:ce[O],P=(x=p.distances)==null?void 0:x[O],L=(T==null?void 0:T.source)??((ee=p==null?void 0:p.source)==null?void 0:ee.id)??"N/A";let q=p==null?void 0:p.source;T!=null&&T.name&&(q={...q,name:T.name}),(L.startsWith("http://")||L.startsWith("https://"))&&(q={...q,name:L,url:L});const X=C.find(he=>he.id===L);X?(X.document.push(R),X.metadata.push(T),P!==void 0&&X.distances.push(P)):C.push({id:L,source:q,document:[R],metadata:T?[T]:[],distances:P!==void 0?[P]:void 0})}),C),[])),t(3,f=ci(a)),t(2,o=di(a)))},[r,a,o,f,u,c,d,l,s,i,h,_,D,b,y,w,B,A]}class gi extends Re{constructor(e){super(),Se(this,e,mi,ui,Ne,{id:0,sources:9})}}function jl(n,e,t){const l=n.slice();return l[6]=e[t],l}function zl(n){let e,t,l,s;const r=[bi,vi,_i],i=[];function a(o,f){var u,c;return(u=o[1].result)!=null&&u.error?0:(c=o[1].result)!=null&&c.output?1:2}return t=a(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c()},l(o){e=M(o,"DIV",{});var f=E(e);l.l(f),f.forEach(m)},m(o,f){V(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t!==u&&(ae(),N(i[u],1,1,()=>{i[u]=null}),oe(),l=i[t],l||(l=i[t]=r[t](o),l.c()),k(l,1),l.m(e,null))},i(o){s||(k(l),s=!0)},o(o){N(l),s=!1},d(o){o&&m(e),i[t].d()}}}function _i(n){let e,t;return e=new Jt({props:{type:"warning",content:"incomplete"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function vi(n){let e,t;return e=new Jt({props:{type:"success",content:"success"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function bi(n){let e,t;return e=new Jt({props:{type:"error",content:"error"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function ql(n){let e,t,l;return t=new jt({props:{className:"size-4"}}),{c(){e=I("div"),te(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=E(e);le(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),se(t,e,null),l=!0},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function pi(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&G(t,e)},d(l){l&&m(t)}}}function ki(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(a){t=F(a,e),l=F(a,": "),r=F(a,s)},m(a,o){V(a,t,o),V(a,l,o),V(a,r,o)},p(a,o){var f;o&4&&e!==(e=a[2].t("Code execution")+"")&&G(t,e),o&2&&s!==(s=((f=a[1])==null?void 0:f.name)+"")&&G(r,s)},d(a){a&&(m(t),m(l),m(r))}}}function Ul(n){var r,i,a,o;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Wl(n),s=((o=(a=n[1])==null?void 0:a.result)==null?void 0:o.output)&&Fl(n);return{c(){e=I("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=E(e);l&&l.l(u),t=z(u),s&&s.l(u),u.forEach(m),this.h()},h(){g(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),v(e,t),s&&s.m(e,null)},p(f,u){var c,d,h,_;(d=(c=f[1])==null?void 0:c.result)!=null&&d.error?l?l.p(f,u):(l=Wl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(h=f[1])==null?void 0:h.result)!=null&&_.output?s?s.p(f,u):(s=Fl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Wl(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",o;return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),i=I("div"),o=W(a),this.h()},l(c){e=M(c,"DIV",{});var d=E(e);t=M(d,"DIV",{class:!0});var h=E(t);s=F(h,l),h.forEach(m),r=z(d),i=M(d,"DIV",{class:!0});var _=E(i);o=F(_,a),_.forEach(m),d.forEach(m),this.h()},h(){g(t,"class","text-gray-500 text-xs mb-1"),g(i,"class","text-sm")},m(c,d){V(c,e,d),v(e,t),v(t,s),v(e,r),v(e,i),v(i,o)},p(c,d){var h,_;d&4&&l!==(l=c[2].t("ERROR")+"")&&G(s,l),d&2&&a!==(a=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.error)+"")&&G(o,a)},d(c){c&&m(e)}}}function Fl(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,a=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",o;return{c(){e=I("div"),t=I("div"),s=W(l),r=j(),i=I("div"),o=W(a),this.h()},l(c){e=M(c,"DIV",{});var d=E(e);t=M(d,"DIV",{class:!0});var h=E(t);s=F(h,l),h.forEach(m),r=z(d),i=M(d,"DIV",{class:!0});var _=E(i);o=F(_,a),_.forEach(m),d.forEach(m),this.h()},h(){g(t,"class","text-gray-500 text-xs mb-1"),g(i,"class","text-sm")},m(c,d){V(c,e,d),v(e,t),v(t,s),v(e,r),v(e,i),v(i,o)},p(c,d){var h,_;d&4&&l!==(l=c[2].t("OUTPUT")+"")&&G(s,l),d&2&&a!==(a=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.output)+"")&&G(o,a)},d(c){c&&m(e)}}}function Jl(n){var c,d;let e,t,l,s,r=n[2].t("Files")+"",i,a,o,f=Me((d=(c=n[1])==null?void 0:c.result)==null?void 0:d.files),u=[];for(let h=0;h<f.length;h+=1)u[h]=Gl(jl(n,f,h));return{c(){e=I("div"),t=I("hr"),l=j(),s=I("div"),i=W(r),a=j(),o=I("ul");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=M(h,"DIV",{class:!0});var _=E(e);t=M(_,"HR",{class:!0}),l=z(_),s=M(_,"DIV",{class:!0});var D=E(s);i=F(D,r),D.forEach(m),a=z(_),o=M(_,"UL",{class:!0});var b=E(o);for(let y=0;y<u.length;y+=1)u[y].l(b);b.forEach(m),_.forEach(m),this.h()},h(){g(t,"class","border-gray-100 dark:border-gray-850 my-2"),g(s,"class","text-sm font-medium dark:text-gray-300"),g(o,"class","mt-1 list-disc pl-4 text-xs"),g(e,"class","flex flex-col w-full")},m(h,_){V(h,e,_),v(e,t),v(e,l),v(e,s),v(s,i),v(e,a),v(e,o);for(let D=0;D<u.length;D+=1)u[D]&&u[D].m(o,null)},p(h,_){var D,b;if(_&4&&r!==(r=h[2].t("Files")+"")&&G(i,r),_&2){f=Me((b=(D=h[1])==null?void 0:D.result)==null?void 0:b.files);let y;for(y=0;y<f.length;y+=1){const w=jl(h,f,y);u[y]?u[y].p(w,_):(u[y]=Gl(w),u[y].c(),u[y].m(o,null))}for(;y<u.length;y+=1)u[y].d(1);u.length=f.length}},d(h){h&&m(e),Ke(u,h)}}}function Gl(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=I("li"),t=I("a"),s=W(l),i=j(),this.h()},l(a){e=M(a,"LI",{});var o=E(e);t=M(o,"A",{href:!0,target:!0});var f=E(t);s=F(f,l),f.forEach(m),i=z(o),o.forEach(m),this.h()},h(){g(t,"href",r=n[6].url),g(t,"target","_blank")},m(a,o){V(a,e,o),v(e,t),v(t,s),v(e,i)},p(a,o){o&2&&l!==(l=a[6].name+"")&&G(s,l),o&2&&r!==(r=a[6].url)&&g(t,"href",r)},d(a){a&&m(e)}}}function wi(n){var q,X,ce,x,ee,he,ue,_e,Q,J,H,ie,re,me,be,ge,S,K,Z;let e,t,l,s,r,i,a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,d,h,_,D,b,y,w,B,A,C=((q=n[1])==null?void 0:q.result)&&zl(n),p=!((X=n[1])!=null&&X.result)&&ql();function R($,Y){var fe;return(fe=$[1])!=null&&fe.name?ki:pi}let O=R(n),T=O(n);D=new tr({props:{id:"code-exec-"+((ce=n[1])==null?void 0:ce.id)+"-code",lang:((x=n[1])==null?void 0:x.language)??"",code:((ee=n[1])==null?void 0:ee.code)??"",className:"",editorClassName:(he=n[1])!=null&&he.result&&((_e=(ue=n[1])==null?void 0:ue.result)!=null&&_e.error||(J=(Q=n[1])==null?void 0:Q.result)!=null&&J.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let P=((H=n[1])==null?void 0:H.result)&&(((re=(ie=n[1])==null?void 0:ie.result)==null?void 0:re.error)||((be=(me=n[1])==null?void 0:me.result)==null?void 0:be.output))&&Ul(n),L=((S=(ge=n[1])==null?void 0:ge.result)==null?void 0:S.files)&&((Z=(K=n[1])==null?void 0:K.result)==null?void 0:Z.files.length)>0&&Jl(n);return{c(){e=I("div"),t=I("div"),l=I("div"),C&&C.c(),s=j(),r=I("div"),p&&p.c(),i=j(),a=I("div"),T.c(),o=j(),f=I("button"),f.innerHTML=u,c=j(),d=I("div"),h=I("div"),_=I("div"),te(D.$$.fragment),b=j(),P&&P.c(),y=j(),L&&L.c(),this.h()},l($){e=M($,"DIV",{});var Y=E(e);t=M(Y,"DIV",{class:!0});var fe=E(t);l=M(fe,"DIV",{class:!0});var ke=E(l);C&&C.l(ke),s=z(ke),r=M(ke,"DIV",{class:!0});var Te=E(r);p&&p.l(Te),i=z(Te),a=M(Te,"DIV",{});var De=E(a);T.l(De),De.forEach(m),Te.forEach(m),ke.forEach(m),o=z(fe),f=M(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(f)!=="svelte-vnrwun"&&(f.innerHTML=u),fe.forEach(m),c=z(Y),d=M(Y,"DIV",{class:!0});var Oe=E(d);h=M(Oe,"DIV",{class:!0});var Ae=E(h);_=M(Ae,"DIV",{class:!0});var Ue=E(_);le(D.$$.fragment,Ue),Ue.forEach(m),b=z(Ae),P&&P.l(Ae),y=z(Ae),L&&L.l(Ae),Ae.forEach(m),Oe.forEach(m),Y.forEach(m),this.h()},h(){g(r,"class","flex gap-2 items-center"),g(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),g(f,"class","self-center"),g(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),g(_,"class","flex flex-col w-full"),g(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),g(d,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m($,Y){V($,e,Y),v(e,t),v(t,l),C&&C.m(l,null),v(l,s),v(l,r),p&&p.m(r,null),v(r,i),v(r,a),T.m(a,null),v(t,o),v(t,f),v(e,c),v(e,d),v(d,h),v(h,_),se(D,_,null),v(h,b),P&&P.m(h,null),v(h,y),L&&L.m(h,null),w=!0,B||(A=ve(f,"click",n[4]),B=!0)},p($,Y){var ke,Te,De,Oe,Ae,Ue,et,tt,rt,it,xe,at,ot,lt,It,Mt,Et,Dt,Nt;(ke=$[1])!=null&&ke.result?C?(C.p($,Y),Y&2&&k(C,1)):(C=zl($),C.c(),k(C,1),C.m(l,s)):C&&(ae(),N(C,1,1,()=>{C=null}),oe()),(Te=$[1])!=null&&Te.result?p&&(ae(),N(p,1,1,()=>{p=null}),oe()):p?Y&2&&k(p,1):(p=ql(),p.c(),k(p,1),p.m(r,i)),O===(O=R($))&&T?T.p($,Y):(T.d(1),T=O($),T&&(T.c(),T.m(a,null)));const fe={};Y&2&&(fe.id="code-exec-"+((De=$[1])==null?void 0:De.id)+"-code"),Y&2&&(fe.lang=((Oe=$[1])==null?void 0:Oe.language)??""),Y&2&&(fe.code=((Ae=$[1])==null?void 0:Ae.code)??""),Y&2&&(fe.editorClassName=(Ue=$[1])!=null&&Ue.result&&((tt=(et=$[1])==null?void 0:et.result)!=null&&tt.error||(it=(rt=$[1])==null?void 0:rt.result)!=null&&it.output)?"rounded-b-none":""),D.$set(fe),(xe=$[1])!=null&&xe.result&&((ot=(at=$[1])==null?void 0:at.result)!=null&&ot.error||(It=(lt=$[1])==null?void 0:lt.result)!=null&&It.output)?P?P.p($,Y):(P=Ul($),P.c(),P.m(h,y)):P&&(P.d(1),P=null),(Et=(Mt=$[1])==null?void 0:Mt.result)!=null&&Et.files&&((Nt=(Dt=$[1])==null?void 0:Dt.result)==null?void 0:Nt.files.length)>0?L?L.p($,Y):(L=Jl($),L.c(),L.m(h,null)):L&&(L.d(1),L=null)},i($){w||(k(C),k(p),k(D.$$.fragment,$),w=!0)},o($){N(C),N(p),N(D.$$.fragment,$),w=!1},d($){$&&m(e),C&&C.d(),p&&p.d(),T.d(),ne(D),P&&P.d(),L&&L.d(),B=!1,A()}}}function yi(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[wi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new gn({props:r}),Be.push(()=>Ge(e,"show",s)),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),l=!0},p(i,[a]){const o={};a&519&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Je(()=>t=!1)),e.$set(o)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){N(e.$$.fragment,i),l=!1},d(i){ne(e,i)}}}function Ii(n,e,t){let l;const s=Qe("i18n");we(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const a=()=>{t(0,r=!1),t(1,i=null)};function o(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,a,o]}class Mi extends Re{constructor(e){super(),Se(this,e,Ii,yi,Ne,{show:0,codeExecution:1})}}function Kl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Ql(n){let e,t=[],l=new Map,s,r=Me(n[0]);const i=a=>a[6].id;for(let a=0;a<r.length;a+=1){let o=Kl(n,r,a),f=i(o);l.set(f,t[a]=Zl(f,o))}return{c(){e=I("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var o=E(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(m),this.h()},h(){g(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(a,o){V(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(a,o){o&7&&(r=Me(a[0]),ae(),t=tn(t,o,i,1,a,r,l,e,ln,Zl,null,Kl),oe())},i(a){if(!s){for(let o=0;o<r.length;o+=1)k(t[o]);s=!0}},o(a){for(let o=0;o<t.length;o+=1)N(t[o]);s=!1},d(a){a&&m(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Ei(n){let e,t;return e=new jt({props:{className:"size-4"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p:ye,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Di(n){let e,t,l,s;const r=[Ci,Vi,Ni],i=[];function a(o,f){var u,c;return(u=o[6].result)!=null&&u.error?0:(c=o[6].result)!=null&&c.output?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e!==u&&(ae(),N(i[u],1,1,()=>{i[u]=null}),oe(),t=i[e],t||(t=i[e]=r[e](o),t.c()),k(t,1),t.m(l.parentNode,l))},i(o){s||(k(t),s=!0)},o(o){N(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Ni(n){let e,t;return e=new or({}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Vi(n){let e,t;return e=new ir({props:{strokeWidth:"3",className:"size-3"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Ci(n){let e,t;return e=new ar({}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Zl(n,e){let t,l,s,r,i,a,o,f=e[6].name+"",u,c,d,h,_,D;const b=[Di,Ei],y=[];function w(A,C){var p;return(p=A[6])!=null&&p.result?0:1}r=w(e),i=y[r]=b[r](e);function B(){return e[4](e[6])}return{key:n,first:null,c(){t=I("div"),l=I("button"),s=I("div"),i.c(),a=j(),o=I("div"),u=W(f),d=j(),this.h()},l(A){t=M(A,"DIV",{class:!0});var C=E(t);l=M(C,"BUTTON",{class:!0});var p=E(l);s=M(p,"DIV",{class:!0});var R=E(s);i.l(R),R.forEach(m),a=z(p),o=M(p,"DIV",{class:!0});var O=E(o);u=F(O,f),O.forEach(m),p.forEach(m),d=z(C),C.forEach(m),this.h()},h(){var A;g(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),g(o,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((A=e[6])!=null&&A.result?"":"pulse")+" svelte-1gvtig2"),g(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),g(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(A,C){V(A,t,C),v(t,l),v(l,s),y[r].m(s,null),v(l,a),v(l,o),v(o,u),v(t,d),h=!0,_||(D=ve(l,"click",B),_=!0)},p(A,C){var R;e=A;let p=r;r=w(e),r===p?y[r].p(e,C):(ae(),N(y[p],1,1,()=>{y[p]=null}),oe(),i=y[r],i?i.p(e,C):(i=y[r]=b[r](e),i.c()),k(i,1),i.m(s,null)),(!h||C&1)&&f!==(f=e[6].name+"")&&G(u,f),(!h||C&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((R=e[6])!=null&&R.result?"":"pulse")+" svelte-1gvtig2"))&&g(o,"class",c)},i(A){h||(k(i),h=!0)},o(A){N(i),h=!1},d(A){A&&m(t),y[r].d(),_=!1,D()}}}function Ti(n){let e,t,l,s,r;function i(f){n[3](f)}let a={codeExecution:n[1]};n[2]!==void 0&&(a.show=n[2]),e=new Mi({props:a}),Be.push(()=>Ge(e,"show",i));let o=n[0].length>0&&Ql(n);return{c(){te(e.$$.fragment),l=j(),o&&o.c(),s=de()},l(f){le(e.$$.fragment,f),l=z(f),o&&o.l(f),s=de()},m(f,u){se(e,f,u),V(f,l,u),o&&o.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Je(()=>t=!1)),e.$set(c),f[0].length>0?o?(o.p(f,u),u&1&&k(o,1)):(o=Ql(f),o.c(),k(o,1),o.m(s.parentNode,s)):o&&(ae(),N(o,1,1,()=>{o=null}),oe())},i(f){r||(k(e.$$.fragment,f),k(o),r=!0)},o(f){N(e.$$.fragment,f),N(o),r=!1},d(f){f&&(m(l),m(s)),ne(e,f),o&&o.d(f)}}}function Ri(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function a(f){r=f,t(2,r)}const o=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,a,o]}class Si extends Re{constructor(e){super(),Se(this,e,Ri,Ti,Ne,{codeExecutions:0})}}function Bi(n){let e,t,l,s,r;t=new Wt({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[16],[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[17]),t.$on("code",n[18]);let i=vt;return{c(){e=I("div"),te(t.$$.fragment),l=j(),s=de()},l(a){e=M(a,"DIV",{});var o=E(e);le(t.$$.fragment,o),o.forEach(m),l=z(a),s=de()},m(a,o){V(a,e,o),se(t,e,null),n[19](e),V(a,l,o),V(a,s,o),r=!0},p(a,[o]){const f={};o&1&&(f.id=a[0]),o&2&&(f.content=a[1]),o&8&&(f.model=a[3]),o&32&&(f.save=a[5]),o&24&&(f.sourceIds=(a[4]??[]).reduce(a[16],[])),o&128&&(f.onSourceClick=a[7]),o&256&&(f.onTaskClick=a[8]),t.$set(f)},i(a){r||(k(t.$$.fragment,a),k(i),r=!0)},o(a){N(t.$$.fragment,a),N(i),r=!1},d(a){a&&(m(e),m(l),m(s)),ne(t),n[19](null)}}}function Oi(n,e,t){let l,s;we(n,sn,L=>t(12,l=L)),we(n,qn,L=>t(13,s=L)),Qe("i18n");const r=mt();let{id:i}=e,{content:a}=e,{history:o}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:d=!0}=e,{onSourceClick:h=()=>{}}=e,{onTaskClick:_=()=>{}}=e,{onAddMessages:D=()=>{}}=e,b,y;const w=L=>{const q=document.getElementById(`floating-buttons-${i}`);if(!(b!=null&&b.contains(L.target))&&!(q!=null&&q.contains(L.target))){B();return}setTimeout(async()=>{if(await Ee(),!(b!=null&&b.contains(L.target)))return;let X=window.getSelection();if(X.toString().trim().length>0){const x=X.getRangeAt(0).getBoundingClientRect(),ee=b.getBoundingClientRect(),he=x.bottom-ee.top,ue=x.left-ee.left;if(q){q.style.display="block";const _e=ee.width-ue;let Q=l?window.innerWidth/2:window.innerWidth/3;if(_e<Q){const J=ee.right-x.right;q.style.right=`${J}px`,q.style.left="auto"}else q.style.left=`${ue}px`,q.style.right="auto";q.style.top=`${he+5}px`}}else B()},0)},B=()=>{const L=document.getElementById(`floating-buttons-${i}`);L&&(L.style.display="none"),y&&y.closeHandler()},A=L=>{L.key==="Escape"&&B()};kt(()=>{d&&(b==null||b.addEventListener("mouseup",w),document.addEventListener("mouseup",w),document.addEventListener("keydown",A))}),Hn(()=>{d&&(b==null||b.removeEventListener("mouseup",w),document.removeEventListener("mouseup",w),document.removeEventListener("keydown",A))});const C=(L,q)=>{let X=[];return q.document.forEach((ce,x)=>{var ue,_e,Q,J,H;if(((Q=(_e=(ue=f==null?void 0:f.info)==null?void 0:ue.meta)==null?void 0:_e.capabilities)==null?void 0:Q.citations)==!1)return X.push("N/A"),X;const ee=(J=q.metadata)==null?void 0:J[x],he=(ee==null?void 0:ee.source)??"N/A";return ee!=null&&ee.name?(X.push(ee.name),X):(he.startsWith("http://")||he.startsWith("https://")?X.push(he):X.push(((H=q==null?void 0:q.source)==null?void 0:H.name)??he),X)}),L=[...L,...X],L.filter((ce,x)=>L.indexOf(ce)===x)},p=L=>{r("update",L.detail)},R=L=>{const{lang:q,code:X}=L.detail;(["html","svg"].includes(q)||q==="xml"&&X.includes("svg"))&&!l&&s&&(Un.set(!0),Wn.set(!0))};function O(L){Be[L?"unshift":"push"](()=>{b=L,t(10,b)})}const T=({modelId:L,parentId:q,messages:X})=>{console.log(L,q,X),D({modelId:L,parentId:q,messages:X}),B()};function P(L){Be[L?"unshift":"push"](()=>{y=L,t(11,y)})}return n.$$set=L=>{"id"in L&&t(0,i=L.id),"content"in L&&t(1,a=L.content),"history"in L&&t(2,o=L.history),"model"in L&&t(3,f=L.model),"sources"in L&&t(4,u=L.sources),"save"in L&&t(5,c=L.save),"floatingButtons"in L&&t(6,d=L.floatingButtons),"onSourceClick"in L&&t(7,h=L.onSourceClick),"onTaskClick"in L&&t(8,_=L.onTaskClick),"onAddMessages"in L&&t(9,D=L.onAddMessages)},[i,a,o,f,u,c,d,h,_,D,b,y,l,s,r,B,C,p,R,O,T,P]}class Li extends Re{constructor(e){super(),Se(this,e,Oi,Bi,Ne,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function zt(n){var l,s,r;const e=n.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(r=e[12])==null?void 0:r.status]:[]]).at(-1);return e[83]=t,e}function Yl(n,e,t){const l=n.slice();return l[84]=e[t],l}function Pi(n){var s;let e,t=(((s=n[16])==null?void 0:s.name)??n[12].model)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(r){e=M(r,"SPAN",{class:!0});var i=E(e);l=F(i,t),i.forEach(m),this.h()},h(){g(e,"class","line-clamp-1")},m(r,i){V(r,e,i),v(e,l)},p(r,i){var a;i[0]&69632&&t!==(t=(((a=r[16])==null?void 0:a.name)??r[12].model)+"")&&G(l,t)},d(r){r&&m(e)}}}function Xl(n){let e,t,l;return t=new qe({props:{content:nt(n[12].timestamp*1e3).format("LLLL"),$$slots:{default:[Ai]},$$scope:{ctx:n}}}),{c(){e=I("div"),te(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);le(t.$$.fragment,r),r.forEach(m),this.h()},h(){g(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),se(t,e,null),l=!0},p(s,r){const i={};r[0]&4096&&(i.content=nt(s[12].timestamp*1e3).format("LLLL")),r[0]&4096|r[2]&33554432&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function Ai(n){let e,t=Ot(n[12].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","line-clamp-1")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r[0]&4096&&t!==(t=Ot(s[12].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function Hi(n){var i;let e,t,l,s;e=new qe({props:{content:((i=n[16])==null?void 0:i.name)??n[12].model,placement:"top-start",$$slots:{default:[Pi]},$$scope:{ctx:n}}});let r=n[12].timestamp&&Xl(n);return{c(){te(e.$$.fragment),t=j(),r&&r.c(),l=de()},l(a){le(e.$$.fragment,a),t=z(a),r&&r.l(a),l=de()},m(a,o){se(e,a,o),V(a,t,o),r&&r.m(a,o),V(a,l,o),s=!0},p(a,o){var u;const f={};o[0]&69632&&(f.content=((u=a[16])==null?void 0:u.name)??a[12].model),o[0]&69632|o[2]&33554432&&(f.$$scope={dirty:o,ctx:a}),e.$set(f),a[12].timestamp?r?(r.p(a,o),o[0]&4096&&k(r,1)):(r=Xl(a),r.c(),k(r,1),r.m(l.parentNode,l)):r&&(ae(),N(r,1,1,()=>{r=null}),oe())},i(a){s||(k(e.$$.fragment,a),k(r),s=!0)},o(a){N(e.$$.fragment,a),N(r),s=!1},d(a){a&&(m(t),m(l)),ne(e,a),r&&r.d(a)}}}function $l(n){let e,t,l=Me(n[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=es(Yl(n,l,i));const r=i=>N(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var a=E(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){g(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4096){l=Me(i[12].files);let o;for(o=0;o<l.length;o+=1){const f=Yl(i,l,o);s[o]?(s[o].p(f,a),k(s[o],1)):(s[o]=es(f),s[o].c(),k(s[o],1),s[o].m(e,null))}for(ae(),o=l.length;o<s.length;o+=1)r(o);oe()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)k(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)N(s[a]);t=!1},d(i){i&&m(e),Ke(s,i)}}}function xl(n){let e,t;return e=new un({props:{src:n[84].url,alt:n[12].content}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.src=l[84].url),s[0]&4096&&(r.alt=l[12].content),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function es(n){let e,t,l,s=n[84].type==="image"&&xl(n);return{c(){e=I("div"),s&&s.c(),t=j()},l(r){e=M(r,"DIV",{});var i=E(e);s&&s.l(i),t=z(i),i.forEach(m)},m(r,i){V(r,e,i),s&&s.m(e,null),v(e,t),l=!0},p(r,i){r[84].type==="image"?s?(s.p(r,i),i[0]&4096&&k(s,1)):(s=xl(r),s.c(),k(s,1),s.m(e,t)):s&&(ae(),N(s,1,1,()=>{s=null}),oe())},i(r){l||(k(s),l=!0)},o(r){N(s),l=!1},d(r){r&&m(e),s&&s.d()}}}function ts(n){var s;let e,t,l=!((s=n[83])!=null&&s.hidden)&&ls(n);return{c(){l&&l.c(),e=de()},l(r){l&&l.l(r),e=de()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var a;(a=r[83])!=null&&a.hidden?l&&(ae(),N(l,1,1,()=>{l=null}),oe()):l?(l.p(r,i),i[0]&4096&&k(l,1)):(l=ls(r),l.c(),k(l,1),l.m(e.parentNode,e))},i(r){t||(k(l),t=!0)},o(r){N(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function ls(n){var u;let e,t,l,s,r,i=((u=n[83])==null?void 0:u.done)===!1&&ss();const a=[qi,zi,ji],o=[];function f(c,d){var h,_,D;return((h=c[83])==null?void 0:h.action)==="web_search"&&((_=c[83])!=null&&_.urls)?0:((D=c[83])==null?void 0:D.action)==="knowledge_search"?1:2}return l=f(n),s=o[l]=a[l](n),{c(){e=I("div"),i&&i.c(),t=j(),s.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var d=E(e);i&&i.l(d),t=z(d),s.l(d),d.forEach(m),this.h()},h(){g(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,d){V(c,e,d),i&&i.m(e,null),v(e,t),o[l].m(e,null),r=!0},p(c,d){var _;((_=c[83])==null?void 0:_.done)===!1?i?d[0]&4096&&k(i,1):(i=ss(),i.c(),k(i,1),i.m(e,t)):i&&(ae(),N(i,1,1,()=>{i=null}),oe());let h=l;l=f(c),l===h?o[l].p(c,d):(ae(),N(o[h],1,1,()=>{o[h]=null}),oe(),s=o[l],s?s.p(c,d):(s=o[l]=a[l](c),s.c()),k(s,1),s.m(e,null))},i(c){r||(k(i),k(s),r=!0)},o(c){N(i),N(s),r=!1},d(c){c&&m(e),i&&i.d(),o[l].d()}}}function ss(n){let e,t,l;return t=new jt({props:{className:"size-4"}}),{c(){e=I("div"),te(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);le(t.$$.fragment,r),r.forEach(m),this.h()},h(){g(e,"class","")},m(s,r){V(s,e,r),se(t,e,null),l=!0},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function ji(n){let e,t,l,s;function r(o,f){var u,c,d;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[83])!=null&&u.description.includes("{{searchQuery}}"))),l?Ji:((c=o[83])==null?void 0:c.description)==="No search query generated"?Fi:((d=o[83])==null?void 0:d.description)==="Generating search query"?Wi:Ui}let i=r(n,[-1,-1,-1]),a=i(n);return{c(){e=I("div"),t=I("div"),a.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=E(e);t=M(f,"DIV",{class:!0});var u=E(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;g(t,"class",s=(((o=n[83])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),g(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),v(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[83])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&g(t,"class",s)},i:ye,o:ye,d(o){o&&m(e),a.d()}}}function zi(n){let e,t,l=n[26].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[83].query})+"",s,r;return{c(){e=I("div"),t=I("div"),s=W(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=E(e);t=M(a,"DIV",{class:!0});var o=E(t);s=F(o,l),o.forEach(m),a.forEach(m),this.h()},h(){var i;g(t,"class",r=(((i=n[83])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),g(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,a){V(i,e,a),v(e,t),v(t,s)},p(i,a){var o;a[0]&67112960&&l!==(l=i[26].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[83].query})+"")&&G(s,l),a[0]&4096&&r!==(r=(((o=i[83])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&g(t,"class",r)},i:ye,o:ye,d(i){i&&m(e)}}}function qi(n){let e,t;return e=new jr({props:{status:n[83],$$slots:{default:[Yi]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.status=l[83]),s[0]&67112960|s[2]&33554432&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Ui(n){var l;let e=((l=n[83])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[83])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Wi(n){let e=n[26].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function Fi(n){let e=n[26].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Ji(n){var l,s;let e=n[26].t((l=n[83])==null?void 0:l.description,{searchQuery:(s=n[83])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=F(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&67112960&&e!==(e=r[26].t((a=r[83])==null?void 0:a.description,{searchQuery:(o=r[83])==null?void 0:o.query})+"")&&G(t,e)},d(r){r&&m(t)}}}function Gi(n){var l;let e=((l=n[83])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[83])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Ki(n){let e=n[26].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function Qi(n){let e=n[26].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Zi(n){var l,s;let e=n[26].t((l=n[83])==null?void 0:l.description,{count:(s=n[83])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=F(r,e)},m(r,i){V(r,t,i)},p(r,i){var a,o;i[0]&67112960&&e!==(e=r[26].t((a=r[83])==null?void 0:a.description,{count:(o=r[83])==null?void 0:o.urls.length})+"")&&G(t,e)},d(r){r&&m(t)}}}function Yi(n){let e,t,l,s;function r(o,f){var u,c,d;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[83])!=null&&u.description.includes("{{count}}"))),l?Zi:((c=o[83])==null?void 0:c.description)==="No search query generated"?Qi:((d=o[83])==null?void 0:d.description)==="Generating search query"?Ki:Gi}let i=r(n,[-1,-1,-1]),a=i(n);return{c(){e=I("div"),t=I("div"),a.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var f=E(e);t=M(f,"DIV",{class:!0});var u=E(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;g(t,"class",s=(((o=n[83])==null?void 0:o.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),g(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){V(o,e,f),v(e,t),a.m(t,null)},p(o,f){var u;i===(i=r(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[83])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&g(t,"class",s)},d(o){o&&m(e),a.d()}}}function Xi(n){var _,D,b,y,w,B,A;let e,t,l,s,r,i,a;const o=[ea,xi],f=[];function u(C,p){return C[12].content===""&&!C[12].error?0:C[12].content&&C[12].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=o[t](n));let c=((_=n[12])==null?void 0:_.error)&&ns(n),d=(((D=n[12])==null?void 0:D.sources)||((b=n[12])==null?void 0:b.citations))&&(((A=(B=(w=(y=n[16])==null?void 0:y.info)==null?void 0:w.meta)==null?void 0:B.capabilities)==null?void 0:A.citations)??!0)&&rs(n),h=n[12].code_executions&&is(n);return{c(){e=I("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),d&&d.c(),i=j(),h&&h.c(),this.h()},l(C){e=M(C,"DIV",{class:!0,id:!0});var p=E(e);l&&l.l(p),s=z(p),c&&c.l(p),r=z(p),d&&d.l(p),i=z(p),h&&h.l(p),p.forEach(m),this.h()},h(){g(e,"class","w-full flex flex-col relative"),g(e,"id","response-content-container")},m(C,p){V(C,e,p),~t&&f[t].m(e,null),v(e,s),c&&c.m(e,null),v(e,r),d&&d.m(e,null),v(e,i),h&&h.m(e,null),a=!0},p(C,p){var O,T,P,L,q,X,ce;let R=t;t=u(C),t===R?~t&&f[t].p(C,p):(l&&(ae(),N(f[R],1,1,()=>{f[R]=null}),oe()),~t?(l=f[t],l?l.p(C,p):(l=f[t]=o[t](C),l.c()),k(l,1),l.m(e,s)):l=null),(O=C[12])!=null&&O.error?c?(c.p(C,p),p[0]&4096&&k(c,1)):(c=ns(C),c.c(),k(c,1),c.m(e,r)):c&&(ae(),N(c,1,1,()=>{c=null}),oe()),((T=C[12])!=null&&T.sources||(P=C[12])!=null&&P.citations)&&(((ce=(X=(q=(L=C[16])==null?void 0:L.info)==null?void 0:q.meta)==null?void 0:X.capabilities)==null?void 0:ce.citations)??!0)?d?(d.p(C,p),p[0]&69632&&k(d,1)):(d=rs(C),d.c(),k(d,1),d.m(e,i)):d&&(ae(),N(d,1,1,()=>{d=null}),oe()),C[12].code_executions?h?(h.p(C,p),p[0]&4096&&k(h,1)):(h=is(C),h.c(),k(h,1),h.m(e,null)):h&&(ae(),N(h,1,1,()=>{h=null}),oe())},i(C){a||(k(l),k(c),k(d),k(h),a=!0)},o(C){N(l),N(c),N(d),N(h),a=!1},d(C){C&&m(e),~t&&f[t].d(),c&&c.d(),d&&d.d(),h&&h.d()}}}function $i(n){let e,t,l,s,r,i,a,o=n[26].t("Save As Copy")+"",f,u,c,d,h=n[26].t("Cancel")+"",_,D,b,y=n[26].t("Save")+"",w,B,A;return{c(){e=I("div"),t=I("textarea"),s=j(),r=I("div"),i=I("div"),a=I("button"),f=W(o),u=j(),c=I("div"),d=I("button"),_=W(h),D=j(),b=I("button"),w=W(y),this.h()},l(C){e=M(C,"DIV",{class:!0});var p=E(e);t=M(p,"TEXTAREA",{id:!0,class:!0}),E(t).forEach(m),s=z(p),r=M(p,"DIV",{class:!0});var R=E(r);i=M(R,"DIV",{});var O=E(i);a=M(O,"BUTTON",{id:!0,class:!0});var T=E(a);f=F(T,o),T.forEach(m),O.forEach(m),u=z(R),c=M(R,"DIV",{class:!0});var P=E(c);d=M(P,"BUTTON",{id:!0,class:!0});var L=E(d);_=F(L,h),L.forEach(m),D=z(P),b=M(P,"BUTTON",{id:!0,class:!0});var q=E(b);w=F(q,y),q.forEach(m),P.forEach(m),R.forEach(m),p.forEach(m),this.h()},h(){g(t,"id",l="message-edit-"+n[12].id),g(t,"class","bg-transparent outline-hidden w-full resize-none"),g(a,"id","save-new-message-button"),g(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),g(d,"id","close-edit-message-button"),g(d,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),g(b,"id","confirm-edit-message-button"),g(b,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),g(c,"class","flex space-x-1.5"),g(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),g(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(C,p){V(C,e,p),v(e,t),n[48](t),bt(t,n[17]),v(e,s),v(e,r),v(r,i),v(i,a),v(a,f),v(r,u),v(r,c),v(c,d),v(d,_),v(c,D),v(c,b),v(b,w),B||(A=[ve(t,"input",n[49]),ve(t,"input",aa),ve(t,"keydown",n[50]),ve(a,"click",n[51]),ve(d,"click",n[52]),ve(b,"click",n[53])],B=!0)},p(C,p){p[0]&4096&&l!==(l="message-edit-"+C[12].id)&&g(t,"id",l),p[0]&131072&&bt(t,C[17]),p[0]&67108864&&o!==(o=C[26].t("Save As Copy")+"")&&G(f,o),p[0]&67108864&&h!==(h=C[26].t("Cancel")+"")&&G(_,h),p[0]&67108864&&y!==(y=C[26].t("Save")+"")&&G(w,y)},i:ye,o:ye,d(C){C&&m(e),n[48](null),B=!1,ht(A)}}}function xi(n){var l;let e,t;return e=new Li({props:{id:n[12].id,history:n[0],content:n[12].content,sources:n[12].sources,floatingButtons:(l=n[12])==null?void 0:l.done,save:!n[11],model:n[16],onTaskClick:n[54],onSourceClick:n[55],onAddMessages:n[56]}}),e.$on("update",n[57]),e.$on("select",n[58]),{c(){te(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){se(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&4096&&(i.id=s[12].id),r[0]&1&&(i.history=s[0]),r[0]&4096&&(i.content=s[12].content),r[0]&4096&&(i.sources=s[12].sources),r[0]&4096&&(i.floatingButtons=(a=s[12])==null?void 0:a.done),r[0]&2048&&(i.save=!s[11]),r[0]&65536&&(i.model=s[16]),r[0]&4096&&(i.onSourceClick=s[55]),r[0]&512&&(i.onAddMessages=s[56]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function ea(n){let e,t;return e=new _n({}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p:ye,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function ns(n){var l,s;let e,t;return e=new Ur({props:{content:((s=(l=n[12])==null?void 0:l.error)==null?void 0:s.content)??n[12].content}}),{c(){te(e.$$.fragment)},l(r){le(e.$$.fragment,r)},m(r,i){se(e,r,i),t=!0},p(r,i){var o,f;const a={};i[0]&4096&&(a.content=((f=(o=r[12])==null?void 0:o.error)==null?void 0:f.content)??r[12].content),e.$set(a)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){ne(e,r)}}}function rs(n){var l,s,r;let e,t;return e=new gi({props:{id:(l=n[12])==null?void 0:l.id,sources:((s=n[12])==null?void 0:s.sources)??((r=n[12])==null?void 0:r.citations)}}),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),t=!0},p(i,a){var f,u,c;const o={};a[0]&4096&&(o.id=(f=i[12])==null?void 0:f.id),a[0]&4096&&(o.sources=((u=i[12])==null?void 0:u.sources)??((c=i[12])==null?void 0:c.citations)),e.$set(o)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function is(n){let e,t;return e=new Si({props:{codeExecutions:n[12].code_executions}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.codeExecutions=l[12].code_executions),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function as(n){let e,t,l,s,r=(n[12].done||n[1].length>1)&&os(n),i=n[12].done&&n[22]&&hs(n);return{c(){e=I("div"),r&&r.c(),t=j(),i&&i.c(),l=de(),this.h()},l(a){e=M(a,"DIV",{class:!0});var o=E(e);r&&r.l(o),o.forEach(m),t=z(a),i&&i.l(a),l=de(),this.h()},h(){g(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(a,o){V(a,e,o),r&&r.m(e,null),n[72](e),V(a,t,o),i&&i.m(a,o),V(a,l,o),s=!0},p(a,o){a[12].done||a[1].length>1?r?(r.p(a,o),o[0]&4098&&k(r,1)):(r=os(a),r.c(),k(r,1),r.m(e,null)):r&&(ae(),N(r,1,1,()=>{r=null}),oe()),a[12].done&&a[22]?i?(i.p(a,o),o[0]&4198400&&k(i,1)):(i=hs(a),i.c(),k(i,1),i.m(l.parentNode,l)):i&&(ae(),N(i,1,1,()=>{i=null}),oe())},i(a){s||(k(r),k(i),s=!0)},o(a){N(r),N(i),s=!1},d(a){a&&(m(e),m(t),m(l)),r&&r.d(),n[72](null),i&&i.d(a)}}}function os(n){let e,t,l,s=n[1].length>1&&fs(n),r=n[12].done&&us(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=de()},l(i){s&&s.l(i),e=z(i),r&&r.l(i),t=de()},m(i,a){s&&s.m(i,a),V(i,e,a),r&&r.m(i,a),V(i,t,a),l=!0},p(i,a){i[1].length>1?s?s.p(i,a):(s=fs(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[12].done?r?(r.p(i,a),a[0]&4096&&k(r,1)):(r=us(i),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(ae(),N(r,1,1,()=>{r=null}),oe())},i(i){l||(k(r),l=!0)},o(i){N(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function fs(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[12].id)+1+"",a,o,f=n[1].length+"",u,c,d,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),r=I("div"),a=W(i),o=W("/"),u=W(f),c=j(),d=I("button"),d.innerHTML=h,this.h()},l(b){e=M(b,"DIV",{class:!0,dir:!0});var y=E(e);t=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=z(y),r=M(y,"DIV",{class:!0});var w=E(r);a=F(w,i),o=F(w,"/"),u=F(w,f),w.forEach(m),c=z(y),d=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(d)!=="svelte-107ksnk"&&(d.innerHTML=h),y.forEach(m),this.h()},h(){g(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),g(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(e,"class","flex self-center min-w-fit"),g(e,"dir","ltr")},m(b,y){V(b,e,y),v(e,t),v(e,s),v(e,r),v(r,a),v(r,o),v(r,u),v(e,c),v(e,d),_||(D=[ve(t,"click",n[59]),ve(d,"click",n[60])],_=!0)},p(b,y){y[0]&4098&&i!==(i=b[1].indexOf(b[12].id)+1+"")&&G(a,i),y[0]&2&&f!==(f=b[1].length+"")&&G(u,f)},d(b){b&&m(e),_=!1,ht(D)}}}function us(n){var _,D,b,y;let e,t,l,s,r,i,a,o,f=vt;t=new qe({props:{content:n[26].t("Copy"),placement:"bottom",$$slots:{default:[ta]},$$scope:{ctx:n}}});let u=vt,c=((_=n[25])==null?void 0:_.features.enable_image_generation)&&(n[27].role==="admin"||((y=(b=(D=n[27])==null?void 0:D.permissions)==null?void 0:b.features)==null?void 0:y.image_generation))&&!n[11]&&cs(n),d=n[12].usage&&ds(n),h=vt;return{c(){e=j(),te(t.$$.fragment),l=j(),s=j(),c&&c.c(),r=j(),d&&d.c(),i=j(),a=de()},l(w){e=z(w),le(t.$$.fragment,w),l=z(w),s=z(w),c&&c.l(w),r=z(w),d&&d.l(w),i=z(w),a=de()},m(w,B){V(w,e,B),se(t,w,B),V(w,l,B),V(w,s,B),c&&c.m(w,B),V(w,r,B),d&&d.m(w,B),V(w,i,B),V(w,a,B),o=!0},p(w,B){var C,p,R,O;const A={};B[0]&67108864&&(A.content=w[26].t("Copy")),B[0]&5120|B[2]&33554432&&(A.$$scope={dirty:B,ctx:w}),t.$set(A),(C=w[25])!=null&&C.features.enable_image_generation&&(w[27].role==="admin"||(O=(R=(p=w[27])==null?void 0:p.permissions)==null?void 0:R.features)!=null&&O.image_generation)&&!w[11]?c?(c.p(w,B),B[0]&167774208&&k(c,1)):(c=cs(w),c.c(),k(c,1),c.m(r.parentNode,r)):c&&(ae(),N(c,1,1,()=>{c=null}),oe()),w[12].usage?d?(d.p(w,B),B[0]&4096&&k(d,1)):(d=ds(w),d.c(),k(d,1),d.m(i.parentNode,i)):d&&(ae(),N(d,1,1,()=>{d=null}),oe())},i(w){o||(k(f),k(t.$$.fragment,w),k(u),k(c),k(d),k(h),o=!0)},o(w){N(f),N(t.$$.fragment,w),N(u),N(c),N(d),N(h),o=!1},d(w){w&&(m(e),m(l),m(s),m(r),m(i),m(a)),ne(t,w),c&&c.d(w),d&&d.d(w)}}}function ta(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=Le("svg"),l=Le("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var o=E(e);t=Pe(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=E(t);l=Pe(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){g(l,"stroke-linecap","round"),g(l,"stroke-linejoin","round"),g(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(t,"stroke-width","2.3"),g(t,"stroke","currentColor"),g(t,"class","w-4 h-4"),g(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,o){V(a,e,o),v(e,t),v(t,l),r||(i=ve(e,"click",n[62]),r=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&g(e,"class",s)},d(a){a&&m(e),r=!1,i()}}}function cs(n){let e,t;return e=new qe({props:{content:n[26].t("Generate Image"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&67108864&&(r.content=l[26].t("Generate Image")),s[0]&2102272|s[2]&33554432&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function la(n){let e,t;return{c(){e=Le("svg"),t=Le("path"),this.h()},l(l){e=Pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=E(e);t=Pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(t).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke-linecap","round"),g(t,"stroke-linejoin","round"),g(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"fill","none"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","2.3"),g(e,"stroke","currentColor"),g(e,"class","w-4 h-4")},m(l,s){V(l,e,s),v(e,t)},d(l){l&&m(e)}}}function sa(n){let e,t,l,s,r,i;return{c(){e=Le("svg"),t=Le("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=Le("circle"),r=Le("circle"),i=Le("circle"),this.h()},l(a){e=Pe(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=E(e);t=Pe(o,"style",{});var f=E(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=Pe(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(s).forEach(m),r=Pe(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(r).forEach(m),i=Pe(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(i).forEach(m),o.forEach(m),this.h()},h(){g(s,"class","spinner_S1WN"),g(s,"cx","4"),g(s,"cy","12"),g(s,"r","3"),g(r,"class","spinner_S1WN spinner_Km9P"),g(r,"cx","12"),g(r,"cy","12"),g(r,"r","3"),g(i,"class","spinner_S1WN spinner_JApP"),g(i,"cx","20"),g(i,"cy","12"),g(i,"r","3"),g(e,"class","w-4 h-4"),g(e,"fill","currentColor"),g(e,"viewBox","0 0 24 24"),g(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){V(a,e,o),v(e,t),v(t,l),v(e,s),v(e,r),v(e,i)},d(a){a&&m(e)}}}function na(n){let e,t,l,s;function r(o,f){return o[21]?sa:la}let i=r(n),a=i(n);return{c(){e=I("button"),a.c(),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var f=E(e);a.l(f),f.forEach(m),this.h()},h(){g(e,"class",t=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,f){V(o,e,f),a.m(e,null),l||(s=ve(e,"click",n[64]),l=!0)},p(o,f){i!==(i=r(o))&&(a.d(1),a=i(o),a&&(a.c(),a.m(e,null))),f[0]&1024&&t!==(t=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&g(e,"class",t)},d(o){o&&m(e),a.d(),l=!1,s()}}}function ds(n){let e,t;return e=new qe({props:{content:n[12].usage?`<pre>${pt(JSON.stringify(n[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(_s).map(vs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[ra]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.content=l[12].usage?`<pre>${pt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(_s).map(vs).join(`
`))}</pre>`:""),s[0]&5120|s[2]&33554432&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function ra(n){let e,t,l,s,r,i,a;return{c(){e=I("button"),t=Le("svg"),l=Le("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0,id:!0});var f=E(e);t=Pe(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=E(t);l=Pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){g(l,"stroke-linecap","round"),g(l,"stroke-linejoin","round"),g(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"fill","none"),g(t,"viewBox","0 0 24 24"),g(t,"stroke-width","2.3"),g(t,"stroke","currentColor"),g(t,"class","w-4 h-4"),g(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),g(e,"id",r="info-"+n[12].id)},m(o,f){V(o,e,f),v(e,t),v(t,l),i||(a=ve(e,"click",n[65]),i=!0)},p(o,f){f[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&g(e,"class",s),f[0]&4096&&r!==(r="info-"+o[12].id)&&g(e,"id",r)},d(o){o&&m(e),i=!1,a()}}}function hs(n){let e,t,l,s;function r(o){n[73](o)}function i(o){n[74](o)}let a={};return n[12]!==void 0&&(a.message=n[12]),n[22]!==void 0&&(a.show=n[22]),e=new Sr({props:a}),Be.push(()=>Ge(e,"message",r)),Be.push(()=>Ge(e,"show",i)),e.$on("save",n[75]),{c(){te(e.$$.fragment)},l(o){le(e.$$.fragment,o)},m(o,f){se(e,o,f),s=!0},p(o,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=o[12],Je(()=>t=!1)),!l&&f[0]&4194304&&(l=!0,u.show=o[22],Je(()=>l=!1)),e.$set(u)},i(o){s||(k(e.$$.fragment,o),s=!0)},o(o){N(e.$$.fragment,o),s=!1},d(o){ne(e,o)}}}function ms(n){var X,ce,x,ee,he,ue,_e,Q;let e,t,l,s,r,i,a,o,f,u=((X=n[12])==null?void 0:X.files)&&((ce=n[12].files)==null?void 0:ce.filter(gs).length)>0,c,d,h,_,D,b,y,w,B,A,C,p;l=new fn({props:{src:((he=(ee=(x=n[16])==null?void 0:x.info)==null?void 0:ee.meta)==null?void 0:he.profile_image_url)??(n[26].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`),className:"size-8"}}),a=new Ft({props:{$$slots:{default:[Hi]},$$scope:{ctx:n}}});let R=u&&$l(n),O=(((ue=n[12])==null?void 0:ue.statusHistory)??[...(_e=n[12])!=null&&_e.status?[(Q=n[12])==null?void 0:Q.status]:[]]).length>0&&ts(zt(n));const T=[$i,Xi],P=[];function L(J,H){return J[13]===!0?0:1}D=L(n),b=P[D]=T[D](n);let q=!n[13]&&as(n);return{c(){e=I("div"),t=I("div"),te(l.$$.fragment),r=j(),i=I("div"),te(a.$$.fragment),o=j(),f=I("div"),R&&R.c(),c=j(),d=I("div"),h=I("div"),O&&O.c(),_=j(),b.c(),w=j(),q&&q.c(),this.h()},l(J){e=M(J,"DIV",{class:!0,id:!0,dir:!0});var H=E(e);t=M(H,"DIV",{class:!0});var ie=E(t);le(l.$$.fragment,ie),ie.forEach(m),r=z(H),i=M(H,"DIV",{class:!0});var re=E(i);le(a.$$.fragment,re),o=z(re),f=M(re,"DIV",{});var me=E(f);R&&R.l(me),c=z(me),d=M(me,"DIV",{class:!0});var be=E(d);h=M(be,"DIV",{});var ge=E(h);O&&O.l(ge),_=z(ge),b.l(ge),ge.forEach(m),be.forEach(m),w=z(me),q&&q.l(me),me.forEach(m),re.forEach(m),H.forEach(m),this.h()},h(){var J;g(t,"class",s=rl(`shrink-0 ${(((J=n[24])==null?void 0:J.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),g(d,"class",y="chat-"+n[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),g(i,"class","flex-auto w-0 pl-1"),g(e,"class",B="flex w-full message-"+n[12].id+" svelte-1u5gq5j"),g(e,"id",A="message-"+n[12].id),g(e,"dir",C=n[24].chatDirection)},m(J,H){V(J,e,H),v(e,t),se(l,t,null),v(e,r),v(e,i),se(a,i,null),v(i,o),v(i,f),R&&R.m(f,null),v(f,c),v(f,d),v(d,h),O&&O.m(h,null),v(h,_),P[D].m(h,null),v(f,w),q&&q.m(f,null),p=!0},p(J,H){var be,ge,S,K,Z,$,Y,fe,ke;const ie={};H[0]&67174400&&(ie.src=((S=(ge=(be=J[16])==null?void 0:be.info)==null?void 0:ge.meta)==null?void 0:S.profile_image_url)??(J[26].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`)),l.$set(ie),(!p||H[0]&16777216&&s!==(s=rl(`shrink-0 ${(((K=J[24])==null?void 0:K.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&g(t,"class",s);const re={};H[0]&69632|H[2]&33554432&&(re.$$scope={dirty:H,ctx:J}),a.$set(re),H[0]&4096&&(u=((Z=J[12])==null?void 0:Z.files)&&(($=J[12].files)==null?void 0:$.filter(gs).length)>0),u?R?(R.p(J,H),H[0]&4096&&k(R,1)):(R=$l(J),R.c(),k(R,1),R.m(f,c)):R&&(ae(),N(R,1,1,()=>{R=null}),oe()),(((Y=J[12])==null?void 0:Y.statusHistory)??[...(fe=J[12])!=null&&fe.status?[(ke=J[12])==null?void 0:ke.status]:[]]).length>0?O?(O.p(zt(J),H),H[0]&4096&&k(O,1)):(O=ts(zt(J)),O.c(),k(O,1),O.m(h,_)):O&&(ae(),N(O,1,1,()=>{O=null}),oe());let me=D;D=L(J),D===me?P[D].p(J,H):(ae(),N(P[me],1,1,()=>{P[me]=null}),oe(),b=P[D],b?b.p(J,H):(b=P[D]=T[D](J),b.c()),k(b,1),b.m(h,null)),(!p||H[0]&4096&&y!==(y="chat-"+J[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&g(d,"class",y),J[13]?q&&(ae(),N(q,1,1,()=>{q=null}),oe()):q?(q.p(J,H),H[0]&8192&&k(q,1)):(q=as(J),q.c(),k(q,1),q.m(f,null)),(!p||H[0]&4096&&B!==(B="flex w-full message-"+J[12].id+" svelte-1u5gq5j"))&&g(e,"class",B),(!p||H[0]&4096&&A!==(A="message-"+J[12].id))&&g(e,"id",A),(!p||H[0]&16777216&&C!==(C=J[24].chatDirection))&&g(e,"dir",C)},i(J){p||(k(l.$$.fragment,J),k(a.$$.fragment,J),k(R),k(O),k(b),k(q),p=!0)},o(J){N(l.$$.fragment,J),N(a.$$.fragment,J),N(R),N(O),N(b),N(q),p=!1},d(J){J&&m(e),ne(l),ne(a),R&&R.d(),O&&O.d(),P[D].d(),q&&q.d()}}}function ia(n){let e,t,l,s=n[12].id,r,i;function a(u){n[46](u)}let o={title:n[26].t("Delete message?")};n[15]!==void 0&&(o.show=n[15]),e=new mn({props:o}),Be.push(()=>Ge(e,"show",a)),e.$on("confirm",n[47]);let f=ms(n);return{c(){te(e.$$.fragment),l=j(),f.c(),r=de()},l(u){le(e.$$.fragment,u),l=z(u),f.l(u),r=de()},m(u,c){se(e,u,c),V(u,l,c),f.m(u,c),V(u,r,c),i=!0},p(u,c){const d={};c[0]&67108864&&(d.title=u[26].t("Delete message?")),!t&&c[0]&32768&&(t=!0,d.show=u[15],Je(()=>t=!1)),e.$set(d),c[0]&4096&&Ne(s,s=u[12].id)?(ae(),N(f,1,1,ye),oe(),f=ms(u),f.c(),k(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(k(e.$$.fragment,u),k(f),i=!0)},o(u){N(e.$$.fragment,u),N(f),i=!1},d(u){u&&(m(l),m(r)),ne(e,u),f.d(u)}}}const gs=n=>n.type==="image",aa=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},_s=n=>n.slice(2),vs=n=>n.endsWith(",")?n.slice(0,-1):n;function oa(n,e,t){let l,s,r,i,a,o;we(n,Pt,U=>t(45,l=U)),we(n,At,U=>t(24,s=U)),we(n,nn,U=>t(25,r=U)),we(n,ol,U=>t(78,i=U)),we(n,Ht,U=>t(27,o=U));const f=Qe("i18n");we(n,f,U=>t(26,a=U));const u=mt();let{chatId:c=""}=e,{history:d}=e,{messageId:h}=e,_=JSON.parse(JSON.stringify(d.messages[h])),{siblings:D}=e,{showPreviousMessage:b}=e,{showNextMessage:y}=e,{updateChat:w}=e,{editMessage:B}=e,{saveMessage:A}=e,{rateMessage:C}=e,{actionMessage:p}=e,{deleteMessage:R}=e,{submitMessage:O}=e,{continueResponse:T}=e,{regenerateResponse:P}=e,{addMessages:L}=e,{isLastMessage:q=!0}=e,{readOnly:X=!1}=e,ce,x=!1,ee=null,he=!1,ue="",_e,Q={},J=!1,H,ie=!1,re=!1,me=!1;const be=async U=>{await an(U)&&je.success(a.t("Copying to clipboard was successful!"))},ge=U=>new Promise(Ie=>{H=U;const pe=Q[U];if(!pe)return Ie();pe.play(),pe.onended=async()=>{await new Promise(Ce=>setTimeout(Ce,300)),Object.keys(Q).length-1===U&&t(19,J=!1),Ie()}}),S=async()=>{var U,Ie,pe,Ce,We,Xe,Vt,ft,wt,Ve,Fe,st,yt,Ct,Gt,Kt,Qt,Zt,Yt,Xt,$t,xt,el;if(J){try{speechSynthesis.cancel(),H!==void 0&&Q[H]&&(Q[H].pause(),Q[H].currentTime=0)}catch{}t(19,J=!1),H=void 0;return}if(!((_==null?void 0:_.content)??"").trim().length){je.info(a.t("No content to speak"));return}if(t(19,J=!0),r.audio.tts.engine===""){let Ze=[];const gt=setInterval(()=>{var Ye,ut,$e;if(Ze=speechSynthesis.getVoices(),Ze.length>0){clearInterval(gt);const He=((Ye=Ze==null?void 0:Ze.filter(dt=>{var tl,ll,sl,nl;return dt.voiceURI===(((ll=(tl=s==null?void 0:s.audio)==null?void 0:tl.tts)==null?void 0:ll.voice)??((nl=(sl=r==null?void 0:r.audio)==null?void 0:sl.tts)==null?void 0:nl.voice))}))==null?void 0:Ye.at(0))??void 0;console.log(He);const ct=new SpeechSynthesisUtterance(_.content);ct.rate=(($e=(ut=s.audio)==null?void 0:ut.tts)==null?void 0:$e.playbackRate)??1,console.log(ct),ct.onend=()=>{var dt;t(19,J=!1),s.conversationMode&&((dt=document.getElementById("voice-input-button"))==null||dt.click())},He&&(ct.voice=He),speechSynthesis.speak(ct)}},100)}else{t(20,ie=!0);const Ze=Zn(_.content,((Ie=(U=r==null?void 0:r.audio)==null?void 0:U.tts)==null?void 0:Ie.split_on)??"punctuation");if(!Ze.length){console.log("No content to speak"),je.info(a.t("No content to speak")),t(19,J=!1),t(20,ie=!1);return}console.debug("Prepared message content for TTS",Ze),Q=Ze.reduce((Ye,ut,$e)=>(Ye[$e]=null,Ye),{});let gt=Promise.resolve();if(((Ce=(pe=s.audio)==null?void 0:pe.tts)==null?void 0:Ce.engine)==="browser-kokoro"){i||(await ol.set(new dr({dtype:((Vt=(Xe=(We=s.audio)==null?void 0:We.tts)==null?void 0:Xe.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await i.init());for(const[Ye,ut]of Ze.entries()){const $e=await i.generate({text:ut,voice:((wt=(ft=s==null?void 0:s.audio)==null?void 0:ft.tts)==null?void 0:wt.voice)??((Fe=(Ve=r==null?void 0:r.audio)==null?void 0:Ve.tts)==null?void 0:Fe.voice)}).catch(He=>{console.error(He),je.error(`${He}`),t(19,J=!1),t(20,ie=!1)});if($e){const He=new Audio($e);He.playbackRate=((yt=(st=s.audio)==null?void 0:st.tts)==null?void 0:yt.playbackRate)??1,Q[Ye]=He,t(20,ie=!1),gt=gt.then(()=>ge(Ye))}}}else for(const[Ye,ut]of Ze.entries()){const $e=await xn(localStorage.token,((Gt=(Ct=s==null?void 0:s.audio)==null?void 0:Ct.tts)==null?void 0:Gt.defaultVoice)===r.audio.tts.voice?((Qt=(Kt=s==null?void 0:s.audio)==null?void 0:Kt.tts)==null?void 0:Qt.voice)??((Yt=(Zt=r==null?void 0:r.audio)==null?void 0:Zt.tts)==null?void 0:Yt.voice):($t=(Xt=r==null?void 0:r.audio)==null?void 0:Xt.tts)==null?void 0:$t.voice,ut).catch(He=>{console.error(He),je.error(`${He}`),t(19,J=!1),t(20,ie=!1)});if($e){const He=await $e.blob(),ct=URL.createObjectURL(He),dt=new Audio(ct);dt.playbackRate=((el=(xt=s.audio)==null?void 0:xt.tts)==null?void 0:el.playbackRate)??1,Q[Ye]=dt,t(20,ie=!1),gt=gt.then(()=>ge(Ye))}}}},K=async()=>{t(13,he=!0),t(17,ue=_.content),await Ee(),t(18,_e.style.height="",_e),t(18,_e.style.height=`${_e.scrollHeight}px`,_e)},Z=async()=>{B(_.id,ue||"",!1),t(13,he=!1),t(17,ue=""),await Ee()},$=async()=>{B(_.id,ue||""),t(13,he=!1),t(17,ue=""),await Ee()},Y=async()=>{t(13,he=!1),t(17,ue=""),await Ee()},fe=async U=>{t(21,re=!0);const Ie=await er(localStorage.token,U.content).catch(pe=>{je.error(`${pe}`)});if(console.log(Ie),Ie){const pe=Ie.map(Ce=>({type:"image",url:`${Ce.url}`}));A(U.id,{...U,files:pe})}t(21,re=!1)};let ke=!1;const Te=async(U=null,Ie=null)=>{var wt;t(23,ke=!0),console.log("Feedback",U,Ie);const pe={..._,annotation:{...(_==null?void 0:_.annotation)??{},...U!==null?{rating:U}:{},...Ie||{}}},Ce=await Gn(localStorage.token,c).catch(Ve=>{je.error(`${Ve}`)});if(!Ce)return;const We=Yn(d,_.id);let Xe={type:"rating",data:{...pe!=null&&pe.annotation?pe.annotation:{},model_id:(_==null?void 0:_.selectedModelId)??_.model,...d.messages[_.parentId].childrenIds.length>1?{sibling_model_ids:d.messages[_.parentId].childrenIds.filter(Ve=>Ve!==_.id).map(Ve=>{var Fe;return((Fe=d.messages[Ve])==null?void 0:Fe.selectedModelId)??d.messages[Ve].model})}:{}},meta:{arena:_?_.arena:!1,model_id:_.model,message_id:_.id,message_index:We.length,chat_id:c},snapshot:{chat:Ce}};const Vt=[Xe.data.model_id,...Xe.data.sibling_model_ids??[]].reduce((Ve,Fe)=>{var yt;const st=l.find(Ct=>Ct.id===Fe);return st?Ve[st.id]=((yt=st==null?void 0:st.info)==null?void 0:yt.base_model_id)??null:console.warn(`Model with ID ${Fe} not found`),Ve},{});Xe.meta.base_models=Vt;let ft=null;if(_!=null&&_.feedbackId?ft=await cl(localStorage.token,_.feedbackId,Xe).catch(Ve=>{je.error(`${Ve}`)}):(ft=await Xn(localStorage.token,Xe).catch(Ve=>{je.error(`${Ve}`)}),ft&&(pe.feedbackId=ft.id)),console.log(pe),A(_.id,pe),await Ee(),!Ie&&(t(22,me=!0),!((wt=pe.annotation)!=null&&wt.tags))){const Ve=await $n(localStorage.token,_.model,We,c).catch(Fe=>(console.error(Fe),[]));console.log(Ve),Ve&&(pe.annotation.tags=Ve,Xe.data.tags=Ve,A(_.id,pe),await cl(localStorage.token,pe.feedbackId,Xe).catch(Fe=>{je.error(`${Fe}`)}))}t(23,ke=!1)},De=async()=>{R(_.id)};kt(async()=>{await Ee(),ce&&(console.log(ce),ce.addEventListener("wheel",function(U){U.preventDefault(),U.deltaY!==0&&t(14,ce.scrollLeft+=U.deltaY,ce)}))});function Oe(U){x=U,t(15,x)}const Ae=()=>{De()};function Ue(U){Be[U?"unshift":"push"](()=>{_e=U,t(18,_e)})}function et(){ue=this.value,t(17,ue)}const tt=U=>{var Ce,We;U.key==="Escape"&&((Ce=document.getElementById("close-edit-message-button"))==null||Ce.click());const Ie=U.metaKey||U.ctrlKey,pe=U.key==="Enter";Ie&&pe&&((We=document.getElementById("confirm-edit-message-button"))==null||We.click())},rt=()=>{$()},it=()=>{Y()},xe=()=>{Z()},at=async U=>{console.log(U)},ot=async(U,Ie)=>{console.log(U,Ie);let pe=document.getElementById(`source-${_.id}-${Ie}`);const Ce=document.getElementById("collapsible-sources");pe?pe.click():Ce&&(Ce.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(We=>{requestAnimationFrame(()=>{requestAnimationFrame(We)})}),pe=document.getElementById(`source-${_.id}-${Ie}`),pe&&pe.click())},lt=({modelId:U,parentId:Ie,messages:pe})=>{L({modelId:U,parentId:Ie,messages:pe})},It=U=>{const{raw:Ie,oldContent:pe,newContent:Ce}=U.detail;t(0,d.messages[_.id].content=d.messages[_.id].content.replace(Ie,Ie.replace(pe,Ce)),d),w()},Mt=U=>{var Ce;const{type:Ie,content:pe}=U.detail;if(Ie==="explain")O(_.id,`Explain this section to me in more detail

\`\`\`
${pe}
\`\`\``);else if(Ie==="ask"){const We=((Ce=U.detail)==null?void 0:Ce.input)??"";O(_.id,`\`\`\`
${pe}
\`\`\`
${We}`)}},Et=()=>{b(_)},Dt=()=>{y(_)},Nt=()=>{K()},bn=()=>{be(_.content)},pn=()=>{ie||S()},kn=()=>{re||fe(_)},wn=()=>{console.log(_)},yn=async()=>{await Te(1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${_.id}`))==null||U.scrollIntoView()},0)},In=async()=>{await Te(-1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${_.id}`))==null||U.scrollIntoView()},0)},Mn=()=>{T()},En=()=>{t(22,me=!1),P(_),((ee==null?void 0:ee.actions)??[]).forEach(U=>{u("action",{id:U.id,event:{id:"regenerate-response",data:{messageId:_.id}}})})},Dn=()=>{t(15,x=!0)},Nn=U=>{p(U.id,_)};function Vn(U){Be[U?"unshift":"push"](()=>{ce=U,t(14,ce)})}function Cn(U){_=U,t(12,_),t(0,d),t(40,h)}function Tn(U){me=U,t(22,me)}const Rn=async U=>{await Te(null,{...U.detail})};return n.$$set=U=>{"chatId"in U&&t(39,c=U.chatId),"history"in U&&t(0,d=U.history),"messageId"in U&&t(40,h=U.messageId),"siblings"in U&&t(1,D=U.siblings),"showPreviousMessage"in U&&t(2,b=U.showPreviousMessage),"showNextMessage"in U&&t(3,y=U.showNextMessage),"updateChat"in U&&t(4,w=U.updateChat),"editMessage"in U&&t(41,B=U.editMessage),"saveMessage"in U&&t(42,A=U.saveMessage),"rateMessage"in U&&t(43,C=U.rateMessage),"actionMessage"in U&&t(5,p=U.actionMessage),"deleteMessage"in U&&t(44,R=U.deleteMessage),"submitMessage"in U&&t(6,O=U.submitMessage),"continueResponse"in U&&t(7,T=U.continueResponse),"regenerateResponse"in U&&t(8,P=U.regenerateResponse),"addMessages"in U&&t(9,L=U.addMessages),"isLastMessage"in U&&t(10,q=U.isLastMessage),"readOnly"in U&&t(11,X=U.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&4097|n.$$.dirty[1]&512&&d.messages&&JSON.stringify(_)!==JSON.stringify(d.messages[h])&&t(12,_=JSON.parse(JSON.stringify(d.messages[h]))),n.$$.dirty[0]&4096|n.$$.dirty[1]&16384&&t(16,ee=l.find(U=>U.id===_.model)),n.$$.dirty[0]&8192&&(he||(async()=>await Ee())())},[d,D,b,y,w,p,O,T,P,L,q,X,_,he,ce,x,ee,ue,_e,J,ie,re,me,ke,s,r,a,o,f,u,be,S,K,Z,$,Y,fe,Te,De,c,h,B,A,C,R,l,Oe,Ae,Ue,et,tt,rt,it,xe,at,ot,lt,It,Mt,Et,Dt,Nt,bn,pn,kn,wn,yn,In,Mn,En,Dn,Nn,Vn,Cn,Tn,Rn]}class vn extends Re{constructor(e){super(),Se(this,e,oa,ia,Ne,{chatId:39,history:0,messageId:40,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:41,saveMessage:42,rateMessage:43,actionMessage:5,deleteMessage:44,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function fa(n){let e,t;return{c(){e=Le("svg"),t=Le("path"),this.h()},l(l){e=Pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=E(e);t=Pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(t).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke-linecap","round"),g(t,"stroke-linejoin","round"),g(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"fill","none"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width",n[1]),g(e,"stroke","currentColor"),g(e,"class",n[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&g(e,"stroke-width",l[1]),s&1&&g(e,"class",l[0])},i:ye,o:ye,d(l){l&&m(e)}}}function ua(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ca extends Re{constructor(e){super(),Se(this,e,ua,fa,Ne,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function bs(n,e,t){const l=n.slice();return l[36]=e[t],l}function Ut(n){const e=n.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function ps(n){let e,t,l,s,r,i=Me(Object.keys(n[19])),a=[];for(let u=0;u<i.length;u+=1)a[u]=Is(bs(n,i,u));const o=u=>N(a[u],1,1,()=>{a[u]=null});let f=!n[4]&&Ms(n);return{c(){e=I("div"),t=I("div");for(let u=0;u<a.length;u+=1)a[u].c();s=j(),f&&f.c(),this.h()},l(u){e=M(u,"DIV",{});var c=E(e);t=M(c,"DIV",{class:!0,id:!0});var d=E(t);for(let h=0;h<a.length;h+=1)a[h].l(d);d.forEach(m),s=z(c),f&&f.l(c),c.forEach(m),this.h()},h(){g(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),g(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){V(u,e,c),v(e,t);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);v(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&54132727){i=Me(Object.keys(u[19]));let d;for(d=0;d<i.length;d+=1){const h=bs(u,i,d);a[d]?(a[d].p(h,c),k(a[d],1)):(a[d]=Is(h),a[d].c(),k(a[d],1),a[d].m(t,null))}for(ae(),d=i.length;d<a.length;d+=1)o(d);oe()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&g(t,"id",l),u[4]?f&&(ae(),N(f,1,1,()=>{f=null}),oe()):f?(f.p(u,c),c[0]&16&&k(f,1)):(f=Ms(u),f.c(),k(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)k(a[c]);k(f),r=!0}},o(u){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)N(a[c]);N(f),r=!1},d(u){u&&m(e),Ke(a,u),f&&f.d()}}}function ks(n){let e,t=n[0].currentId,l,s,r,i,a,o=ys(n);function f(){return n[32](n[39])}return{c(){e=I("div"),o.c(),l=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=E(e);o.l(c),l=z(c),c.forEach(m),this.h()},h(){var u;g(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),o.m(e,null),v(e,l),r=!0,i||(a=ve(e,"click",f),i=!0)},p(u,c){var d;n=u,c[0]&1&&Ne(t,t=n[0].currentId)?(ae(),N(o,1,1,ye),oe(),o=ys(n),o.c(),k(o,1),o.m(e,l)):o.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((d=n[0].messages[n[2]])==null?void 0:d.modelIdx)==n[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&g(e,"class",s)},i(u){r||(k(o),r=!0)},o(u){N(o),r=!1},d(u){u&&m(e),o.d(u),i=!1,a()}}}function ws(n){let e,t;function l(){return n[29](n[36])}function s(){return n[30](n[36])}function r(...i){return n[31](n[36],...i)}return e=new vn({props:{chatId:n[1],history:n[0],messageId:n[39],isLastMessage:!0,siblings:n[19][n[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:r,addMessages:n[14],readOnly:n[4]}}),{c(){te(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,a){se(e,i,a),t=!0},p(i,a){n=i;const o={};a[0]&2&&(o.chatId=n[1]),a[0]&1&&(o.history=n[0]),a[0]&1572864&&(o.messageId=n[39]),a[0]&524288&&(o.siblings=n[19][n[36]].messageIds),a[0]&524288&&(o.showPreviousMessage=l),a[0]&524288&&(o.showNextMessage=s),a[0]&32&&(o.updateChat=n[5]),a[0]&64&&(o.editMessage=n[6]),a[0]&128&&(o.saveMessage=n[7]),a[0]&256&&(o.rateMessage=n[8]),a[0]&2048&&(o.deleteMessage=n[11]),a[0]&512&&(o.actionMessage=n[9]),a[0]&1024&&(o.submitMessage=n[10]),a[0]&4096&&(o.continueResponse=n[12]),a[0]&1581056&&(o.regenerateResponse=r),a[0]&16384&&(o.addMessages=n[14]),a[0]&16&&(o.readOnly=n[4]),e.$set(o)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function ys(n){let e,t,l=n[16]&&ws(n);return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&k(l,1)):(l=ws(s),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(ae(),N(l,1,1,()=>{l=null}),oe())},i(s){t||(k(l),t=!0)},o(s){N(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Is(n){let e,t,l=n[20][n[36]]!==void 0&&n[19][n[36]].messageIds.length>0&&ks(Ut(n));return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ut(s),r),r[0]&1572864&&k(l,1)):(l=ks(Ut(s)),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(ae(),N(l,1,1,()=>{l=null}),oe())},i(s){t||(k(l),t=!0)},o(s){N(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ms(n){let e=!Object.keys(n[19]).find(n[28]),t,l,s=e&&Es(n);return{c(){s&&s.c(),t=de()},l(r){s&&s.l(r),t=de()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[28])),e?s?(s.p(r,i),i[0]&1572865&&k(s,1)):(s=Es(r),s.c(),k(s,1),s.m(t.parentNode,t)):s&&(ae(),N(s,1,1,()=>{s=null}),oe())},i(r){l||(k(s),l=!0)},o(r){N(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function Es(n){var a,o;let e,t,l,s,r=((o=(a=n[0].messages[n[2]])==null?void 0:a.merged)==null?void 0:o.status)&&Ds(qt(n)),i=n[3]&&Vs(n);return{c(){e=I("div"),t=I("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=E(e);t=M(u,"DIV",{class:!0});var c=E(t);r&&r.l(c),c.forEach(m),l=z(u),i&&i.l(u),u.forEach(m),this.h()},h(){g(t,"class","w-full"),g(e,"class","flex justify-end")},m(f,u){V(f,e,u),v(e,t),r&&r.m(t,null),v(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,d;(d=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&d.status?r?(r.p(qt(f),u),u[0]&5&&k(r,1)):(r=Ds(qt(f)),r.c(),k(r,1),r.m(t,null)):r&&(ae(),N(r,1,1,()=>{r=null}),oe()),f[3]?i?(i.p(f,u),u[0]&8&&k(i,1)):(i=Vs(f),i.c(),k(i,1),i.m(e,null)):i&&(ae(),N(i,1,1,()=>{i=null}),oe())},i(f){s||(k(r),k(i),s=!0)},o(f){N(r),N(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function Ds(n){let e,t,l,s,r,i,a;t=new Ft({props:{$$slots:{default:[da]},$$scope:{ctx:n}}});const o=[ma,ha],f=[];function u(c,d){var h;return(((h=c[16])==null?void 0:h.content)??"")===""?0:1}return r=u(n),i=f[r]=o[r](n),{c(){e=I("div"),te(t.$$.fragment),l=j(),s=I("div"),i.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var d=E(e);le(t.$$.fragment,d),l=z(d),s=M(d,"DIV",{class:!0});var h=E(s);i.l(h),h.forEach(m),d.forEach(m),this.h()},h(){g(s,"class","mt-1 markdown-prose w-full min-w-full"),g(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,d){V(c,e,d),se(t,e,null),v(e,l),v(e,s),f[r].m(s,null),a=!0},p(c,d){const h={};d[0]&5|d[1]&512&&(h.$$scope={dirty:d,ctx:c}),t.$set(h);let _=r;r=u(c),r===_?f[r].p(c,d):(ae(),N(f[_],1,1,()=>{f[_]=null}),oe(),i=f[r],i?i.p(c,d):(i=f[r]=o[r](c),i.c()),k(i,1),i.m(s,null))},i(c){a||(k(t.$$.fragment,c),k(i),a=!0)},o(c){N(t.$$.fragment,c),N(i),a=!1},d(c){c&&m(e),ne(t),f[r].d()}}}function Ns(n){let e,t=nt(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r[0]&5&&t!==(t=nt(s[16].timestamp*1e3).format("LT")+"")&&G(l,t)},d(s){s&&m(e)}}}function da(n){let e,t,l=n[16].timestamp&&Ns(n);return{c(){e=W(`Merged Response

									`),l&&l.c(),t=de()},l(s){e=F(s,`Merged Response

									`),l&&l.l(s),t=de()},m(s,r){V(s,e,r),l&&l.m(s,r),V(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=Ns(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function ha(n){let e,t;return e=new Wt({props:{id:"merged",content:n[16].content??""}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function ma(n){let e,t;return e=new _n({}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p:ye,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Vs(n){let e,t,l;return t=new qe({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[ga]},$$scope:{ctx:n}}}),{c(){e=I("div"),te(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);le(t.$$.fragment,r),r.forEach(m),this.h()},h(){g(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),se(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&512&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function ga(n){let e,t,l,s,r;return t=new ca({props:{className:" size-5 "}}),{c(){e=I("button"),te(t.$$.fragment),this.h()},l(i){e=M(i,"BUTTON",{type:!0,id:!0,class:!0});var a=E(e);le(t.$$.fragment,a),a.forEach(m),this.h()},h(){g(e,"type","button"),g(e,"id","merge-response-button"),g(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,a){V(i,e,a),se(t,e,null),l=!0,s||(r=ve(e,"click",n[33]),s=!0)},p:ye,i(i){l||(k(t.$$.fragment,i),l=!0)},o(i){N(t.$$.fragment,i),l=!1},d(i){i&&m(e),ne(t),s=!1,r()}}}function _a(n){let e,t,l=n[18]&&ps(n);return{c(){l&&l.c(),e=de()},l(s){l&&l.l(s),e=de()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&k(l,1)):(l=ps(s),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(ae(),N(l,1,1,()=>{l=null}),oe())},i(s){t||(k(l),t=!0)},o(s){N(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function va(n,e,t){let l,s;we(n,sn,H=>t(21,l=H));const r=Qe("i18n");we(n,r,H=>t(22,s=H)),nt.extend(on);let{chatId:i}=e,{history:a}=e,{messageId:o}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:d}=e,{saveMessage:h}=e,{rateMessage:_}=e,{actionMessage:D}=e,{submitMessage:b}=e,{deleteMessage:y}=e,{continueResponse:w}=e,{regenerateResponse:B}=e,{mergeResponses:A}=e,{addMessages:C}=e,{triggerScroll:p}=e;mt();let R,O,T={},P={},L=JSON.parse(JSON.stringify(a.messages[o]));const q=async H=>{t(20,P[H]=Math.max(0,P[H]-1),P);let ie=T[H].messageIds[P[H]];console.log(ie);let re=a.messages[ie].childrenIds;for(;re.length!==0;)ie=re.at(-1),re=a.messages[ie].childrenIds;t(0,a.currentId=ie,a),await Ee(),await c(),p()},X=async H=>{t(20,P[H]=Math.min(T[H].messageIds.length-1,P[H]+1),P);let ie=T[H].messageIds[P[H]];console.log(ie);let re=a.messages[ie].childrenIds;for(;re.length!==0;)ie=re.at(-1),re=a.messages[ie].childrenIds;t(0,a.currentId=ie,a),await Ee(),await c(),p()},ce=async()=>{console.log("multiresponse:initHandler"),await Ee(),t(17,R=o),t(18,O=a.messages[o].parentId?a.messages[a.messages[o].parentId]:null),t(19,T=O==null?void 0:O.models.reduce((H,ie,re)=>{let me=O==null?void 0:O.childrenIds.map(be=>a.messages[be]).filter(be=>(be==null?void 0:be.modelIdx)===re).map(be=>be.id);if(me.length===0){let be=O==null?void 0:O.childrenIds.map(ge=>a.messages[ge]).filter(ge=>(ge==null?void 0:ge.model)===ie);be.forEach(ge=>{ge.modelIdx=re}),me=be.map(ge=>ge.id)}return{...H,[re]:{messageIds:me}}},{})),t(20,P=O==null?void 0:O.models.reduce((H,ie,re)=>{const me=T[re].messageIds.findIndex(be=>be===o);return me!==-1?{...H,[re]:me}:{...H,[re]:T[re].messageIds.length-1}},{})),console.log(T,P),await Ee()},x=async()=>{const H=Object.keys(T).map(ie=>{const{messageIds:re}=T[ie],me=re[P[ie]];return a.messages[me].content});A(o,H,i)};kt(async()=>{await ce(),await Ee();const H=document.getElementById(`message-${o}`);H&&H.scrollIntoView({block:"start"})});const ee=H=>{var me;const{messageIds:ie}=T[H],re=ie[P[H]];return!((me=a.messages[re])!=null&&me.done)},he=H=>q(H),ue=H=>X(H),_e=async(H,ie)=>{B(ie),await Ee(),t(20,P[H]=T[H].messageIds.length-1,P)},Q=async H=>{if(o!=H){let ie=H,re=a.messages[ie].childrenIds;for(;re.length!==0;)ie=re.at(-1),re=a.messages[ie].childrenIds;t(0,a.currentId=ie,a),await Ee(),await c(),p()}},J=()=>{x()};return n.$$set=H=>{"chatId"in H&&t(1,i=H.chatId),"history"in H&&t(0,a=H.history),"messageId"in H&&t(2,o=H.messageId),"isLastMessage"in H&&t(3,f=H.isLastMessage),"readOnly"in H&&t(4,u=H.readOnly),"updateChat"in H&&t(5,c=H.updateChat),"editMessage"in H&&t(6,d=H.editMessage),"saveMessage"in H&&t(7,h=H.saveMessage),"rateMessage"in H&&t(8,_=H.rateMessage),"actionMessage"in H&&t(9,D=H.actionMessage),"submitMessage"in H&&t(10,b=H.submitMessage),"deleteMessage"in H&&t(11,y=H.deleteMessage),"continueResponse"in H&&t(12,w=H.continueResponse),"regenerateResponse"in H&&t(13,B=H.regenerateResponse),"mergeResponses"in H&&t(27,A=H.mergeResponses),"addMessages"in H&&t(14,C=H.addMessages),"triggerScroll"in H&&t(15,p=H.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&a.messages&&JSON.stringify(L)!==JSON.stringify(a.messages[o])&&t(16,L=JSON.parse(JSON.stringify(a.messages[o])))},[a,i,o,f,u,c,d,h,_,D,b,y,w,B,C,p,L,R,O,T,P,l,s,r,q,X,x,A,ee,he,ue,_e,Q,J]}class ba extends Re{constructor(e){super(),Se(this,e,va,_a,Ne,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Cs(n,e,t){const l=n.slice();return l[41]=e[t],l}function Ts(n){var r,i,a,o;let e,t,l,s;return t=new fn({props:{src:n[6].user?((a=(i=(r=n[13].find(n[27]))==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/user.png":((o=n[0])==null?void 0:o.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=I("div"),te(t.$$.fragment),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=E(e);le(t.$$.fragment,u),u.forEach(m),this.h()},h(){var f;g(e,"class",l=`shrink-0 ${(((f=n[12])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){V(f,e,u),se(t,e,null),s=!0},p(f,u){var d,h,_,D,b;const c={};u[0]&8257&&(c.src=f[6].user?((_=(h=(d=f[13].find(f[27]))==null?void 0:d.info)==null?void 0:h.meta)==null?void 0:_.profile_image_url)??"/user.png":((D=f[0])==null?void 0:D.profile_image_url)??"/user.png"),t.$set(c),(!s||u[0]&4096&&l!==(l=`shrink-0 ${(((b=f[12])==null?void 0:b.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&g(e,"class",l)},i(f){s||(k(t.$$.fragment,f),s=!0)},o(f){N(t.$$.fragment,f),s=!1},d(f){f&&m(e),ne(t)}}}function Rs(n){let e,t,l;return t=new Ft({props:{$$slots:{default:[Ia]},$$scope:{ctx:n}}}),{c(){e=I("div"),te(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=E(e);le(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),se(t,e,null),l=!0},p(s,r){const i={};r[0]&22593|r[1]&8192&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function pa(n){let e=n[11].t("You")+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&2048&&e!==(e=l[11].t("You")+"")&&G(t,e)},d(l){l&&m(t)}}}function ka(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&G(t,e)},d(l){l&&m(t)}}}function wa(n){var a;let e=n[11].t("You")+"",t,l,s,r=(((a=n[6])==null?void 0:a.user)??"")+"",i;return{c(){t=W(e),l=j(),s=I("span"),i=W(r),this.h()},l(o){t=F(o,e),l=z(o),s=M(o,"SPAN",{class:!0});var f=E(s);i=F(f,r),f.forEach(m),this.h()},h(){g(s,"class","text-gray-500 text-sm font-medium")},m(o,f){V(o,t,f),V(o,l,f),V(o,s,f),v(s,i)},p(o,f){var u;f[0]&2048&&e!==(e=o[11].t("You")+"")&&G(t,e),f[0]&64&&r!==(r=(((u=o[6])==null?void 0:u.user)??"")+"")&&G(i,r)},d(o){o&&(m(t),m(l),m(s))}}}function Ss(n){let e,t,l;return t=new qe({props:{content:nt(n[6].timestamp*1e3).format("LLLL"),$$slots:{default:[ya]},$$scope:{ctx:n}}}),{c(){e=I("div"),te(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);le(t.$$.fragment,r),r.forEach(m),this.h()},h(){g(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),se(t,e,null),l=!0},p(s,r){const i={};r[0]&64&&(i.content=nt(s[6].timestamp*1e3).format("LLLL")),r[0]&64|r[1]&8192&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){N(t.$$.fragment,s),l=!1},d(s){s&&m(e),ne(t)}}}function ya(n){let e,t=Ot(n[6].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","line-clamp-1")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r[0]&64&&t!==(t=Ot(s[6].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function Ia(n){let e,t,l;function s(o,f){return o[6].user?wa:o[12].showUsername||o[14].name!==o[0].name?ka:pa}let r=s(n),i=r(n),a=n[6].timestamp&&Ss(n);return{c(){i.c(),e=j(),a&&a.c(),t=de()},l(o){i.l(o),e=z(o),a&&a.l(o),t=de()},m(o,f){i.m(o,f),V(o,e,f),a&&a.m(o,f),V(o,t,f),l=!0},p(o,f){r===(r=s(o))&&i?i.p(o,f):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e))),o[6].timestamp?a?(a.p(o,f),f[0]&64&&k(a,1)):(a=Ss(o),a.c(),k(a,1),a.m(t.parentNode,t)):a&&(ae(),N(a,1,1,()=>{a=null}),oe())},i(o){l||(k(a),l=!0)},o(o){N(a),l=!1},d(o){o&&(m(e),m(t)),i.d(o),a&&a.d(o)}}}function Bs(n){let e,t,l=Me(n[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Os(Cs(n,l,i));const r=i=>N(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var a=E(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){g(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,a){V(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4160){l=Me(i[6].files);let o;for(o=0;o<l.length;o+=1){const f=Cs(i,l,o);s[o]?(s[o].p(f,a),k(s[o],1)):(s[o]=Os(f),s[o].c(),k(s[o],1),s[o].m(e,null))}for(ae(),o=l.length;o<s.length;o+=1)r(o);oe()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)k(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)N(s[a]);t=!1},d(i){i&&m(e),Ke(s,i)}}}function Ma(n){var l;let e,t;return e=new rr({props:{item:n[41],url:n[41].url,name:n[41].name,type:n[41].type,size:(l=n[41])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){te(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){se(e,s,r),t=!0},p(s,r){var a;const i={};r[0]&64&&(i.item=s[41]),r[0]&64&&(i.url=s[41].url),r[0]&64&&(i.name=s[41].name),r[0]&64&&(i.type=s[41].type),r[0]&64&&(i.size=(a=s[41])==null?void 0:a.size),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function Ea(n){let e,t;return e=new un({props:{src:n[41].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.src=l[41].url),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Os(n){let e,t,l,s,r,i;const a=[Ea,Ma],o=[];function f(u,c){return u[41].type==="image"?0:1}return t=f(n),l=o[t]=a[t](n),{c(){e=I("div"),l.c(),s=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=E(e);l.l(c),s=z(c),c.forEach(m),this.h()},h(){var u;g(e,"class",r=((u=n[12])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),o[t].m(e,null),v(e,s),i=!0},p(u,c){var h;let d=t;t=f(u),t===d?o[t].p(u,c):(ae(),N(o[d],1,1,()=>{o[d]=null}),oe(),l=o[t],l?l.p(u,c):(l=o[t]=a[t](u),l.c()),k(l,1),l.m(e,s)),(!i||c[0]&4096&&r!==(r=((h=u[12])==null?void 0:h.chatBubble)??!0?"self-end":""))&&g(e,"class",r)},i(u){i||(k(l),i=!0)},o(u){N(l),i=!1},d(u){u&&m(e),o[t].d()}}}function Ls(n){let e,t,l,s;const r=[Na,Da],i=[];function a(o,f){return o[8]===!0?0:1}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(ae(),N(i[u],1,1,()=>{i[u]=null}),oe(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),k(t,1),t.m(l.parentNode,l))},i(o){s||(k(t),s=!0)},o(o){N(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Da(n){var A,C;let e,t,l,s,r,i,a,o,f,u,c,d,h,_,D=n[6].content&&Ps(n),b=!(((A=n[12])==null?void 0:A.chatBubble)??!0)&&As(n),y=vt;u=new qe({props:{content:n[11].t("Copy"),placement:"bottom",$$slots:{default:[Va]},$$scope:{ctx:n}}});let w=!n[4]&&!n[5]&&js(n),B=(((C=n[12])==null?void 0:C.chatBubble)??!0)&&zs(n);return{c(){e=I("div"),t=I("div"),l=I("div"),D&&D.c(),i=j(),a=I("div"),b&&b.c(),o=j(),f=j(),te(u.$$.fragment),c=j(),w&&w.c(),d=j(),B&&B.c(),this.h()},l(p){e=M(p,"DIV",{class:!0});var R=E(e);t=M(R,"DIV",{class:!0});var O=E(t);l=M(O,"DIV",{class:!0});var T=E(l);D&&D.l(T),T.forEach(m),O.forEach(m),i=z(R),a=M(R,"DIV",{class:!0});var P=E(a);b&&b.l(P),o=z(P),f=z(P),le(u.$$.fragment,P),c=z(P),w&&w.l(P),d=z(P),B&&B.l(P),P.forEach(m),R.forEach(m),this.h()},h(){var p,R,O;g(l,"class",s="rounded-3xl "+(((p=n[12])==null?void 0:p.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[6].files?"rounded-tr-lg":""}`:" w-full")),g(t,"class",r="flex "+(((R=n[12])==null?void 0:R.chatBubble)??!0?"justify-end pb-1":"w-full")),g(a,"class",h="flex "+(((O=n[12])==null?void 0:O.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),g(e,"class","w-full")},m(p,R){V(p,e,R),v(e,t),v(t,l),D&&D.m(l,null),v(e,i),v(e,a),b&&b.m(a,null),v(a,o),v(a,f),se(u,a,null),v(a,c),w&&w.m(a,null),v(a,d),B&&B.m(a,null),_=!0},p(p,R){var T,P,L,q,X;p[6].content?D?(D.p(p,R),R[0]&64&&k(D,1)):(D=Ps(p),D.c(),k(D,1),D.m(l,null)):D&&(ae(),N(D,1,1,()=>{D=null}),oe()),(!_||R[0]&4160&&s!==(s="rounded-3xl "+(((T=p[12])==null?void 0:T.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${p[6].files?"rounded-tr-lg":""}`:" w-full")))&&g(l,"class",s),(!_||R[0]&4096&&r!==(r="flex "+(((P=p[12])==null?void 0:P.chatBubble)??!0?"justify-end pb-1":"w-full")))&&g(t,"class",r),((L=p[12])==null?void 0:L.chatBubble)??!0?b&&(b.d(1),b=null):b?b.p(p,R):(b=As(p),b.c(),b.m(a,o));const O={};R[0]&2048&&(O.content=p[11].t("Copy")),R[0]&64|R[1]&8192&&(O.$$scope={dirty:R,ctx:p}),u.$set(O),!p[4]&&!p[5]?w?(w.p(p,R),R[0]&48&&k(w,1)):(w=js(p),w.c(),k(w,1),w.m(a,d)):w&&(ae(),N(w,1,1,()=>{w=null}),oe()),((q=p[12])==null?void 0:q.chatBubble)??!0?B?B.p(p,R):(B=zs(p),B.c(),B.m(a,null)):B&&(B.d(1),B=null),(!_||R[0]&4096&&h!==(h="flex "+(((X=p[12])==null?void 0:X.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&g(a,"class",h)},i(p){_||(k(D),k(y),k(u.$$.fragment,p),k(w),_=!0)},o(p){N(D),N(y),N(u.$$.fragment,p),N(w),_=!1},d(p){p&&m(e),D&&D.d(),b&&b.d(),ne(u),w&&w.d(),B&&B.d()}}}function Na(n){let e,t,l,s,r,i,a,o,f=n[11].t("Save")+"",u,c,d,h,_=n[11].t("Cancel")+"",D,b,y,w=n[11].t("Send")+"",B,A,C;return{c(){e=I("div"),t=I("div"),l=I("textarea"),r=j(),i=I("div"),a=I("div"),o=I("button"),u=W(f),c=j(),d=I("div"),h=I("button"),D=W(_),b=j(),y=I("button"),B=W(w),this.h()},l(p){e=M(p,"DIV",{class:!0});var R=E(e);t=M(R,"DIV",{class:!0});var O=E(t);l=M(O,"TEXTAREA",{id:!0,class:!0}),E(l).forEach(m),O.forEach(m),r=z(R),i=M(R,"DIV",{class:!0});var T=E(i);a=M(T,"DIV",{});var P=E(a);o=M(P,"BUTTON",{id:!0,class:!0});var L=E(o);u=F(L,f),L.forEach(m),P.forEach(m),c=z(T),d=M(T,"DIV",{class:!0});var q=E(d);h=M(q,"BUTTON",{id:!0,class:!0});var X=E(h);D=F(X,_),X.forEach(m),b=z(q),y=M(q,"BUTTON",{id:!0,class:!0});var ce=E(y);B=F(ce,w),ce.forEach(m),q.forEach(m),T.forEach(m),R.forEach(m),this.h()},h(){g(l,"id",s="message-edit-"+n[6].id),g(l,"class","bg-transparent outline-hidden w-full resize-none"),g(t,"class","max-h-96 overflow-auto"),g(o,"id","save-edit-message-button"),g(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),g(h,"id","close-edit-message-button"),g(h,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),g(y,"id","confirm-edit-message-button"),g(y,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),g(d,"class","flex space-x-1.5"),g(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),g(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(p,R){V(p,e,R),v(e,t),v(t,l),n[28](l),bt(l,n[9]),v(e,r),v(e,i),v(i,a),v(a,o),v(o,u),v(i,c),v(i,d),v(d,h),v(h,D),v(d,b),v(d,y),v(y,B),A||(C=[ve(l,"input",n[29]),ve(l,"input",Ra),ve(l,"keydown",n[30]),ve(o,"click",n[31]),ve(h,"click",n[32]),ve(y,"click",n[33])],A=!0)},p(p,R){R[0]&64&&s!==(s="message-edit-"+p[6].id)&&g(l,"id",s),R[0]&512&&bt(l,p[9]),R[0]&2048&&f!==(f=p[11].t("Save")+"")&&G(u,f),R[0]&2048&&_!==(_=p[11].t("Cancel")+"")&&G(D,_),R[0]&2048&&w!==(w=p[11].t("Send")+"")&&G(B,w)},i:ye,o:ye,d(p){p&&m(e),n[28](null),A=!1,ht(C)}}}function Ps(n){let e,t;return e=new Wt({props:{id:n[6].id,content:n[6].content}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.id=l[6].id),s[0]&64&&(r.content=l[6].content),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function As(n){let e,t=n[1].length>1&&Hs(n);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=Hs(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function Hs(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",a,o,f=n[1].length+"",u,c,d,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),r=I("div"),a=W(i),o=W("/"),u=W(f),c=j(),d=I("button"),d.innerHTML=h,this.h()},l(b){e=M(b,"DIV",{class:!0,dir:!0});var y=E(e);t=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(y),r=M(y,"DIV",{class:!0});var w=E(r);a=F(w,i),o=F(w,"/"),u=F(w,f),w.forEach(m),c=z(y),d=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(d)!=="svelte-4phel2"&&(d.innerHTML=h),y.forEach(m),this.h()},h(){g(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),g(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(e,"class","flex self-center"),g(e,"dir","ltr")},m(b,y){V(b,e,y),v(e,t),v(e,s),v(e,r),v(r,a),v(r,o),v(r,u),v(e,c),v(e,d),_||(D=[ve(t,"click",n[34]),ve(d,"click",n[35])],_=!0)},p(b,y){y[0]&66&&i!==(i=b[1].indexOf(b[6].id)+1+"")&&G(a,i),y[0]&2&&f!==(f=b[1].length+"")&&G(u,f)},d(b){b&&m(e),_=!1,ht(D)}}}function Va(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){g(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ve(e,"click",n[37]),l=!0)},p:ye,d(r){r&&m(e),l=!1,s()}}}function js(n){let e,t;return e=new qe({props:{content:n[11].t("Delete"),placement:"bottom",$$slots:{default:[Ca]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&2048&&(r.content=l[11].t("Delete")),s[0]&128|s[1]&8192&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Ca(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){g(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ve(e,"click",n[38]),l=!0)},p:ye,d(r){r&&m(e),l=!1,s()}}}function zs(n){let e,t=n[1].length>1&&qs(n);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=qs(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function qs(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",a,o,f=n[1].length+"",u,c,d,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),r=I("div"),a=W(i),o=W("/"),u=W(f),c=j(),d=I("button"),d.innerHTML=h,this.h()},l(b){e=M(b,"DIV",{class:!0,dir:!0});var y=E(e);t=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(y),r=M(y,"DIV",{class:!0});var w=E(r);a=F(w,i),o=F(w,"/"),u=F(w,f),w.forEach(m),c=z(y),d=M(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ze(d)!=="svelte-4phel2"&&(d.innerHTML=h),y.forEach(m),this.h()},h(){g(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),g(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),g(e,"class","flex self-center"),g(e,"dir","ltr")},m(b,y){V(b,e,y),v(e,t),v(e,s),v(e,r),v(r,a),v(r,o),v(r,u),v(e,c),v(e,d),_||(D=[ve(t,"click",n[39]),ve(d,"click",n[40])],_=!0)},p(b,y){y[0]&66&&i!==(i=b[1].indexOf(b[6].id)+1+"")&&G(a,i),y[0]&2&&f!==(f=b[1].length+"")&&G(u,f)},d(b){b&&m(e),_=!1,ht(D)}}}function Ta(n){var A,C;let e,t,l,s,r,i,a,o,f,u,c,d,h;function _(p){n[25](p)}let D={title:n[11].t("Delete message?")};n[7]!==void 0&&(D.show=n[7]),e=new mn({props:D}),Be.push(()=>Ge(e,"show",_)),e.$on("confirm",n[26]);let b=!(((A=n[12])==null?void 0:A.chatBubble)??!0)&&Ts(n),y=!(((C=n[12])==null?void 0:C.chatBubble)??!0)&&Rs(n),w=n[6].files&&Bs(n),B=n[6].content!==""&&Ls(n);return{c(){te(e.$$.fragment),l=j(),s=I("div"),b&&b.c(),r=j(),i=I("div"),y&&y.c(),a=j(),o=I("div"),w&&w.c(),f=j(),B&&B.c(),this.h()},l(p){le(e.$$.fragment,p),l=z(p),s=M(p,"DIV",{class:!0,dir:!0,id:!0});var R=E(s);b&&b.l(R),r=z(R),i=M(R,"DIV",{class:!0});var O=E(i);y&&y.l(O),a=z(O),o=M(O,"DIV",{class:!0});var T=E(o);w&&w.l(T),f=z(T),B&&B.l(T),T.forEach(m),O.forEach(m),R.forEach(m),this.h()},h(){g(o,"class",u="chat-"+n[6].role+" w-full min-w-full markdown-prose"),g(i,"class","flex-auto w-0 max-w-full pl-1"),g(s,"class","flex w-full user-message"),g(s,"dir",c=n[12].chatDirection),g(s,"id",d="message-"+n[6].id)},m(p,R){se(e,p,R),V(p,l,R),V(p,s,R),b&&b.m(s,null),v(s,r),v(s,i),y&&y.m(i,null),v(i,a),v(i,o),w&&w.m(o,null),v(o,f),B&&B.m(o,null),h=!0},p(p,R){var T,P;const O={};R[0]&2048&&(O.title=p[11].t("Delete message?")),!t&&R[0]&128&&(t=!0,O.show=p[7],Je(()=>t=!1)),e.$set(O),((T=p[12])==null?void 0:T.chatBubble)??!0?b&&(ae(),N(b,1,1,()=>{b=null}),oe()):b?(b.p(p,R),R[0]&4096&&k(b,1)):(b=Ts(p),b.c(),k(b,1),b.m(s,r)),((P=p[12])==null?void 0:P.chatBubble)??!0?y&&(ae(),N(y,1,1,()=>{y=null}),oe()):y?(y.p(p,R),R[0]&4096&&k(y,1)):(y=Rs(p),y.c(),k(y,1),y.m(i,a)),p[6].files?w?(w.p(p,R),R[0]&64&&k(w,1)):(w=Bs(p),w.c(),k(w,1),w.m(o,f)):w&&(ae(),N(w,1,1,()=>{w=null}),oe()),p[6].content!==""?B?(B.p(p,R),R[0]&64&&k(B,1)):(B=Ls(p),B.c(),k(B,1),B.m(o,null)):B&&(ae(),N(B,1,1,()=>{B=null}),oe()),(!h||R[0]&64&&u!==(u="chat-"+p[6].role+" w-full min-w-full markdown-prose"))&&g(o,"class",u),(!h||R[0]&4096&&c!==(c=p[12].chatDirection))&&g(s,"dir",c),(!h||R[0]&64&&d!==(d="message-"+p[6].id))&&g(s,"id",d)},i(p){h||(k(e.$$.fragment,p),k(b),k(y),k(w),k(B),h=!0)},o(p){N(e.$$.fragment,p),N(b),N(y),N(w),N(B),h=!1},d(p){p&&(m(l),m(s)),ne(e,p),b&&b.d(),y&&y.d(),w&&w.d(),B&&B.d()}}}const Ra=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`};function Sa(n,e,t){let l,s,r,i;we(n,At,S=>t(12,s=S)),we(n,Pt,S=>t(13,r=S)),we(n,Ht,S=>t(14,i=S));const a=Qe("i18n");we(n,a,S=>t(11,l=S)),nt.extend(on);let{user:o}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{showPreviousMessage:d}=e,{showNextMessage:h}=e,{editMessage:_}=e,{deleteMessage:D}=e,{isFirstMessage:b}=e,{readOnly:y}=e,w=!1,B=!1,A="",C,p=JSON.parse(JSON.stringify(f.messages[u]));const R=async S=>{await an(S)&&je.success(l.t("Copying to clipboard was successful!"))},O=async()=>{t(8,B=!0),t(9,A=p.content),await Ee(),t(10,C.style.height="",C),t(10,C.style.height=`${C.scrollHeight}px`,C),C==null||C.focus()},T=async(S=!0)=>{_(p.id,A,S),t(8,B=!1),t(9,A="")},P=()=>{t(8,B=!1),t(9,A="")},L=async()=>{D(p.id)};kt(()=>{});function q(S){w=S,t(7,w)}const X=()=>{L()},ce=S=>S.id===p.user;function x(S){Be[S?"unshift":"push"](()=>{C=S,t(10,C)})}function ee(){A=this.value,t(9,A)}const he=S=>{var $,Y;S.key==="Escape"&&(($=document.getElementById("close-edit-message-button"))==null||$.click());const K=S.metaKey||S.ctrlKey,Z=S.key==="Enter";K&&Z&&((Y=document.getElementById("confirm-edit-message-button"))==null||Y.click())},ue=()=>{T(!1)},_e=()=>{P()},Q=()=>{T()},J=()=>{d(p)},H=()=>{h(p)},ie=()=>{O()},re=()=>{R(p.content)},me=()=>{t(7,w=!0)},be=()=>{d(p)},ge=()=>{h(p)};return n.$$set=S=>{"user"in S&&t(0,o=S.user),"history"in S&&t(21,f=S.history),"messageId"in S&&t(22,u=S.messageId),"siblings"in S&&t(1,c=S.siblings),"showPreviousMessage"in S&&t(2,d=S.showPreviousMessage),"showNextMessage"in S&&t(3,h=S.showNextMessage),"editMessage"in S&&t(23,_=S.editMessage),"deleteMessage"in S&&t(24,D=S.deleteMessage),"isFirstMessage"in S&&t(4,b=S.isFirstMessage),"readOnly"in S&&t(5,y=S.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&6291520&&f.messages&&JSON.stringify(p)!==JSON.stringify(f.messages[u])&&t(6,p=JSON.parse(JSON.stringify(f.messages[u])))},[o,c,d,h,b,y,p,w,B,A,C,l,s,r,i,a,R,O,T,P,L,f,u,_,D,q,X,ce,x,ee,he,ue,_e,Q,J,H,ie,re,me,be,ge]}class Ba extends Re{constructor(e){super(),Se(this,e,Sa,Ta,Ne,{user:0,history:21,messageId:22,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:23,deleteMessage:24,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function Us(n){let e,t,l,s;const r=[Pa,La,Oa],i=[];function a(o,f){var u,c;return o[0].messages[o[3]].role==="user"?0:(((c=(u=o[0].messages[o[0].messages[o[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=a(n),t=i[e]=r[e](n),{c(){t.c(),l=de()},l(o){t.l(o),l=de()},m(o,f){i[e].m(o,f),V(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(ae(),N(i[u],1,1,()=>{i[u]=null}),oe(),t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),k(t,1),t.m(l.parentNode,l))},i(o){s||(k(t),s=!0)},o(o){N(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Oa(n){var i;let e,t,l;function s(a){n[21](a)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],mergeResponses:n[16],triggerScroll:n[18],addMessages:n[17],readOnly:n[19]};return n[0]!==void 0&&(r.history=n[0]),e=new ba({props:r}),Be.push(()=>Ge(e,"history",s)),{c(){te(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,o){se(e,a,o),l=!0},p(a,o){var u;const f={};o&2&&(f.chatId=a[1]),o&8&&(f.messageId=a[3]),o&9&&(f.isLastMessage=a[3]===((u=a[0])==null?void 0:u.currentId)),o&128&&(f.updateChat=a[7]),o&256&&(f.editMessage=a[8]),o&512&&(f.saveMessage=a[9]),o&2048&&(f.rateMessage=a[11]),o&4096&&(f.actionMessage=a[12]),o&8192&&(f.submitMessage=a[13]),o&1024&&(f.deleteMessage=a[10]),o&32768&&(f.continueResponse=a[15]),o&16384&&(f.regenerateResponse=a[14]),o&65536&&(f.mergeResponses=a[16]),o&262144&&(f.triggerScroll=a[18]),o&131072&&(f.addMessages=a[17]),o&524288&&(f.readOnly=a[19]),!t&&o&1&&(t=!0,f.history=a[0],Je(()=>t=!1)),e.$set(f)},i(a){l||(k(e.$$.fragment,a),l=!0)},o(a){N(e.$$.fragment,a),l=!1},d(a){ne(e,a)}}}function La(n){var l;let e,t;return e=new vn({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:n[5],showNextMessage:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],addMessages:n[17],readOnly:n[19]}}),{c(){te(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){se(e,s,r),t=!0},p(s,r){var a;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&128&&(i.updateChat=s[7]),r&256&&(i.editMessage=s[8]),r&512&&(i.saveMessage=s[9]),r&2048&&(i.rateMessage=s[11]),r&4096&&(i.actionMessage=s[12]),r&8192&&(i.submitMessage=s[13]),r&1024&&(i.deleteMessage=s[10]),r&32768&&(i.continueResponse=s[15]),r&16384&&(i.regenerateResponse=s[14]),r&131072&&(i.addMessages=s[17]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function Pa(n){var l;let e,t;return e=new Ba({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(Ws).map(Fs)??[],showPreviousMessage:n[5],showNextMessage:n[6],editMessage:n[8],deleteMessage:n[10],readOnly:n[19]}}),{c(){te(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){se(e,s,r),t=!0},p(s,r){var a;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]:Object.values(s[0].messages).filter(Ws).map(Fs)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&256&&(i.editMessage=s[8]),r&1024&&(i.deleteMessage=s[10]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function Aa(n){let e,t,l,s=n[0].messages[n[3]]&&Us(n);return{c(){e=I("div"),s&&s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=E(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;g(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[20])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var a;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&k(s,1)):(s=Us(r),s.c(),k(s,1),s.m(e,null)):s&&(ae(),N(s,1,1,()=>{s=null}),oe()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((a=r[20])==null?void 0:a.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&g(e,"class",t)},i(r){l||(k(s),l=!0)},o(r){N(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const Ws=n=>n.parentId===null,Fs=n=>n.id;function Ha(n,e,t){let l;we(n,At,T=>t(20,l=T)),mt(),Qe("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:a}=e,{user:o}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:c}=e,{editMessage:d}=e,{saveMessage:h}=e,{deleteMessage:_}=e,{rateMessage:D}=e,{actionMessage:b}=e,{submitMessage:y}=e,{regenerateResponse:w}=e,{continueResponse:B}=e,{mergeResponses:A}=e,{addMessages:C}=e,{triggerScroll:p}=e,{readOnly:R=!1}=e;function O(T){i=T,t(0,i)}return n.$$set=T=>{"chatId"in T&&t(1,s=T.chatId),"idx"in T&&t(2,r=T.idx),"history"in T&&t(0,i=T.history),"messageId"in T&&t(3,a=T.messageId),"user"in T&&t(4,o=T.user),"showPreviousMessage"in T&&t(5,f=T.showPreviousMessage),"showNextMessage"in T&&t(6,u=T.showNextMessage),"updateChat"in T&&t(7,c=T.updateChat),"editMessage"in T&&t(8,d=T.editMessage),"saveMessage"in T&&t(9,h=T.saveMessage),"deleteMessage"in T&&t(10,_=T.deleteMessage),"rateMessage"in T&&t(11,D=T.rateMessage),"actionMessage"in T&&t(12,b=T.actionMessage),"submitMessage"in T&&t(13,y=T.submitMessage),"regenerateResponse"in T&&t(14,w=T.regenerateResponse),"continueResponse"in T&&t(15,B=T.continueResponse),"mergeResponses"in T&&t(16,A=T.mergeResponses),"addMessages"in T&&t(17,C=T.addMessages),"triggerScroll"in T&&t(18,p=T.triggerScroll),"readOnly"in T&&t(19,R=T.readOnly)},[i,s,r,a,o,f,u,c,d,h,_,D,b,y,w,B,A,C,p,R,l,O]}class ja extends Re{constructor(e){super(),Se(this,e,Ha,Aa,Ne,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function za(n){let e,t,l=vt;return{c(){e=de()},l(s){e=de()},m(s,r){V(s,e,r),t=!0},p(s,[r]){},i(s){t||(k(l),t=!0)},o(s){N(l),t=!1},d(s){s&&m(e)}}}function qa(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Ua(n,e,t){let l,s;we(n,Fn,b=>t(3,s=b));const r=Qe("i18n");we(n,r,b=>t(2,l=b));const i=mt();let{suggestionPrompts:a=[]}=e,{className:o=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let d,h=[];const _=b=>{if(b.length>500)t(1,h=[]);else{const y=b.trim()?d.search(b.trim()).map(w=>w.item):u;qa(h,y)||t(1,h=y)}},D=b=>i("select",b.content);return n.$$set=b=>{"suggestionPrompts"in b&&t(6,a=b.suggestionPrompts),"className"in b&&t(0,o=b.className),"inputValue"in b&&t(7,f=b.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&a&&(t(8,u=[...a??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(d=new ur(u,c)),n.$$.dirty&128&&_(f)},[o,h,l,s,r,i,a,f,u,D]}class Wa extends Re{constructor(e){super(),Se(this,e,Ua,za,Ne,{suggestionPrompts:6,className:0,inputValue:7})}}function Fa(n){let e,t;return{c(){e=Le("svg"),t=Le("path"),this.h()},l(l){e=Pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=E(e);t=Pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(t).forEach(m),s.forEach(m),this.h()},h(){g(t,"stroke-linecap","round"),g(t,"stroke-linejoin","round"),g(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"fill","none"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width",n[1]),g(e,"stroke","currentColor"),g(e,"class",n[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&g(e,"stroke-width",l[1]),s&1&&g(e,"class",l[0])},i:ye,o:ye,d(l){l&&m(e)}}}function Ja(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ga extends Re{constructor(e){super(),Se(this,e,Ja,Fa,Ne,{className:0,strokeWidth:1})}}function Js(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function Ka(n){let e,t;return{c(){e=I("img"),this.h()},l(l){e=M(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;g(e,"crossorigin","anonymous"),il(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))||g(e,"src",t),g(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),g(e,"alt","logo"),g(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,a;s&33&&!il(e.src,t=((a=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))&&g(e,"src",t)},d(l){l&&m(e)}}}function Gs(n){var o,f,u;let e,t,l,s,r,i;t=new qe({props:{content:Lt.parse(pt(((u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[Ka]},$$scope:{ctx:n}}});function a(){return n[12](n[16])}return{c(){e=I("button"),te(t.$$.fragment),l=j()},l(c){e=M(c,"BUTTON",{});var d=E(e);le(t.$$.fragment,d),l=z(d),d.forEach(m)},m(c,d){V(c,e,d),se(t,e,null),v(e,l),s=!0,r||(i=ve(e,"click",a),r=!0)},p(c,d){var _,D,b;n=c;const h={};d&17&&(h.content=Lt.parse(pt(((b=(D=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:b.description)??""))),d&131105&&(h.$$scope={dirty:d,ctx:n}),t.$set(h)},i(c){s||(k(t.$$.fragment,c),s=!0)},o(c){N(t.$$.fragment,c),s=!1},d(c){c&&m(e),ne(t),r=!1,i()}}}function Ks(n){let e,t;return e=new qe({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[Qa]},$$scope:{ctx:n}}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Qa(n){let e,t,l,s;return t=new Ga({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=I("div"),te(t.$$.fragment),l=W(" Temporary Chat"),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=E(e);le(t.$$.fragment,i),l=F(i," Temporary Chat"),i.forEach(m),this.h()},h(){g(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(r,i){V(r,e,i),se(t,e,null),v(e,l),s=!0},p:ye,i(r){s||(k(t.$$.fragment,r),s=!0)},o(r){N(t.$$.fragment,r),s=!1},d(r){r&&m(e),ne(t)}}}function Za(n){let e=n[5].t("Hello, {{name}}",{name:n[7].name})+"",t;return{c(){t=W(e)},l(l){t=F(l,e)},m(l,s){V(l,t,s)},p(l,s){s&160&&e!==(e=l[5].t("Hello, {{name}}",{name:l[7].name})+"")&&G(t,e)},d(l){l&&m(t)}}}function Ya(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=F(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&G(t,e)},d(s){s&&m(t)}}}function Xa(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=E(e);l=F(r,t),r.forEach(m),this.h()},h(){g(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),v(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&G(l,t)},d(s){s&&m(e)}}}function $a(n){var a,o,f,u,c,d;let e,t,l=Lt.parse(pt((f=(o=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:f.description))+"",s,r,i=((d=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:d.user)&&Qs(n);return{c(){e=I("div"),t=new jn(!1),s=j(),i&&i.c(),r=de(),this.h()},l(h){e=M(h,"DIV",{class:!0});var _=E(e);t=zn(_,!1),_.forEach(m),s=z(h),i&&i.l(h),r=de(),this.h()},h(){t.a=null,g(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(h,_){V(h,e,_),t.m(l,e),V(h,s,_),i&&i.m(h,_),V(h,r,_)},p(h,_){var D,b,y,w,B,A;_&17&&l!==(l=Lt.parse(pt((y=(b=(D=h[0][h[4]])==null?void 0:D.info)==null?void 0:b.meta)==null?void 0:y.description))+"")&&t.p(l),(A=(B=(w=h[0][h[4]])==null?void 0:w.info)==null?void 0:B.meta)!=null&&A.user?i?i.p(h,_):(i=Qs(h),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(h){h&&(m(e),m(s),m(r)),i&&i.d(h)}}}function Qs(n){let e,t;function l(i,a){var o,f,u;return(u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)!=null&&u.user.community?eo:xa}let s=l(n),r=s(n);return{c(){e=I("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var a=E(e);t=F(a,`By
								`),r.l(a),a.forEach(m),this.h()},h(){g(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,a){V(i,e,a),v(e,t),r.m(e,null)},p(i,a){s===(s=l(i))&&r?r.p(i,a):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function xa(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=F(i,e)},m(i,a){V(i,t,a)},p(i,a){var o,f,u;a&17&&e!==(e=((u=(f=(o=i[0][i[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&G(t,e)},d(i){i&&m(t)}}}function eo(n){var r,i,a,o,f,u,c,d,h;let e,t=((a=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&a.user.name?(u=(f=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(h=(d=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:d.meta)==null?void 0:h.user.username}`)+"",l,s;return{c(){e=I("a"),l=W(t),this.h()},l(_){e=M(_,"A",{href:!0});var D=E(e);l=F(D,t),D.forEach(m),this.h()},h(){var _,D,b;g(e,"href",s="https://openwebui.com/m/"+((b=(D=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:b.user.username))},m(_,D){V(_,e,D),v(e,l)},p(_,D){var b,y,w,B,A,C,p,R,O,T,P,L;D&17&&t!==(t=((w=(y=(b=_[0][_[4]])==null?void 0:b.info)==null?void 0:y.meta)!=null&&w.user.name?(C=(A=(B=_[0][_[4]])==null?void 0:B.info)==null?void 0:A.meta)==null?void 0:C.user.name:`@${(O=(R=(p=_[0][_[4]])==null?void 0:p.info)==null?void 0:R.meta)==null?void 0:O.user.username}`)+"")&&G(l,t),D&17&&s!==(s="https://openwebui.com/m/"+((L=(P=(T=_[0][_[4]])==null?void 0:T.info)==null?void 0:P.meta)==null?void 0:L.user.username))&&g(e,"href",s)},d(_){_&&m(e)}}}function Zs(n){var X,ce,x,ee,he,ue,_e;let e,t,l,s,r,i,a,o,f,u,c,d,h,_,D,b,y,w,B=Me(n[0]),A=[];for(let Q=0;Q<B.length;Q+=1)A[Q]=Gs(Js(n,B,Q));const C=Q=>N(A[Q],1,1,()=>{A[Q]=null});let p=n[6]&&Ks(n);function R(Q,J){var H;return(H=Q[0][Q[4]])!=null&&H.name?Ya:Za}let O=R(n),T=O(n);function P(Q,J){var H,ie,re;return((re=(ie=(H=Q[0][Q[4]])==null?void 0:H.info)==null?void 0:ie.meta)==null?void 0:re.description)??null?$a:Xa}let L=P(n),q=L(n);return b=new Wa({props:{className:"grid grid-cols-2",suggestionPrompts:((x=(ce=(X=n[1])==null?void 0:X.info)==null?void 0:ce.meta)==null?void 0:x.suggestion_prompts)??((ue=(he=(ee=n[0][n[4]])==null?void 0:ee.info)==null?void 0:he.meta)==null?void 0:ue.suggestion_prompts)??((_e=n[8])==null?void 0:_e.default_prompt_suggestions)??[]}}),b.$on("select",n[13]),{c(){e=I("div"),t=I("div"),l=I("div");for(let Q=0;Q<A.length;Q+=1)A[Q].c();r=j(),p&&p.c(),i=j(),a=I("div"),o=I("div"),f=I("div"),T.c(),c=j(),d=I("div"),q.c(),_=j(),D=I("div"),te(b.$$.fragment),this.h()},l(Q){e=M(Q,"DIV",{class:!0});var J=E(e);t=M(J,"DIV",{class:!0});var H=E(t);l=M(H,"DIV",{class:!0});var ie=E(l);for(let K=0;K<A.length;K+=1)A[K].l(ie);ie.forEach(m),H.forEach(m),r=z(J),p&&p.l(J),i=z(J),a=M(J,"DIV",{class:!0});var re=E(a);o=M(re,"DIV",{});var me=E(o);f=M(me,"DIV",{class:!0});var be=E(f);T.l(be),be.forEach(m),c=z(me),d=M(me,"DIV",{});var ge=E(d);q.l(ge),ge.forEach(m),me.forEach(m),re.forEach(m),_=z(J),D=M(J,"DIV",{class:!0});var S=E(D);le(b.$$.fragment,S),S.forEach(m),J.forEach(m),this.h()},h(){g(l,"class","flex -space-x-4 mb-0.5"),g(t,"class","flex justify-start"),g(f,"class","capitalize line-clamp-1"),g(a,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),g(D,"class","w-full font-primary"),g(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(Q,J){V(Q,e,J),v(e,t),v(t,l);for(let H=0;H<A.length;H+=1)A[H]&&A[H].m(l,null);v(e,r),p&&p.m(e,null),v(e,i),v(e,a),v(a,o),v(o,f),T.m(f,null),v(o,c),v(o,d),q.m(d,null),v(e,_),v(e,D),se(b,D,null),w=!0},p(Q,J){var ie,re,me,be,ge,S,K;if(J&49){B=Me(Q[0]);let Z;for(Z=0;Z<B.length;Z+=1){const $=Js(Q,B,Z);A[Z]?(A[Z].p($,J),k(A[Z],1)):(A[Z]=Gs($),A[Z].c(),k(A[Z],1),A[Z].m(l,null))}for(ae(),Z=B.length;Z<A.length;Z+=1)C(Z);oe()}Q[6]?p?J&64&&k(p,1):(p=Ks(Q),p.c(),k(p,1),p.m(e,i)):p&&(ae(),N(p,1,1,()=>{p=null}),oe()),O===(O=R(Q))&&T?T.p(Q,J):(T.d(1),T=O(Q),T&&(T.c(),T.m(f,null))),L===(L=P(Q))&&q?q.p(Q,J):(q.d(1),q=L(Q),q&&(q.c(),q.m(d,null)));const H={};J&275&&(H.suggestionPrompts=((me=(re=(ie=Q[1])==null?void 0:ie.info)==null?void 0:re.meta)==null?void 0:me.suggestion_prompts)??((S=(ge=(be=Q[0][Q[4]])==null?void 0:be.info)==null?void 0:ge.meta)==null?void 0:S.suggestion_prompts)??((K=Q[8])==null?void 0:K.default_prompt_suggestions)??[]),b.$set(H)},i(Q){if(!w){for(let J=0;J<B.length;J+=1)k(A[J]);Q&&(s||Tt(()=>{s=Rt(l,St,{duration:200}),s.start()})),k(p),Q&&(u||Tt(()=>{u=Rt(f,St,{duration:200}),u.start()})),Q&&(h||Tt(()=>{h=Rt(d,St,{duration:200,delay:200}),h.start()})),k(b.$$.fragment,Q),Q&&(y||Tt(()=>{y=Rt(D,St,{duration:200,delay:300}),y.start()})),w=!0}},o(Q){A=A.filter(Boolean);for(let J=0;J<A.length;J+=1)N(A[J]);N(p),N(b.$$.fragment,Q),w=!1},d(Q){Q&&m(e),Ke(A,Q),p&&p.d(),T.d(),q.d(),ne(b)}}}function to(n){let e=n[3],t,l,s=Zs(n);return{c(){s.c(),t=de()},l(r){s.l(r),t=de()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&8&&Ne(e,e=r[3])?(ae(),N(s,1,1,ye),oe(),s=Zs(r),s.c(),k(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(k(s),l=!0)},o(r){N(s),l=!1},d(r){r&&m(t),s.d(r)}}}function lo(n,e,t){let l,s,r,i,a;we(n,Pt,y=>t(11,l=y)),we(n,rn,y=>t(6,r=y)),we(n,Ht,y=>t(7,i=y)),we(n,nn,y=>t(8,a=y));const o=Qe("i18n");we(n,o,y=>t(5,s=y));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:d}=e,h=!1,_=0;kt(()=>{t(3,h=!0)});const D=y=>{t(4,_=y)},b=y=>{d(y.detail)};return n.$$set=y=>{"modelIds"in y&&t(10,f=y.modelIds),"models"in y&&t(0,u=y.models),"atSelectedModel"in y&&t(1,c=y.atSelectedModel),"submitPrompt"in y&&t(2,d=y.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(y=>l.find(w=>w.id===y))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,d,h,_,s,r,i,a,o,f,l,D,b]}class so extends Re{constructor(e){super(),Se(this,e,lo,to,Ne,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function Ys(n,e,t){const l=n.slice();return l[42]=e[t],l[44]=t,l}function no(n){let e,t=n[3],l,s=en(n);return{c(){e=I("div"),s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=E(e);s.l(i),i.forEach(m),this.h()},h(){g(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Ne(t,t=r[3])?(ae(),N(s,1,1,ye),oe(),s=en(r),s.c(),k(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(k(s),l=!0)},o(r){N(s),l=!1},d(r){r&&m(e),s.d(r)}}}function ro(n){let e,t;return e=new so({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[33]}}),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&65538&&(r.submitPrompt=l[33]),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function Xs(n){let e,t;return e=new fr({props:{$$slots:{default:[io]},$$scope:{ctx:n}}}),e.$on("visible",n[34]),{c(){te(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,s){se(e,l,s),t=!0},p(l,s){const r={};s[1]&16384&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){ne(e,l)}}}function io(n){let e,t,l,s,r="Loading...",i;return t=new jt({props:{className:" size-4"}}),{c(){e=I("div"),te(t.$$.fragment),l=j(),s=I("div"),s.textContent=r,this.h()},l(a){e=M(a,"DIV",{class:!0});var o=E(e);le(t.$$.fragment,o),l=z(o),s=M(o,"DIV",{class:!0,"data-svelte-h":!0}),ze(s)!=="svelte-17uns3n"&&(s.textContent=r),o.forEach(m),this.h()},h(){g(s,"class",""),g(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(a,o){V(a,e,o),se(t,e,null),v(e,l),v(e,s),i=!0},p:ye,i(a){i||(k(t.$$.fragment,a),i=!0)},o(a){N(t.$$.fragment,a),i=!1},d(a){a&&m(e),ne(t)}}}function $s(n,e){let t,l,s,r;function i(o){e[35](o)}let a={chatId:e[3],messageId:e[42].id,idx:e[44],user:e[4],showPreviousMessage:e[20],showNextMessage:e[21],updateChat:e[19],editMessage:e[23],deleteMessage:e[26],rateMessage:e[22],actionMessage:e[24],saveMessage:e[25],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[27],readOnly:e[12]};return e[0]!==void 0&&(a.history=e[0]),l=new ja({props:a}),Be.push(()=>Ge(l,"history",i)),{key:n,first:null,c(){t=de(),te(l.$$.fragment),this.h()},l(o){t=de(),le(l.$$.fragment,o),this.h()},h(){this.first=t},m(o,f){V(o,t,f),se(l,o,f),r=!0},p(o,f){e=o;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[42].id),f[0]&16384&&(u.idx=e[44]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Je(()=>s=!1)),l.$set(u)},i(o){r||(k(l.$$.fragment,o),r=!0)},o(o){N(l.$$.fragment,o),r=!1},d(o){o&&m(t),ne(l,o)}}}function xs(n){let e;return{c(){e=I("div"),this.h()},l(t){e=M(t,"DIV",{class:!0}),E(e).forEach(m),this.h()},h(){g(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function en(n){var D;let e,t=((D=n[14].at(0))==null?void 0:D.parentId)!==null,l,s=[],r=new Map,i,a,o,f,u,c=t&&Xs(n),d=Me(n[14]);const h=b=>b[42].id;for(let b=0;b<d.length;b+=1){let y=Ys(n,d,b),w=h(y);r.set(w,s[b]=$s(w,y))}let _=n[13]&&xs();return{c(){e=I("div"),c&&c.c(),l=j();for(let b=0;b<s.length;b+=1)s[b].c();i=j(),a=I("div"),o=j(),_&&_.c(),f=de(),this.h()},l(b){e=M(b,"DIV",{class:!0});var y=E(e);c&&c.l(y),l=z(y);for(let w=0;w<s.length;w+=1)s[w].l(y);y.forEach(m),i=z(b),a=M(b,"DIV",{class:!0}),E(a).forEach(m),o=z(b),_&&_.l(b),f=de(),this.h()},h(){g(e,"class","w-full"),g(a,"class","pb-12")},m(b,y){V(b,e,y),c&&c.m(e,null),v(e,l);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(e,null);V(b,i,y),V(b,a,y),V(b,o,y),_&&_.m(b,y),V(b,f,y),u=!0},p(b,y){var w;y[0]&16384&&(t=((w=b[14].at(0))==null?void 0:w.parentId)!==null),t?c?(c.p(b,y),y[0]&16384&&k(c,1)):(c=Xs(b),c.c(),k(c,1),c.m(e,l)):c&&(ae(),N(c,1,1,()=>{c=null}),oe()),y[0]&267935641&&(d=Me(b[14]),ae(),s=tn(s,y,h,1,b,d,r,e,ln,$s,null,Ys),oe()),b[13]?_||(_=xs(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(b){if(!u){k(c);for(let y=0;y<d.length;y+=1)k(s[y]);u=!0}},o(b){N(c);for(let y=0;y<s.length;y+=1)N(s[y]);u=!1},d(b){b&&(m(e),m(i),m(a),m(o),m(f)),c&&c.d();for(let y=0;y<s.length;y+=1)s[y].d();_&&_.d(b)}}}function ao(n){let e,t,l,s,r;const i=[ro,no],a=[];function o(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=o(n,[-1,-1]),s=a[l]=i[l](n),{c(){e=I("div"),s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=E(e);s.l(u),u.forEach(m),this.h()},h(){g(e,"class",n[2])},m(f,u){V(f,e,u),a[l].m(e,null),r=!0},p(f,u){let c=l;l=o(f,u),l===c?a[l].p(f,u):(ae(),N(a[c],1,1,()=>{a[c]=null}),oe(),s=a[l],s?s.p(f,u):(s=a[l]=i[l](f),s.c()),k(s,1),s.m(e,null)),(!r||u[0]&4)&&g(e,"class",f[2])},i(f){r||(k(s),r=!0)},o(f){N(s),r=!1},d(f){f&&m(e),a[l].d()}}}function oo(n,e,t){let l,s,r,i,a;we(n,At,S=>t(36,l=S)),we(n,fl,S=>t(37,s=S)),we(n,rn,S=>t(38,r=S)),we(n,Ht,S=>t(39,i=S)),mt();const o=Qe("i18n");we(n,o,S=>t(16,a=S));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=i}=e,{prompt:d}=e,{history:h={}}=e,{selectedModels:_}=e,{atSelectedModel:D}=e,b=[],{sendPrompt:y}=e,{continueResponse:w}=e,{regenerateResponse:B}=e,{mergeResponses:A}=e,{chatActionHandler:C}=e,{showMessage:p=()=>{}}=e,{submitMessage:R=()=>{}}=e,{addMessages:O=()=>{}}=e,{readOnly:T=!1}=e,{bottomPadding:P=!1}=e,{autoScroll:L}=e,q=20,X=!1;const ce=async()=>{const S=document.getElementById("messages-container");S.scrollTop=S.scrollTop+100,t(15,X=!0),t(32,q+=20),await Ee(),t(15,X=!1)},x=()=>{const S=document.getElementById("messages-container");S.scrollTop=S.scrollHeight},ee=async()=>{r||(t(0,h),await Ee(),await Kn(localStorage.token,u,{history:h,messages:b}),fl.set(1),await Jn.set(await Qn(localStorage.token,s)))},he=async S=>{if(S.parentId!==null){let K=h.messages[S.parentId].childrenIds[Math.max(h.messages[S.parentId].childrenIds.indexOf(S.id)-1,0)];if(S.id!==K){let Z=h.messages[K].childrenIds;for(;Z.length!==0;)K=Z.at(-1),Z=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter($=>$.parentId===null).map($=>$.id),Z=K[Math.max(K.indexOf(S.id)-1,0)];if(S.id!==Z){let $=h.messages[Z].childrenIds;for(;$.length!==0;)Z=$.at(-1),$=h.messages[Z].childrenIds;t(0,h.currentId=Z,h)}}if(await Ee(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,L=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{x()},100)}},ue=async S=>{if(S.parentId!==null){let K=h.messages[S.parentId].childrenIds[Math.min(h.messages[S.parentId].childrenIds.indexOf(S.id)+1,h.messages[S.parentId].childrenIds.length-1)];if(S.id!==K){let Z=h.messages[K].childrenIds;for(;Z.length!==0;)K=Z.at(-1),Z=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter($=>$.parentId===null).map($=>$.id),Z=K[Math.min(K.indexOf(S.id)+1,K.length-1)];if(S.id!==Z){let $=h.messages[Z].childrenIds;for(;$.length!==0;)Z=$.at(-1),$=h.messages[Z].childrenIds;t(0,h.currentId=Z,h)}}if(await Ee(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,L=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{x()},100)}},_e=async(S,K)=>{t(0,h.messages[S].annotation={...h.messages[S].annotation,rating:K},h),await ee()},Q=async(S,K,Z=!0)=>{if(h.messages[S].role==="user")if(Z){let $=K,Y=ul(),fe={id:Y,parentId:h.messages[S].parentId,childrenIds:[],role:"user",content:$,...h.messages[S].files&&{files:h.messages[S].files},models:_,timestamp:Math.floor(Date.now()/1e3)},ke=h.messages[S].parentId;ke!==null&&t(0,h.messages[ke].childrenIds=[...h.messages[ke].childrenIds,Y],h),t(0,h.messages[Y]=fe,h),t(0,h.currentId=Y,h),await Ee(),await y(h,$,Y)}else t(0,h.messages[S].content=K,h),await ee();else if(Z){const $=ul(),Y=h.messages[S],fe=Y.parentId,ke={...Y,id:$,parentId:fe,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,h.messages[$]=ke,h),t(0,h.currentId=$,h),fe!==null&&t(0,h.messages[fe].childrenIds=[...h.messages[fe].childrenIds,$],h),await ee()}else t(0,h.messages[S].originalContent=h.messages[S].content,h),t(0,h.messages[S].content=K,h),await ee()},J=async(S,K,Z=null)=>{await C(u,S,K.model,K.id,Z)},H=async(S,K)=>{t(0,h.messages[S]=K,h),await ee()},ie=async S=>{const K=h.messages[S],Z=K.parentId,$=K.childrenIds??[],Y=$.flatMap(fe=>{var ke;return((ke=h.messages[fe])==null?void 0:ke.childrenIds)??[]});Z&&h.messages[Z]&&t(0,h.messages[Z].childrenIds=[...h.messages[Z].childrenIds.filter(fe=>fe!==S),...Y],h),Y.forEach(fe=>{h.messages[fe]&&t(0,h.messages[fe].parentId=Z,h)}),[S,...$].forEach(fe=>{delete h.messages[fe]}),await Ee(),p({id:Z}),await ee()},re=()=>{if(L){const S=document.getElementById("messages-container");t(28,L=S.scrollHeight-S.scrollTop<=S.clientHeight+50),setTimeout(()=>{x()},100)}},me=async S=>{let K=S;if(S.includes("{{CLIPBOARD}}")){const $=await navigator.clipboard.readText().catch(Y=>(je.error(a.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));K=S.replaceAll("{{CLIPBOARD}}",$)}t(1,d=K),await Ee();const Z=document.getElementById("chat-input-container");Z&&(t(1,d=S),Z.style.height="",Z.style.height=Math.min(Z.scrollHeight,200)+"px",Z.focus()),await Ee()},be=S=>{console.log("visible"),X||ce()};function ge(S){h=S,t(0,h)}return n.$$set=S=>{"className"in S&&t(2,f=S.className),"chatId"in S&&t(3,u=S.chatId),"user"in S&&t(4,c=S.user),"prompt"in S&&t(1,d=S.prompt),"history"in S&&t(0,h=S.history),"selectedModels"in S&&t(5,_=S.selectedModels),"atSelectedModel"in S&&t(6,D=S.atSelectedModel),"sendPrompt"in S&&t(29,y=S.sendPrompt),"continueResponse"in S&&t(7,w=S.continueResponse),"regenerateResponse"in S&&t(8,B=S.regenerateResponse),"mergeResponses"in S&&t(9,A=S.mergeResponses),"chatActionHandler"in S&&t(30,C=S.chatActionHandler),"showMessage"in S&&t(31,p=S.showMessage),"submitMessage"in S&&t(10,R=S.submitMessage),"addMessages"in S&&t(11,O=S.addMessages),"readOnly"in S&&t(12,T=S.readOnly),"bottomPadding"in S&&t(13,P=S.bottomPadding),"autoScroll"in S&&t(28,L=S.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&2)if(h.currentId){let S=[],K=h.messages[h.currentId];for(;K&&S.length<=q;)S.unshift({...K}),K=K.parentId!==null?h.messages[K.parentId]:null;t(14,b=S)}else t(14,b=[]);n.$$.dirty[0]&268443648&&L&&P&&(async()=>(await Ee(),x()))()},[h,d,f,u,c,_,D,w,B,A,R,O,T,P,b,X,a,o,ce,ee,he,ue,_e,Q,J,H,ie,re,L,y,C,p,q,me,be,ge]}class Wo extends Re{constructor(e){super(),Se(this,e,oo,ao,Ne,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:29,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:30,showMessage:31,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:28},null,[-1,-1])}}export{Ga as E,dr as K,Wo as M,Wa as S};
//# sourceMappingURL=Messages.B4wGYAuV.js.map
