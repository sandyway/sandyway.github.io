{"version":3,"file":"index.xrDpore3.js","sources":["../../../../../../src/lib/apis/users/index.ts"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\nimport { getUserPosition } from '$lib/utils';\nimport { apiFetch } from '$lib/apis/interceptor/apiInterceptor';\n\nexport const getUserGroups = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/groups`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getUserDefaultPermissions = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/default/permissions`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateUserDefaultPermissions = async (token: string, permissions: object) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/default/permissions`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...permissions\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateUserRole = async (token: string, id: string, role: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/update/role`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tid: id,\n\t\t\trole: role\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getUsers = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res ? res : [];\n};\n\nexport const getUserSettings = async (token: string) => {\n\tlet error = null;\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/user/settings`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateUserSettings = async (token: string, settings: object) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/user/settings/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...settings\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getUserById = async (token: string, userId: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/${userId}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getUserInfo = async (token: string) => {\n\tlet error = null;\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/user/info`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateUserInfo = async (token: string, info: object) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/user/info/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...info\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getAndUpdateUserLocation = async (token: string) => {\n\tconst location = await getUserPosition().catch((err) => {\n\t\tconsole.log(err);\n\t\treturn null;\n\t});\n\n\tif (location) {\n\t\tawait updateUserInfo(token, { location: location });\n\t\treturn location;\n\t} else {\n\t\tconsole.log('Failed to get user location');\n\t\treturn null;\n\t}\n};\n\nexport const deleteUserById = async (token: string, userId: string) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/${userId}`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\ntype UserUpdateForm = {\n\tprofile_image_url: string;\n\temail: string;\n\tname: string;\n\tpassword: string;\n};\n\nexport const updateUserById = async (token: string, userId: string, user: UserUpdateForm) => {\n\tlet error = null;\n\n\tconst res = await apiFetch(`${WEBUI_API_BASE_URL}/users/${userId}/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAuthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tprofile_image_url: user.profile_image_url,\n\t\t\temail: user.email,\n\t\t\tname: user.name,\n\t\t\tpassword: user.password !== '' ? user.password : undefined\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n"],"names":["getUserDefaultPermissions","token","error","res","apiFetch","WEBUI_API_BASE_URL","err","updateUserDefaultPermissions","permissions","updateUserRole","id","role","getUsers","getUserSettings","updateUserSettings","settings","getUserById","userId","updateUserInfo","info","getAndUpdateUserLocation","location","getUserPosition","deleteUserById","updateUserById","user"],"mappings":"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"}